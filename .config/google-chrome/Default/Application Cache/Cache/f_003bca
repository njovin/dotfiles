zf.prototype.Kaa=ea(37,function(){return wc(this,3)});Ox.prototype.Kaa=ea(36,function(){return wc(this,5)});zf.prototype.z9=ea(35,function(){return B(this,3)});Ox.prototype.z9=ea(34,function(){return B(this,5)});zf.prototype.Naa=ea(33,function(){return wc(this,2)});Ox.prototype.Naa=ea(32,function(){return wc(this,4)});zf.prototype.P9=ea(31,function(){return B(this,2)});Ox.prototype.P9=ea(30,function(){return B(this,4)});Ve.prototype.getHeaderRange=ea(26,function(){return B(this,2)});
function gAc(a){for(var b in a.C)a.hb(b,!0)}function hAc(a,b){a.D=b}function iAc(a){return SC()?(new FC(a.L)).mc("title"):""}function jAc(a,b){var c=qk(a,b);return t(c)?String(qk(a,b)):null}function kAc(a){return null!=a?a:Number.MAX_VALUE}function lAc(a){return null!=a?a:Number.MIN_VALUE}function mAc(a){return wc(a,1)&&wc(a,2)&&a.Zf()==a.Wg()}function nAc(a){return"%"+a.charCodeAt(0).toString(16)}var oAc=/['()]/g;
function pAc(a,b){return mAc(b)?mAc(a)&&a.Zf()==b.Zf():mAc(a)?lAc(a.Zf())>lAc(b.Zf())&&lAc(a.Zf())<kAc(b.Wg()):lAc(a.Zf())>=lAc(b.Zf())&&kAc(a.Wg())<=kAc(b.Wg())}function qAc(a){return a.Bm()+fb(a.C)}function rAc(a){var b=new Sd;b.setType(0);var c=new Dd,d=new Bd;D(d,1,2);a=Ua(a);D(d,2,a);c.ob(d);d=new id;d.setType(0);D(c,1,d);D(b,5,c);return b}function sAc(a){a=Va(String(a));oAc.lastIndex=0;return oAc.test(a)?a.replace(oAc,nAc):a}
function tAc(a){return V("<li class='nfd-format-pill'><div class='nfd-format-display'>"+U(a.Hfb)+"</div><div class='nfd-format-sample'>"+U(a.RQb)+"</div></li>")};function uAc(a,b,c){S.call(this);this.Re(a);this.D=b;this.C=c}x(uAc,S);r=uAc.prototype;r.qa=function(){var a=this.pb(),b=this.C?Jaa(kO(a),30):kO(a),a=this.C?mSb(a,this.D):"";this.Ia=T(tAc,{Hfb:b,RQb:a})};r.Ya=function(){uAc.$.Ya.call(this);Wl(this.getElement(),!0);var a=new qq(this.getElement());F(this,a);this.getHandler().R(a,"key",this.u0b).R(this.getElement(),"mousedown",this.t0b).R(this.getElement(),"dblclick",this.gqb)};
r.u0b=function(a){function b(a,b){for(;b=a(b);)if(xp(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(Ol,this.getElement());break;case 38:b(Rpa,this.getElement())}};r.t0b=function(a){a.preventDefault();this.dispatchEvent("change")};r.gqb=function(){this.dispatchEvent("action")};function vAc(a,b,c){S.call(this);this.D=b;this.C=c;wAc(this,a)}x(vAc,S);vAc.prototype.qa=function(){this.Ia=this.ma().qa("UL","nfd-pill-container")};function wAc(a,b){z(b,function(b){a.Za(new uAc(b,a.D,a.C),!0)})}vAc.prototype.filter=function(a){a=a.toLowerCase();this.eg(function(b){var c=Ra(fb(a)),d=kO(b.pb()).toLowerCase(),c=c||Za(d,a);Q(b.getElement(),c)})};function lY(a){Up.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.tja();this.Za(this.input,!0);this.J=new S;this.Za(this.J,!0);a=this.X9();Nb(a,void 0,qAc);this.C=new vAc(a,this.l0(),this.mVa());this.J.Za(this.C,!0);kq(this,null);this.Gj=!0}x(lY,Up);r=lY.prototype;r.WXa=Jf;r.mVa=If;r.isEmpty=function(){return Ra(this.input.bb())};r.Qf=function(){return this.input.pb().Qf()};r.qa=function(){lY.$.qa.call(this);var a=Cl("DIV","dialog-separator");Jl(a,bq(this))};
r.Ya=function(){lY.$.Ya.call(this);Vo(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.vsb).R(this.C,"action",this.Wva).R(this.input.O,"action",this.Wva).R(this.input,"afterhide",this.Tkb);this.input.V&&this.getHandler().R(this.input.V,"input",this.m0b);var a=this.input.oa;a&&this.getHandler().R(a,"key",this.n0b);a=this.X9()[0];this.input.kO(a)};r.Tkb=function(a){a.stopPropagation()};r.vsb=function(a){this.input.kO(a.target.pb());xAc(this.input,!1)};
r.m0b=function(){this.C.filter(this.input.bb());xAc(this.input,!this.input.pb().Qf())};r.n0b=function(a){13==a.keyCode&&this.Wva()};r.Wva=function(){this.Qf()&&!this.isEmpty()?(X.M4.Oc(new fO(this.y4(),void 0,this.WXa())),this.setVisible(!1)):(xAc(this.input,!0),this.input.BHa())};function mY(a,b,c,d,e){Jq.call(this,b,c,d,e);this.C=a}x(mY,Jq);mY.prototype.Gn=function(){var a=mY.$.Gn.call(this),b=this.getParent();return b&&b instanceof ys&&!b.tb()?this.C(a,this.pb()):a};function nY(a){S.call(this);this.J=new S;F(this,this.J);this.D=new MO("");F(this,this.D);this.O=new ss("");F(this,this.O);this.Z=a;this.oa=null}x(nY,S);r=nY.prototype;
r.Ya=function(){nY.$.Ya.call(this);var a=Pp(this,"nfd-icwr");this.J.ub(a);this.Za(this.J);if(a=Pp(this,"nfd-i"))this.D.ub(a),this.D.Bd(this.J),Xo(this.D.getElement(),"jfk-textinput"),a=new Tq,a.ub(this.D.getElement()),F(this,a),this.V=a=new Sq(this.D.getElement()),F(this,a),this.oa=a=new qq(this.D.getElement()),F(this,a),a=new bp(this.D.getElement()),this.getHandler().R(a,"focusout",Ea(this.UXa,!1)).R(a,"focusin",Ea(this.UXa,!0)).R(this.V,"input",this.l0b);a=Pp(this,"nfd-a");this.O.ub(a);this.Za(this.O)};
r.bb=function(){return this.D.bb()};r.l0b=function(){var a=this.pb(),b=this.bb();D(a.UH,2,b);this.VXa()};r.VXa=Jf;r.UXa=function(a){Zo(this.J.getElement(),"nfd-input-focus",a)};r.kO=function(a){this.Re(a.clone());this.D.ob(kO(a));try{this.D.getElement().focus()}catch(b){}};r.BHa=function(){this.D.getElement().focus()};function xAc(a,b){a=a.J.getElement();Zo(a,"nfd-invalid",b)};function yAc(a){var b;a=a||{};return V('<input class="jfk-textinput'+(a.Je?" "+W(a.Je):"")+'"'+(a.id?'id="'+W(a.id)+'"':"")+(a.maxLength?'maxlength="'+W(a.maxLength)+'"':"")+(a.Hca&&a.eWb?'label="'+W(a.Hca)+'"':"")+(a.name?'name="'+W(a.name)+'"':"")+(a.Hca?'placeholder="'+W(a.Hca)+'"':"")+'type="'+W(null==(b=a.type)?"text":b)+'"'+(a.pattern?'pattern="'+W(a.pattern)+'"':"")+(a.value?'value="'+W(a.value)+'"':"")+(a.dir?'dir="'+W(a.dir)+'"':"")+(a.attributes?" "+lr(a.attributes):"")+">")};function zAc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.B1)+"'>"+AAc(a)+"</div>"+BAc(a)+"</div>")}function CAc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.B1)+"'></div>"+BAc(a)+"</div>")}
function DAc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.B1)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+AAc(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+W(a.oHb)+"'></div></div></div></div>"+BAc(a)+"</div>")}
function EAc(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+FAc({label:""})+FAc({label:hr("Negative:")})+FAc({label:hr("Zero:")})+FAc({label:hr("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return V(a)}function FAc(a){return V("<tr><td class='nfd-sample-label'>"+U(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function BAc(a){a=""+U(rs({id:a.Aia,style:2,Je:"nfd-apply",content:gr("Apply")}));return V(a)}function AAc(a){return V(U(yAc({id:a.SOa,Hca:a.TOa,eWb:!0})))};function GAc(a){nY.call(this,a);this.F=new S;this.C=new SH("")}x(GAc,nY);r=GAc.prototype;r.qa=function(){this.Ia=T(DAc,{B1:Np(this,"nfd-icwr"),SOa:Np(this,"nfd-i"),TOa:this.Z,oHb:Np(this,"nfd-ic"),Aia:Np(this,"nfd-a")})};r.Ya=function(){GAc.$.Ya.call(this);var a=Pp(this,"nfd-ic");this.F.ub(a);this.F.Bd(this.J);this.F.Za(this.C,!0);this.getHandler().R(this.C,"aftershow",this.o0b).R(this.C,"action",this.aMa).R(this.V,"input",Ea(this.cXa,null))};
r.kO=function(a){GAc.$.kO.call(this,a);a.C&&this.D.ob(wn[a.C][1]);this.cXa(a)};
r.cXa=function(a){a=a?a.C:void 0;var b=this.C;b.Dg(null);if(a){var c=this.pb(),d=c.C;HAc(this,c);c=w9b(d,wn[d][2]);c=new fO(IAc(c),iR[d],d);HAc(this,c);c=w9b(d,d+" "+wn[d][1]);d=new fO(IAc(c),iR[d],d);HAc(this,d)}else this.pb().C=null;var e="[$"+this.bb()+"]",d=a?iR[a]:null,c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new fO(IAc(c[e]),d,a);HAc(this,f)}b.ag(0);this.aMa();Vo(b.Pc().getElement(),"number-format-menu")};function HAc(a,b){var c=new mY(function(a){return Jaa(a,25)},mSb(b,1E3),b);F(a,c);F(a,b);c.Wq(!0);a=a.C;for(b=0;b<a.Nk();b++)if(a.Gf(b).Gn()==c.Gn())return;a.Ce(c)}r.aMa=function(){for(var a=this.C,b=0;b<a.Nk();b++)a.Gf(b).Ac(!1);ft(a)};r.o0b=function(){this.C.Nf().Ac(!0)};function IAc(a){var b=new id;D(b,2,a);b.setType(4);return b};function JAc(a){lY.call(this,a);Vp(this,"Custom currencies")}x(JAc,lY);r=JAc.prototype;r.l0=n(1000.12);r.tja=function(){return new GAc("Custom currency")};r.X9=function(){var a=this;uVb();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=iR[e]:hAc(d,y9b(d.Bm()))}var f=[];Yb(wn,function(b,c){b=x9b(c);F(a,b);f.push(b)});var h=imc();Qb(f,function(a,b){return h(kO(a),kO(b))});return b.concat(f)};r.y4=function(){var a=new id;a.setType(4);D(a,3,1);var b=this.input.C.Nf().bb().Bm();D(a,2,b);return a};
r.WXa=function(){return this.input.pb().C};function KAc(a){S.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(KAc,S);KAc.prototype.qa=function(){var a=T(EAc);this.F=xl("nfd-sample-label",a);this.D=Hpa("nfd-rendered-sample",a);this.Ia=a};function oY(a,b){nY.call(this,a);this.C=new KAc(b);this.Re(new fO(""))}x(oY,nY);oY.prototype.qa=function(){this.Ia=T(zAc,{SOa:Np(this,"nfd-i"),TOa:this.Z,B1:Np(this,"nfd-icwr"),Aia:Np(this,"nfd-a")})};oY.prototype.Ya=function(){oY.$.Ya.call(this);this.Za(this.C,!0);LAc(this)};oY.prototype.VXa=function(){LAc(this)};oY.prototype.kO=function(a){oY.$.kO.call(this,a);LAc(this)};
function LAc(a){var b=a.pb();if(b){var c=a.C;a=b.Bm().split(";").length-1;Ul(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=mSb(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Bm()),k=d<=a;Q(Ql(e),k);Ul(e,f);cp(e,"color",h||"")}d=b.Qf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Bm()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Bm());c=c.D[3];Q(Ql(c),3<=a);Ul(c,d);cp(c,"color",b||"")}};function pY(a){lY.call(this,a);Vp(this,"Custom number formats")}x(pY,lY);pY.prototype.l0=n(1234.56);pY.prototype.tja=function(){return new oY("Custom number format",1234.56)};
pY.prototype.X9=function(){var a=this.F;a.push(new fO("0"));a.push(new fO("0.00"));a.push(new fO("#,##0"));a.push(new fO("#,##0.00"));a.push(new fO("#,##0_);(#,##0)"));a.push(new fO("#,##0_);[Red](#,##0)"));a.push(new fO("#,##0.00_);(#,##0.00)"));a.push(new fO("#,##0.00_);[Red](#,##0.00)"));a.push(new fO("$#,##0_);($#,##0)"));a.push(new fO("$#,##0_);[Red]($#,##0)"));a.push(new fO("$#,##0.00_);($#,##0.00)"));a.push(new fO("$#,##0.00_);[Red]($#,##0.00)"));a.push(new fO("@"));a.push(new fO("0%"));a.push(new fO("0.00%"));
a.push(new fO("0.00E+00"));a.push(new fO("##0.0E+0"));a.push(new fO("# ?/?"));a.push(new fO("# ??/??"));a.push(new fO('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new fO('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new fO('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new fO('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};pY.prototype.y4=function(){var a=new id;a.setType(2);D(a,3,1);var b=this.input.bb();D(a,2,b);return a};function qY(a,b){Ls.call(this,b,new MAc(a))}x(qY,Ls);r=qY.prototype;r.ji=function(a,b,c){qY.$.ji.call(this,a,b,c);a.Dc()&&this.Dc()&&a.getParent()==this&&NAc(this)};r.Ya=function(){qY.$.Ya.call(this);NAc(this)};r.re=function(a){qY.$.re.call(this,a);NAc(this)};r.removeChild=function(a,b){a=qY.$.removeChild.call(this,a,b);NAc(this);return a};r.Ln=function(a,b){a=qY.$.Ln.call(this,a,b);NAc(this);return a};
r.hk=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Bs(this);if(c){b=39==b;this.Wf()&&(b=!b);var c=c.getElement(),c=ob(c.parentNode.childNodes,c);var d=(d=(d=Bs(this))?fqa(d.getElement(),OAc):null)?ob(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=PAc(this,e);b?b=PAc(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Cda(this.jk+b);b=!0}else b=!1}b=!b}return b?qY.$.hk.call(this,a):!0};
r.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function PAc(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function NAc(a){for(var b=a.Ge(),c=a.vd(),d=Kb(wl("div",OAc,a.getElement())),e=a.getElement(),f=d.length;f<b.D&&f<c;f++)d[f]=a.ma().qa("DIV",OAc),e.appendChild(d[f]);for(var e=d.length,b=Array(e),c=[],f=0,h=!1,k=0;k<a.vd();k++)a.yd(k)instanceof Ks?(c.push(new QAc(f,k,!0)),f=k+1):a.yd(k)instanceof Gs&&(0==k?h=!0:(a.yd(k-1),c.push(new QAc(f,k-1,!1)),f=k));k=a.vd();0<c.length&&nb(c).end!=k-1&&c.push(new QAc(f,k-1,!1));f=h;h=a.vd();if(0==c.length&&f)b[0]=h;else{f=c.length-Math.max(0,c.length-e);f=a.vd()-
f;f=Math.ceil(f/e);if(0==c.length)for(h=0;h<e;h++)b[h]=(h+1)*f-1;else RAc(c,f,e);e=c.length;for(f=0;f<e;f++)b[f]=c[f].end}for(e=c=0;e<a.vd();e++){for(;e>b[c];)++c;f=a.yd(e);h=f.getElement();h.parentNode!=d[c]&&d[c].appendChild(h);e==b[c]&&f instanceof Ks?Q(h,!1):Q(h,!0)}for(a=d.length-1;a>c;--a)d[a].parentNode.removeChild(d[a]),d[a]=null}
function RAc(a,b,c){function d(a){return a.end-a.start-(a.eGb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Fb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Fb(a,l,1))}}function QAc(a,b,c){this.start=a;this.end=b;this.eGb=c}function MAc(a){Js.call(this);this.D=a}x(MAc,Js);var OAc="docs-multi-menu-col";function SAc(a){this.C=a}x(SAc,E);SAc.prototype.create=function(){return new qY(this.C)};function TAc(a,b){nY.call(this,a);this.ea=new S;this.H=new rY;this.F=new S;a=(new SAc(3)).create();a.Za(new Gs("Date"),!0);a.Za(new Jq("Day","DAY_TOKEN"),!0);a.Za(new Jq("Month","MONTH_TOKEN"),!0);a.Za(new Jq("Year","YEAR_TOKEN"),!0);a.Za(new Gs("Time"),!0);a.Za(new Jq("Hours","HOURS_TOKEN"),!0);a.Za(new Jq("Minutes","MINUTES_TOKEN"),!0);a.Za(new Jq("Seconds","SECONDS_TOKEN"),!0);a.Za(new Jq("Milliseconds","MILLIS_TOKEN"),!0);a.Za(new Jq("AM/PM","AM_PM_TOKEN"),!0);a.Za(new Gs("Duration"),!0);a.Za(new Jq("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Za(new Jq("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Za(new Jq("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new $ib(a);this.C=b}x(TAc,nY);r=TAc.prototype;r.qa=function(){this.Ia=T(CAc,{B1:Np(this,"nfd-icwr"),Aia:Np(this,"nfd-a")})};
r.Ya=function(){TAc.$.Ya.call(this);Vo(this.getElement(),"nfd-date-time-input");var a=Pp(this,"nfd-icwr"),b=this.ea;b.ub(a);b.Bd(this);b.Za(this.L,!0);Vo(this.L.getElement(),"nfd-date-time-menu-button");Vo(this.L.Pc().getElement(),"nfd-date-time-menu");So(this.L.Ia,"Add a date or time format");b.Za(this.H,!0);Nc||Vo(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Za(a,!0);cp(a.getElement(),"display","inline");this.getHandler().R(this,"Qe",Ea(this.XXa,"left")).R(this,"Ue",Ea(this.XMa,"left")).R(this,
"Ve",Ea(this.XMa,"right")).R(this,"We",Ea(this.CNa,"left")).R(this,"Xe",Ea(this.CNa,"right")).R(this,"Te",Ea(this.XXa,"right")).R(this.L,"action",this.Yob)};r.BHa=function(){this.ea.getElement().focus()};
r.kO=function(a){this.Re(a.clone());var b=this.F;b.Md(!0);Ul(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Bm());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?Ul(this.H.getElement(),d[2]):(e=b.yd(b.vd()-1),d=d[2],Ul(e.rA.getElement(),Yl(e.rA.getElement())+d)):UAc(this,e).ob(d[1])}0<b.vd()&&b.yd(b.vd()-1).Dy.getElement().focus()};
r.bb=function(){for(var a=this.H.toString(),b=0;b<this.F.vd();b++)a+=this.F.yd(b).toString();for(var a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a),b="",c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=ab(e,"["),e=ab(e,"]")):c=!0}b+=e}return b};r.Yob=function(a){a=a.target.bb();UAc(this,a).Dy.getElement().focus()};
function UAc(a,b){xAc(a,!1);switch(b){case "DAY_TOKEN":var c=VAc(a);break;case "MONTH_TOKEN":c=WAc(a);break;case "YEAR_TOKEN":c=XAc(a);break;case "HOURS_TOKEN":c=YAc();break;case "MINUTES_TOKEN":c=ZAc();break;case "SECONDS_TOKEN":c=$Ac();break;case "MILLIS_TOKEN":c=aBc();break;case "AM_PM_TOKEN":c=bBc(a);break;case "ELAPSED_HOURS_TOKEN":c=cBc();break;case "ELAPSED_MINUTES_TOKEN":c=dBc();break;case "ELAPSED_SECONDS_TOKEN":c=eBc()}b=c;b.Za(new Ks,!0);b.Za(new Jq("Delete"),!0);c=new fBc(c,"");a.F.Za(c,
!0);return c}r.XXa=function(a,b){b=b.target;if(b instanceof rY){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.yd(Qp(this.F,b)+1),!b))return}a=Yl(b.rA.getElement());var c=b.getParent(),d=Qp(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=Yl(b),Ul(b,c+a),gBc(this.H,c.length)):(d--,b=c.yd(d),c=Yl(b.rA.getElement()),Ul(b.rA.getElement(),Yl(b.rA.getElement())+a),gBc(b.rA,c.length))};
r.CNa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.yd(Qp(this.F,b)+a))&&a.Dy.getElement().focus()};r.XMa=function(a,b){var c="left"==a?-1:0;(b=this.F.yd(Qp(this.F,b.target)+c))||"left"!=a?b&&(b=b.rA):b=this.H;c=Yl(b.getElement()).length;gBc(b,"left"==a?c:0)};function fBc(a,b){S.call(this);this.Dy=new SH("",a);this.Za(this.Dy,!0);this.rA=new rY(b);this.Za(this.rA,!0)}x(fBc,S);r=fBc.prototype;
r.Ya=function(){fBc.$.Ya.call(this);cp(this.getElement(),"display","inline-block");this.Dy.ag(0);this.C=new qq(this.Dy.getElement());F(this,this.C);this.getHandler().R(this.Dy,"action",this.p0b).R(this.C,"key",this.q0b)};r.p0b=function(){ft(this.Dy);this.Dy.Nf().pb()||this.dispatchEvent("Te")};r.q0b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Te"));break;case 37:a.preventDefault();this.dispatchEvent("Ue");break;case 39:a.preventDefault(),this.dispatchEvent("Ve")}};
r.toString=function(){return this.Dy.Nf().pb()+this.rA.toString()};r.ob=function(a){this.Dy.ob(a)};function rY(a){S.call(this);this.C=a||""}x(rY,S);r=rY.prototype;r.qa=function(){var a=Cl("SPAN");yl(a,{contentEditable:!0});Ul(a,this.C);var b=a.style;Kc&&!Tc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Nc?"-moz-pre-wrap":"pre-wrap";this.Ia=a};
r.Ya=function(){rY.$.Ya.call(this);var a=new qq(this.getElement());F(this,a);this.getHandler().R(a,"key",this.r0b).R(this.getElement(),"paste",this.s0b)};function gBc(a,b){if(0==Yl(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=mw(c,b);a.getElement().focus();b.select()}}
r.r0b=function(a){var b=Xl(this.getElement()),c=cw(),d=Yl(this.getElement()).length,e=c?0==c.xi()&&0==c.ao():Ra(fb(b)),b=c?c.xi()==d&&c.ao()==d:Ra(fb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Qe"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Te"));break;case 40:this.dispatchEvent("Re");break;case 38:this.dispatchEvent("Se");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("We"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Xe"));break;
case 13:a.preventDefault()}};r.toString=function(){var a=saa(Yl(this.getElement())).replace(/"/g,'"\\""');return 0==fb(a).length?"":'"'+a+'"'};r.s0b=function(){var a=v(function(){Ul(this.getElement(),Yl(this.getElement()))},this);wi(a)};
function VAc(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new mY(Ea(b,e),a,d));d=new Ls;for(e=0;e<c.length;e++)d.Za(c[e],!0);return d}
function WAc(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new mY(Ea(b,e),a,d));d=new Ls;for(e=0;e<c.length;e++)d.Za(c[e],!0);return d}
function XAc(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new mY(Ea(b,e),a,d));d=new Ls;for(e=0;e<c.length;e++)d.Za(c[e],!0);return d}
function YAc(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function ZAc(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function $Ac(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function aBc(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function bBc(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new mY(Ea(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new mY(Ea(b,e),a,d));d=new Ls;for(e=0;e<c.length;e++)d.Za(c[e],!0);return d}
function cBc(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function dBc(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c}
function eBc(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new mY(Ea(a,d),e,c));c=new Ls;for(d=0;d<b.length;d++)c.Za(b[d],!0);return c};function hBc(a){lY.call(this,a);Vp(this,"Custom date and time formats")}x(hBc,lY);r=hBc.prototype;r.mVa=Hf;r.l0=n(11175.5628472222);r.isEmpty=function(){return Ra(Cc(this.y4(),2))};r.Qf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Cc(this.y4(),2))};r.tja=function(){return new TAc("Custom date time format",11175.5628472222)};r.y4=function(){return iBc(this.input.bb())};
r.X9=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.l0(),c.Bm());c.D=d}b=jBc(this);Nb(b);for(c=0;c<b.length;c++)a.push(new fO(iBc(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.l0(),b[c])));return a};
function jBc(a){var b=vu,c=sb(b.DATEFORMATS,function(a){return kBc(a)},a),d=sb(b.TIMEFORMATS,function(a){return kBc(a)},a),e=c.concat(d),b=b.DATETIMEFORMATS;Nb(b);a=sb(b,function(a){return kBc(a)},a);for(b=0;b<a.length;b++){var f=a[b],f=f.replace(/\{1\}/,c[0]),f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function kBc(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ua(a.join(""))}function iBc(a){var b=new id;b.setType(7);D(b,3,1);D(b,2,a);return b};function lBc(a,b){this.D=a;this.C=b}lBc.prototype.getUrl=g("D");function mBc(){};function nBc(a){for(var b="",c=a.rUa,d=c.length,e=0;e<d;e++){var f=c[e],h=a.lSb[f.Li()];f.getName();var k=f.getLabel(),f=f.YGb,f=V('<div id="'+W(h)+'" tabindex="0" role="link" class="ess-button" aria-label="'+W(k)+'"><div class="ess-icon '+W(f)+'"></div></div>'),b=b+f}return V(b)};function oBc(a,b){S.call(this,b);this.C=a||[];this.F=[];this.D=null}x(oBc,S);r=oBc.prototype;r.gia=!0;r.Eha=!1;r.QR=null;r.WFa=!1;r.hb=function(a,b){this.gia=a;this.Eha=b;if(this.WFa){b=this.ma();for(var c=0,d;d=this.C[c];c++){var e=b.getElement(this.QR.vta+"-"+d.Li()),f=a;Zo(e,"ess-button",f);Zo(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();qs(e,f,d)}}};
r.qa=function(){this.Ia=this.wb.createElement("SPAN");var a={};a.vta=Np(this,"service");a.rUa=this.C;this.QR=a;for(var b={},c=0,d;d=this.C[c];c++)b[d.Li()]=this.QR.vta+"-"+d.Li();a.lSb=b;this.QR=a;Xq(this.getElement(),nBc,this.QR);this.WFa=!0};
r.eQb=function(a){if(this.gia)if(this.D&&this.D.FY(9),this.Eha)this.dispatchEvent(new pBc(new qBc));else{var b=this.D||void 0;a=a.getUrl(this.F);b&&b.FY(10);b={lCc:!0};b.target=b.target||a.target||"google_popup";b.width=b.width||690;b.height=b.height||500;(b=Do(a,b))&&b.focus()}};r.Ya=function(){this.hb(this.gia,this.Eha);for(var a=this.ma(),b=this.getHandler(),c=0,d;d=this.C[c];c++){var e=a.getElement(this.QR.vta+"-"+d.Li());Ff(b,e,dd,v(this.eQb,this,d))}};
r.Ha=function(){oBc.$.Ha.call(this);delete this.F;delete this.C;this.D=null};function pBc(a,b){H.call(this,"Ye",b);this.context=a}x(pBc,H);function qBc(){}x(qBc,mBc);function sY(a,b,c,d){this.D=b;this.C=c;this.YGb=d;this.F=rBc++}var rBc=0;sY.prototype.Li=g("F");sY.prototype.getName=g("D");sY.prototype.getLabel=g("C");function sBc(){sY.call(this,0,"Facebook","Share via Facebook","ess-facebook-icon")}x(sBc,sY);sBc.prototype.getUrl=function(a){var b=sb(a,function(a){return a.C});a=sb(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Va(a.join(","))+"&t="+Va(b.join(","))};function tBc(){sY.call(this,0,"Gmail","Share via Gmail","ess-gmail-icon")}x(tBc,sY);tBc.prototype.getUrl=function(a){a=sb(a,function(a){return a.C+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Va(a.join("\n"))};function uBc(){sY.call(this,0,"Google+","Share via Google+","ess-gplus-icon")}x(uBc,sY);uBc.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Va(a[0].getUrl())};function vBc(){sY.call(this,0,"Twitter","Share via Twitter","ess-twitter-icon")}x(vBc,sY);vBc.prototype.getUrl=function(a){for(var b=Ba(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){var f=a[e].C,h=c[e]?" - ":"",k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Va(a)};function tY(a){S.call(this,a)}x(tY,S);function wBc(a){a.dispatchEvent(new H("Ze"))}tY.prototype.o0=function(){return{}};tY.prototype.XL=Jf;tY.prototype.pta=pa;function uY(a){S.call(this,a)}x(uY,S);uY.prototype.F=Jf;uY.prototype.H=pa;uY.prototype.J=pa;function xBc(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+sAc(a.locale)+'&answer=183965">Learn more</a>'),b=b+('<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
W(a.eab)+'" readonly="readonly" aria-label="'+kr("Link to published document.")+" "+W(a.HSa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
kr("HTML embed code of published document.")+" "+W(a.HSa)+'">'+nAa(a.Qeb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+U(rs({id:"pub-dialog-publish-link-button",style:2,value:a.dQb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+U(Ht({oz:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
U(rs({id:"pub-dialog-publish-button",value:a.bQb}))+'<div class="pub-dialog-checkbox-container">');a.AHb&&(c="Require viewers to sign in with their "+(U(a.domain)+" account"),b+=U(tr({id:"pub-dialog-dom-signin-req",checked:a.Kt,disabled:a.dL}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.dL?'class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.YR&&(b+=U(tr({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return V(b+"</div></div></div></div>")};function vY(a,b,c,d,e,f,h,k,l,m){vr.call(this);this.Eb=a||"";this.Jg=b;this.Od=c;this.Hd=d;this.od=l||"/publishsettings";this.C=new yBc(e);this.Tb=new oBc([new uBc,new tBc,new sBc,new vBc]);this.Za(this.Tb);this.oa=new ss(null,this.ma());this.Za(this.oa);this.V=new ss(null,this.ma());this.Za(this.V);this.mb=new ur(void 0,this.ma());this.Za(this.mb);this.Ga=new ur(void 0,this.ma());this.Za(this.Ga);this.rb=0;this.wc=new zBc;this.Za(this.wc);this.Mb=this.fc=null;this.J=f||new tY;this.Za(this.J);this.F=
h||new tY;this.Za(this.F);this.eb=k||new uY;this.Za(this.eb);this.O=this.L=null;this.zb=new At(void 0,ABc,this.ma(),2);F(this,this.zb);this.Hf=this.xe=null;this.Tg=m||new S;this.Hc=this.yb=this.gc=null;this.Gj=!0}x(vY,vr);var ABc="Press "+((Qc?"\u2318+C":"Ctrl+C")+" to copy.");r=vY.prototype;r.show=function(){BBc(this,v(function(){this.setVisible(!0)},this))};
r.setVisible=function(a){vY.$.setVisible.call(this,a);var b=em(this.ma());a?this.getHandler().R(b,"resize",this.Cd):this.getHandler().Rc(b,"resize",this.Cd)};
r.qa=function(){vY.$.qa.call(this);var a=this.ma(),b=T(xBc,{AHb:!!this.C.domain,YR:this.C.YR(),Kt:this.C.Kt,domain:this.C.C,dL:this.C.dL,bQb:CBc(this),dQb:wY(this,DBc(this))?"Published":"Publish",eab:this.C.Xk?EBc(this,this.J.o0()):"",Qeb:this.C.Xk?FBc(this,this.F.o0()):"",locale:"en",HSa:ABc});a.appendChild(this.jc(),b);Vp(this,"Publish to the web");kq(this,null);Vo(this.jc(),"pub-dialog-content")};
r.Ya=function(){var a=this.ma(),b=a.getElement("pub-dialog-sharing-services-links");this.Tb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.gc=a.getElement("pub-dialog-links-notice");this.Tg.render(this.gc);b=a.getElement("pub-dialog-published-content");this.eb.render(b);vY.$.Ya.call(this);var b=this.getHandler(),c=a.getElement("pub-dialog-dom-signin-req");c&&(this.mb.ub(c),br(this.mb,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.mb,"change",this.rVb));this.C.YR()&&(this.Ga.ub(a.getElement("pub-dialog-auto-publish-checkbox")),br(this.Ga,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Ga,"change",this.nVb));this.fc=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Mb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");yt(this.zb,this.L);this.wc.ub(a.getElement("pub-dialog-links-tab-bar"));this.xe=a.getElement("pub-dialog-sharing-services");
this.Hf=a.getElement("pub-dialog-status-info");this.oa.ub(a.getElement("pub-dialog-publish-link-button"));this.V.ub(a.getElement("pub-dialog-publish-button"));this.Hc=new sJ("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Xk);F(this,this.Hc);b.R(this.wc,"select",this.DBb).R(this.L,"focus",this.cUa).R(this.O,"focus",this.cUa).R(this.V,"action",this.fQb).R(this.getElement(),"keyup",this.v$a).R(this.J,"Ze",this.nva).R(this.F,"Ze",this.nva).R(this.oa,"action",this.Ezb).R(this.eb,"$e",
this.Fzb).R(this.Hc,"toggle",this.Cd);GBc(this)};function GBc(a){if(a.Dc()){var b=a.ma(),c=a.C.Xk,d=a.C.dL;a.eb.H(a.C.$m);a.mb.hb(!d);a.V.setContent(CBc(a));a.V.hb(a.C.Xk||!a.C.$m||!a.C.$m.isEmpty());a.C.YR()&&a.Ga.Ac(a.C.dx);a.nva();b=b.Wi("pub-dialog-state-publishing");z(b,function(a){Q(a,c)});Ul(a.Hf,c?"This document is published to the web.":"This document is not published to the web.");a.Cd()}}r.v$a=function(a){this.tb()&&27==a.keyCode&&a.stopPropagation()};
function HBc(a,b){var c=window.location.href,d=nj(c),c=rj(c),e=Za(c,"/"+a.Hd+"/")?"/"+a.Hd:"";a.C.Kt&&a.C.domain&&(e="/a/"+a.C.domain+e);var c=d[1],f=d[2],h=d[3],d=d[4];a=a.C.F||a.Eb;b=Gna.test(b)?b:Dj("/d/"+a,b);return mj(c,f,h,d,Dj(e,b))}
r.nva=function(){var a=this.J.XL();if(a=wY(this,a)){var b=this.C.Xk?EBc(this,this.J.o0()):"";this.L.value=b;this.Tb.F=[new lBc(b,this.Jg)]}Q(this.L,a);Q(this.xe,a&&!this.C.dL);a=this.F.XL();if(a=wY(this,a))this.O.value=this.C.Xk?FBc(this,this.F.o0()):"";Q(this.O,a);a=wY(this,DBc(this));Q(this.gc,a);this.oa.hb(!a);this.oa.setContent(wY(this,DBc(this))?"Published":"Publish")};
r.DBb=function(a){a=a.target;this.ma();zt(this.zb);"pub-dialog-link-tab"==a.getId()?(this.rb=0,Q(this.fc,!0),Q(this.Mb,!1),yt(this.zb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.rb=1,Q(this.fc,!1),Q(this.Mb,!0),yt(this.zb,this.O));GBc(this)};r.cUa=function(a){wi(function(){a.target.select()},0)};r.rVb=function(){this.C.Xk?IBc(this,2):this.C.Kt=!this.C.Kt};r.nVb=function(){this.C.Xk?IBc(this,0):this.C.dx=!this.C.dx};function CBc(a){return a.C.Xk?"Stop publishing":"Start publishing"}
function BBc(a,b){Hj(a.Od.Xf(a.od).dg("id",a.Eb),v(function(a){this.C.Xk=!!qk(a,"published");this.C.Kt=!!qk(a,"requireSignin");this.C.dL=!!qk(a,"domainClosed");this.C.domain=jAc(a,"domain");this.C.C=jAc(a,"domainDisplay");var c=this.C;var e=Number(qk(a,"revision"));c.dx=!e;this.C.$m=this.$Ia(a.yg());this.C.F=jAc(a,"publishedDocumentId");b()},a)).jf()}r.$Ia=Jf;r.JIa=Jf;function JBc(a){return{dx:a.C.dx,Xk:a.C.Xk,Kt:a.C.Kt,$m:a.C.$m}}
function IBc(a,b){var c=JBc(a);switch(b){case 0:c.dx=!c.dx;break;case 1:c.Xk=!c.Xk;break;case 2:c.Kt=!c.Kt;break;default:throw Error("Unknown toggle op: "+b);}c.Xk||(c.$m=a.JIa());KBc(a,c,!0)}
function KBc(a,b,c){LBc(a,!1);Gj(Hj(Ej(Ij(a.Od.Xf(a.od).dg("id",a.Eb),MBc(a,b)),2),v(function(){this.C.dx=b.dx;this.C.Xk=b.Xk;this.C.Kt=b.Kt;this.C.$m=b.$m;this.C.Xk&&this.C.$m&&(wY(this,this.J.XL())||this.J.pta(this.C.$m),wY(this,this.F.XL())||this.F.pta(this.C.$m));LBc(this,!0);GBc(this);if(c&&this.C.Xk)switch(this.rb){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.rb);}},a)),v(function(){lhc("An error occurred while saving publishing settings.",
void 0,this.Dc()?this:void 0);LBc(this,!0);GBc(this)},a)).jf()}function MBc(a,b){var c={id:a.Eb,requireSignin:b.Kt,published:b.Xk};a.C.YR()&&!b.dx&&(c.revision=a.C.D);b.$m&&(a=NBc(b.$m),rc(c,a));return c}function LBc(a,b){for(var c=[a.Ga,a.V,a.oa,a.mb],d=0;d<c.length;d++){var e=c[d];!b&&e.iq()&&(a.yb=e);e.hb(b)}b&&a.yb&&(a.tb()&&a.yb.tb()&&(c=a.yb.getElement())&&c.focus(),a.yb=null);a.eb.J(b)}
r.fQb=function(a,b){if(b||window.confirm(this.C.Xk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.V.setContent("Saving..."),IBc(this,1)};function DBc(a){switch(a.rb){case 0:return a.J.XL();case 1:return a.F.XL();default:throw Error("Cannot handle selected link type "+a.rb);}}
r.Ezb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=DBc(this),b=JBc(this);b.Xk=!0;a&&(b.$m&&this.C.Xk?b.$m=OBc(b.$m,a):b.$m=a);this.oa.setContent("Publishing...");KBc(this,b,!0)}};r.Fzb=function(){var a=this.eb.F();if(this.C.Xk)if(a&&a.isEmpty())IBc(this,1);else{var b=JBc(this);b.$m=a;KBc(this,b)}else this.C.$m=a,GBc(this)};function wY(a,b){var c;(c=a.C.Xk)&&!(c=!b||!a.C.$m)&&(a=a.C.$m,c=a.F||!b.F&&vb(b.D.Ad(),a.wba,a)&&vb(b.C,a.kba,a));return c}
function yBc(a){this.D=a;this.dL=this.Kt=this.Xk=!1;this.dx=!0;this.F=this.C=this.domain=""}yBc.prototype.YR=function(){return!!this.D};function zBc(){HT.call(this)}x(zBc,HT);zBc.prototype.hk=function(a){return a.keyCode&&27==a.keyCode?!1:zBc.$.hk.call(this,a)};function PBc(a,b,c,d){this.F=a;this.Mi=b;this.C=c;this.D=d}function QBc(a,b){return new PBc(!1,null,new RBc(a,b||"interactive"),null)}function RBc(a,b){this.id=a;this.format=b};function xY(a,b,c){this.F=a;this.D=new eg(b);this.C=c}r=xY.prototype;r.wba=function(a){return this.F||this.D.contains(a)};function SBc(a,b){return ub(a.C,function(a){return a.id==b.id})}r.kba=function(a){return this.F||this.D.contains(a.Mi)||SBc(this,a)};function TBc(a,b){a.C=rb(a.C,function(a){return a.Mi!=b})}function UBc(a,b){SBc(a,b)&&(a.C=rb(a.C,function(a){return a.id!=b.id}))}
function OBc(a,b){var c=a.F||b.F;if(c)return new xY(c,[],[]);var d=a.clone();z(b.D.Ad(),function(a){d.D.contains(a)||(d.D.add(a),TBc(d,a))});z(b.C,function(a){d.kba(a)||d.C.push(a)});return d}function NBc(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Ad().join(","),charts:sb(a.C,function(a){return a.id}).join(",")}}r.isEmpty=function(){return!this.F&&this.D.isEmpty()&&zb(this.C)};r.clone=function(){return new xY(this.F,this.D.Ad(),Kb(this.C))};
r.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&Sb(this.C,a.C,function(a,c){return a.id==c.id&&a.Mi==c.Mi})};function VBc(a,b){this.id=a;this.Mi=b};function WBc(a,b,c,d){S.call(this,void 0);this.C=c||new PBc(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new SH("",XBc(a,b));mO(this.D,!0);this.Za(this.D,!0);a=new Ls;a.Za(new Jq("Interactive","interactive"),!0);a.Za(new Jq("Image","image"),!0);this.H=new SH("",a);this.Za(this.H,!0);a=new Ls;a.Za(new Jq("Web page","html"),!0);a.Za(new Jq("Comma-separated values (.csv)","csv"),!0);a.Za(new Jq("Tab-separated values (.tsv)","tsv"),!0);a.Za(new Jq("PDF document (.pdf)","pdf"),!0);a.Za(new Jq("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Za(new Jq("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new SH("",a);this.Za(this.F,!0);YBc(this)}x(WBc,tY);var ZBc=["xlsx","ods"],$Bc=["csv","tsv"];
function XBc(a,b){var c=new Ls;c.Za(new Jq("Entire Document",new aCc("entireDocument",null)),!0);c.Za(new Ks,!0);var d=WZa(b);z(a.D,function(a){c.Za(new Jq(a.C,new aCc("sheet",a.Fb())),!0);if(a=d[a.Fb()])for(var b=0;b<a.length;b++){var e=a[b];6==e.getType()&&e.isSaved()&&(e=new Jq(iAc(e),new aCc("chart",GB(e))),c.Za(e,!0),Vo(e.jc(),"pub-dialog-link-options-chart-menu-item"))}});return c}r=WBc.prototype;
r.Ya=function(){WBc.$.Ya.call(this);Vo(this.getElement(),"pub-dialog-link-options-container");Vo(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Vo(this.D.jc(),"pub-dialog-link-options-document-part-menu-button-content");Vo(this.D.Pc().getElement(),"pub-dialog-link-options-document-part-menu");So(this.D.Ia,"Sheet or chart selection");So(this.H.Ia,"Chart format");So(this.F.Ia,"Sheet format");this.getHandler().R(this.D,"change",this.$pb).R(this.H,"change",this.Tmb).R(this.F,
"change",this.kCb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};r.$pb=function(){var a=this.D.Nf().pb();switch(a.type){case "entireDocument":this.C=new PBc(!0,null,null,this.C.D||"html");break;case "sheet":var a=a.id,b=this.C.D;b&&!bCc(this,a,b)&&(b=null);this.C=new PBc(!1,a,null,b||"html");break;case "chart":this.C=QBc(a.id,this.C.C?this.C.C.format:null)}YBc(this);wBc(this)};
r.Tmb=function(){var a=this.H.Nf().pb();this.C.C&&(this.C.C.format=a,wBc(this))};r.kCb=function(){var a=this.F.Nf().pb();this.C.D=a;wBc(this)};
function YBc(a){var b=Kb(a.D.$j.C),b=wb(b,function(a){a=a.pb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Mi&&a.id==this.C.Mi;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);gt(a.D,b);b=!!a.C.C;Q(a.H.getElement(),b);null!=a.C.C&&a.H.ob(a.C.C.format);Q(a.F.getElement(),a.J&&lra&&!b);b||(cCc(a),a.F.ob(a.C.D))}
function cCc(a){for(var b=a.F.Pc(),c=0;c<b.Nk();c++){var d=b.Gf(c),e=d.bb();d.hb(null==a.C.Mi||bCc(a,a.C.Mi,e))}}function bCc(a,b,c){if(yb(ZBc,c))return!1;a=bv(a.O,b);return null!=a&&1==a.getSheetType()&&yb($Bc,c)?!1:!0}r.o0=g("C");r.XL=function(){if(this.C.F)return new xY(!0,[],[]);if(null!=this.C.Mi)return new xY(!1,[this.C.Mi],[]);var a=this.L.C(this.C.C.id),a=new VBc(this.C.C.id,a.Fb());return new xY(!1,[],[a])};
r.pta=function(a){if(!a.F){var b=a.D.Ad();0<b.length?this.C=new PBc(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=QBc(a[0].id)));YBc(this)}};function aCc(a,b){this.type=a;this.id=b};function yY(a,b){Os.call(this,void 0,void 0,new RH,void 0);this.$a=a;this.Sa=b;this.H=new xY(!0,[],[]);this.V=!1;this.J=new qJ("Entire Document");this.Ce(this.J);this.Ce(new Ks);dCc(this);mO(this,!0);eCc(this)}x(yY,Os);function dCc(a){var b=WZa(a.Sa);z(a.$a.D,function(c){var d=new qJ(c.C,c);a.Ce(d);(c=b[c.Fb()])&&z(c,function(b){6==b.getType()&&b.isSaved()&&(b=new qJ(iAc(b),b),a.Ce(b),Vo(b.jc(),"pub-dialog-published-content-chart-menu-item"))})})}
yY.prototype.Ya=function(){yY.$.Ya.call(this);Vo(this.getElement(),"pub-dialog-published-content-menu-button");Vo(this.jc(),"pub-dialog-published-content-menu-button-content");Vo(this.Pc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
yY.prototype.wt=function(a){if(a.target==this.J){a=this.J.isChecked();var b=this.H;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.pb(),b instanceof Nu?(b=b.Fb(),a?(a=this.H,a.D.contains(b)||(a.D.add(b),TBc(a,b))):(a=this.H,a.D.contains(b)&&(a.D.remove(b),TBc(a,b)))):(b=new VBc(GB(b),b.Fb()),a?(a=this.H,a.kba(b)||a.C.push(b)):UBc(this.H,b));this.V=!0;eCc(this)};yY.prototype.ze=function(a,b){yY.$.ze.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new H("$e")))};
function eCc(a){var b=a.H.F;a.J.Ac(b);z(Hgc(a.Pc()),function(c){var d=c.pb();d&&(d instanceof Nu?(c.Ac(a.H.wba(d.Fb())),c.hb(!b)):(d=new VBc(GB(d),d.Fb()),c.Ac(a.H.kba(d)),c.hb(!a.H.wba(d.Mi))))});fCc(a)}function fCc(a){if(a.H.F)var b="Entire Document";else{b=rb(a.$a.D,v(function(a){return this.H.wba(a.Fb())},a));b=sb(b,function(a){return a.C});for(var c=[],d=a.H.C,e=0;e<d.length;e++){var f=a.Sa.C(d[e].id);f&&c.push(iAc(f))}b=Jb(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function zY(a,b){S.call(this,void 0);this.C=new yY(a,b);this.Za(this.C,!0);this.D=!1}x(zY,uY);zY.prototype.Ya=function(){zY.$.Ya.call(this);Vo(this.getElement(),"pub-dialog-published-content-container")};zY.prototype.F=function(){return this.C.H};zY.prototype.H=function(a){var b=this.C;b.H=a.clone();eCc(b)};zY.prototype.J=function(a){!a&&this.C.iq()&&(this.D=!0);this.C.hb(a);a&&this.D&&(this.Dc()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function gCc(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+sAc(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return V(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function hCc(a,b,c,d,e,f,h){var k=null!=h?QBc(h):null;h=new WBc(c,d,k,!0);k=new WBc(c,d,k,!1);vY.call(this,a,b,e,Jqa,f,h,k,new zY(c,d),"/publishingsettings",new iCc);this.ai=c;this.Qc=d}x(hCc,vY);
hCc.prototype.$Ia=function(a){if(a.entireDocument)return new xY(!0,[],[]);var b=a.charts||"";a=sb((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=rb(a,function(a){return null!=bv(this.ai,a)},this);b=sb(b.split(","),function(a){return parseInt(a,10)});b=rb(b,v(function(a){return!!this.Qc.C(a)},this));b=sb(b,function(a){var b=this.Qc.C(a);return new VBc(a,b.Fb())},this);return new xY(!1,a,b)};hCc.prototype.JIa=function(){return new xY(!0,[],[])};
function EBc(a,b){if(b.F||null!=b.Mi){var c="html"==b.D;a=HBc(a,c?"/pubhtml":"/pub");null!=b.Mi&&(a=xj(a,"gid",b.Mi,"single","true"));c||(a=xj(a,"output",b.D))}else a=xj(HBc(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function FBc(a,b){var c=EBc(a,b);if(b.F||null!=b.Mi)c=xj(c,"widget","true","headers","false");a=b.C?(a=a.Qc.C(b.C.id))?a.Uc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Xa(c)+'"></iframe>'}function iCc(){}x(iCc,S);iCc.prototype.qa=function(){this.Ia=T(gCc,{locale:"en"})};function jCc(a,b,c){return Fza(a||"There was a problem",jl(b),void 0,void 0,void 0,void 0,c)};function kCc(a){return V("<div><div>"+U(a.c7a)+"</div>"+U(tr({id:"waffle-confirm-suppress-checkbox",Je:"waffle-confirm-suppress-checkbox"}))+'<span id="waffle-confirm-suppress-label">'+U(a.Mua)+"</span></div>")};function lCc(a,b,c,d,e,f,h){if(ya(c)){var k=new hq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=Tya;return mCc(d||"Heads up!",a,b,k,e,f,h)}function mCc(a,b,c,d,e,f,h){b=jl(b);if(f){b=Wq(kCc({c7a:b,Mua:f}));var k=new ur;var l=c;c=function(){l(k.isChecked())}}a=Gza(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Za(k),k.ub(bm(a.ma(),"waffle-confirm-suppress-checkbox")),c=bm(a.ma(),"waffle-confirm-suppress-label"),br(k,c),k.Ac(!1));return a};function AY(a,b){gy.call(this,36,null);this.D=a;this.Sd=b}x(AY,gy);AY.prototype.exec=Jf;AY.prototype.Qe=n(38);AY.prototype.Le=function(){var a=new Tw;D(a,2,this.D);D(a,1,this.Sd);return a};AY.prototype.Mg=function(){return B(this.D,1)?"Data validation applied.":"Data validation cleared."};function BY(){var a=new SH(null);mO(a,!0);return a};function nCc(a,b,c){I.call(this);this.D=a;this.Ah=b;this.Eb=c;this.V=this.J=this.Ma=this.Ga=this.Z=this.H=null;this.gc=new MO;this.od=new MO;this.oa=this.O=null;this.Qc=new MO;this.xe=new MO;this.ea=this.L=null;this.wc=new MO;this.Hd=new MO;this.eb=this.Tb=null;this.C=new xV("");this.mb=this.F=this.Mb=this.zb=this.rb=null;this.nf=this.fc=!1;this.Hc=this.Od=this.yb=this.$a=null;this.fb=new J(this);F(this,this.fb);this.Ie=new gh;this.Ze=this.Tg=this.Hf=this.He=this.Jg=this.Sa=null;this.gy();a=this.fb;
a.R(this.H,"action",this.aub);a.R(this.Z,"action",this.Koa);a.R(this.Ga,"action",this.Koa);a.R(this.Ma,"action",this.Koa);a.R(this.F,"focus",Ea(this.HUa,!0));a.R(this.F,"blur",Ea(this.HUa,!1));a.R(this.F,"change",this.xoa);a.R(this.F,"keyup",this.xoa);b=[this.O,this.oa,this.J,this.V,this.L,this.ea];for(c=0;c<b.length;c++)this.fb.R(b[c],"change",v(this.qXb,this,b[c])),this.fb.R(b[c],"keyup",v(this.rXb,this,b[c]));a.R(this.yb,"change",v(this.yNa,this));Ff(a,this.mb,dd,this.LAb)}x(nCc,I);
var oCc="placeholder"in document.createElement("input"),pCc=/\s*,\s*/;function qCc(a){var b=a.Ze;b||(b=[{ij:"List from a range",type:4},{ij:"List of items",type:3},{ij:"Number",type:0},{ij:"Text",type:1},{ij:"Date",type:2},{ij:"Custom formula is",type:5}],gra&&b.push({ij:"Checkbox",type:6}),a.Ze=b);return b}
function rCc(a){var b=a.Tg;b||(b=[{ij:"contains",code:9,inputs:0,example:"Approved"},{ij:"does not contain",code:10,inputs:0,example:"Approved"},{ij:"equals",code:13,inputs:0,example:"Approved"},{ij:"is valid email",code:14,inputs:-1,example:null},{ij:"is valid url",code:15,inputs:-1,example:null}],a.Tg=b);return b}
function sCc(a){var b=a.He;b||(b=[{ij:"is valid date",code:30,inputs:-1,example:null},{ij:"equal to",code:16,inputs:2,example:"11/15/2014"},{ij:"before",code:17,inputs:2,example:"11/15/2014"},{ij:"on or before",code:19,inputs:2,example:"11/15/2014"},{ij:"after",code:18,inputs:2,example:"11/15/2014"},{ij:"on or after",code:20,inputs:2,example:"11/15/2014"},{ij:"between",code:21,inputs:3,example:"11/15/2014",ZR:"11/15/2015"},{ij:"not between",code:22,inputs:3,example:"11/15/2014",ZR:"11/15/2015"}],
a.He=b);return b}function tCc(a){var b=a.Hf;b||(b=[{ij:"range",code:23,inputs:6,example:null},{ij:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Hf=b);return b}
function uCc(a){var b=a.Jg;b||(b=[{ij:"between",code:7,inputs:8,example:"10",ZR:"100"},{ij:"not between",code:8,inputs:8,example:"10",ZR:"100"},{ij:"less than",code:3,inputs:7,example:"10"},{ij:"less than or equal to",code:4,inputs:7,example:"10"},{ij:"greater than",code:1,inputs:7,example:"10"},{ij:"greater than or equal to",code:2,inputs:7,example:"10"},{ij:"equal to",code:5,inputs:7,example:"10"},{ij:"not equal to",code:6,inputs:7,example:"10"}],a.Jg=b);return b}
function vCc(){return{ij:"",code:29,inputs:0,example:"=ISODD(A1)"}}function wCc(){return{ij:"",code:31,inputs:-1,example:""}}r=nCc.prototype;
r.gy=function(){var a=this.D,b,c,d,e,f,h,k,l,m,p,q,u=a.ma(),w;var y=u.qa("TR","waffle-dv-trrules",u.qa("TD","waffle-dv-label",u.qa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),u.qa("TD",{XAc:"7"},l=u.qa("DIV","goog-inline-block"),w=u.qa("DIV","goog-inline-block"),h=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),b=
u.qa("SPAN","waffle-dv-separator","and"),k=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=u.qa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.wc.ub(h);this.Hd.ub(k);this.Qc.ub(c);this.xe.ub(d);this.gc.ub(e);this.od.ub(f);var C=BY();Mp(C,l);var K=BY();Mp(K,l);var N=BY();Mp(N,l);var R=BY();Mp(R,l);var Z=xCc(a,w);(m=C.getElement())&&Po(m,"labelledby","waffle-dv-criteria");
var ha;var ia=u.qa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",u.qa("TD"),u.qa("TD",{colspan:"7"},ha=u.qa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));var na=new ur;br(na,ha);Mp(na,ha);var wa=u.qa("TR","waffle-dv-trrules",u.qa("TD","waffle-dv-label",u.qa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),u.qa("TD",{colspan:"7"},u.qa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},u.qa("INPUT",
{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",role:"radio"}),u.qa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),u.qa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),u.qa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new zV(!0);AV(m,"onInvalidData",wa);var xa=u.qa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",u.qa("TD",null,u.qa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),
u.qa("TD",{colspan:"7"},p=u.qa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));var Pa=new ur;br(Pa,p);Mp(Pa,p);p=Pa.Ia;var eb=Ixa(p,"labelledby");Po(p,"labelledby","waffle-dv-appearance "+eb);p=u.qa("TR","waffle-dv-trrules",u.qa("TD"),u.qa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},q=u.qa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),eb=u.qa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},
"Reset")));Wl(eb,!0);a=a.O.childNodes[0];u.appendChild(a,y);u.appendChild(a,ia);u.appendChild(a,wa);u.appendChild(a,xa);u.appendChild(a,p);this.C.render(l);u=this.C;u.Wqa=29;u.resize();u=this.C;u.hQa=200;u.resize();this.C.getElement().style.width="324px";oCc?this.C.getElement().placeholder="Enter items separated by a comma...":(u=this.C.getElement(),qs(u,"Enter items separated by a comma...","Enter items separated by a comma..."));if(u=this.C.getElement())So(u,"Enter items separated by a comma..."),
Wo(u,["waffle-dv-list-options-textarea","jfk-textinput"]);fra&&(a=new aH("Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday;Monday, Tuesday, Wednesday, Thursday, Friday;January, February, March, April, May, June, July, August, September, October, November, December;Alabama, Alaska, Arizona, Arkansas, California, Colorado, Connecticut, Delaware, District of Columbia, Florida, Georgia, Hawaii, Idaho, Illinois, Indiana, Iowa, Kansas, Kentucky, Louisiana, Maine, Maryland, Massachusetts, Michigan, Minnesota, Mississippi, Missouri, Montana, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, New York, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, Rhode Island, South Carolina, South Dakota, Tennessee, Texas, Utah, Vermont, Virginia, Washington, West Virginia, Wisconsin, Wyoming;AK, AL, AR, AZ, CA, CO, CT, DC, DE, FL, GA, HI, IA, ID, IL, IN, KS, KY, LA, MA, MD, ME, MI, MN, MO, MS, MT, NC, ND, NE, NH, NJ, NM, NV, NY, OH, OK, OR, PA, RI, SC, SD, TN, TX, UT, VA, VT, WA, WI, WV, WY;United States of America, USA, Afghanistan, Albania, Algeria, Andorra, Angola, Antigua & Deps, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Barbados, Belarus, Belgium, Belize, Benin, Bhutan, Bolivia, Bosnia Herzegovina, Botswana, Brazil, Brunei, Bulgaria, Burkina, Burma, Burundi, Cambodia, Cameroon, Canada, Cape Verde, Central African Republic, Chad, Chile, China, People's Republic of China, Republic of China, Colombia, Comoros, Democratic Republic of the Congo, Republic of the Congo, Costa Rica, Croatia, Cuba, Cyprus, Czech Republic, Danzig, Denmark, Djibouti, Dominica, Dominican Republic, East Timor, Ecuador, Egypt, El Salvador, Equatorial Guinea, Eritrea, Estonia, Ethiopia, Fiji, Finland, France, Gabon, The Gambia, Georgia, Germany, Ghana, Greece, Grenada, Guatemala, Guinea, Guinea-Bissau, Guyana, Haiti, Holy Roman Empire, Honduras, Hungary, Iceland, India, Indonesia, Iran, Iraq, Republic of Ireland, Israel, Italy, Ivory Coast, Jamaica, Japan, Jonathanland, Jordan, Kazakhstan, Kenya, Kiribati, North Korea, South Korea, Kosovo, Kuwait, Kyrgyzstan, Laos, Latvia, Lebanon, Lesotho, Liberia, Libya, Liechtenstein, Lithuania, Luxembourg, Macedonia, Madagascar, Malawi, Malaysia, Maldives, Mali, Malta, Marshall Islands, Mauritania, Mauritius, Mexico, Micronesia, Moldova, Monaco, Mongolia, Montenegro, Morocco, Mount Athos, Mozambique, Namibia, Nauru, Nepal, Newfoundland, Netherlands, New Zealand, Nicaragua, Niger, Nigeria, Norway, Oman, Ottoman Empire, Pakistan, Palau, Palestine, Panama, Papua New Guinea, Paraguay, Peru, Philippines, Poland, Portugal, Prussia, Qatar, Romania, Rome, Russian Federation, Rwanda, St Kitts & Nevis, St Lucia, Saint Vincent, Grenadines, Samoa, San Marino, Sao Tome & Principe, Saudi Arabia, Senegal, Serbia, Seychelles, Sierra Leone, Singapore, Slovakia, Slovenia, Solomon Islands, Somalia, South Africa, Spain, Sri Lanka, Sudan, Suriname, Swaziland, Sweden, Switzerland, Syria, Tajikistan, Tanzania, Thailand, Togo, Tonga, Trinidad & Tobago, Tunisia, Turkey, Turkmenistan, Tuvalu, Uganda, Ukraine, United Arab Emirates, United Kingdom, Uruguay, Uzbekistan, Vanuatu, Vatican City, Venezuela, Vietnam, Yemen, Zambia, Zimbabwe;Pass, Fail;Yes, No;Approved, Rejected;Approved, Rejected, Pending;Complete, In Progress, Not Started;On Track, At Risk, Delayed;True, False;Q1, Q2, Q3, Q4;Small, Medium, Large;XS, S, M, L, XL;A+, A, A-, B+, B, B-, C+, C, C-, D, F".split(";"),
!0),wa=new cH,y=new eH(null,null,!1),a=new ZG(a,wa,y),y.C=a,y.F0(u),a.Ge().nua=!0);this.F=q;C.setVisible(!0);q=qCc(this);yCc(this,q,C);q=uCc(this);yCc(this,q,R);q=rCc(this);yCc(this,q,K);q=sCc(this);yCc(this,q,N);zCc(this,C,R,K,N,h,k,c,d,e,f,b,l,Z,ia,p,na,ha,eb,Pa,w,m)};
function zCc(a,b,c,d,e,f,h,k,l,m,p,q,u,w,y,C,K,N,R,Z,ha,ia){a.H=b;a.H.setVisible(!0);a.Ga=c;a.Z=e;a.Ma=d;a.Tb=q;a.L=f;a.ea=h;a.O=k;a.oa=l;a.J=m;a.V=p;a.eb=u;a.Sa=w;a.rb=ha;Z.Ac(!1);a.yb=Z;a.Hc=ia;ACc(a,!1);a.zb=y;K.Ac(!0);a.$a=K;a.Od=N;a.Mb=C;Q(a.Mb,!0);BCc(a);CCc(a);a.mb=R;Q(a.mb,!1)}function DCc(a,b){Q(a.zb,23==b||24==b||31==b);a.Od.innerText=31==b?"Display in-cell checkbox":"Show dropdown list in cell"}
function yCc(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.ma(),e=new Jq(b[d].ij,null,e);c.Ce(e);No(e.getElement(),"menuitem")}c.ag(0)}r.Koa=function(){CCc(this);this.F.value=CY(this);this.dispatchEvent("change")};r.aub=function(){BCc(this);CCc(this);this.F.value=CY(this);this.dispatchEvent("change")};r.HUa=ca("nf");r.xoa=function(a){this.fc||a&&!Lwa(a)||this.F.value===ECc(this)||(this.fc=!0,Q(this.mb,!0))};r.LAb=function(){this.fc=!1;this.F.value=CY(this);Q(this.mb,!1)};
r.yNa=function(){Q(this.Mb,this.yb.L)};r.qXb=function(a){this.F.value=CY(this);FCc(this,a)?(this.D.Mn=0,DY(a),this.dispatchEvent("change")):(this.D.Mn=1,EY(a),this.dispatchEvent("error"))};r.rXb=function(){this.dispatchEvent("keyup")};function FCc(a,b){if(0!=FY(a))return!0;var c=b.value;if(null!=c&&xp(b)){if(!GCc(a.D))return!0;a=GY(a,c,HCc(a).code);return null!=a&&(wc(a,3)||wc(a,5)&&B(a,5).ud()&&3==B(B(a,5).bb(),1))}return!0}function EY(a){a.select();Vo(a,"waffle-input-error")}
function DY(a){a&&Xo(a,"waffle-input-error")}function FY(a){return qCc(a)[a.H.Oh()].type}function BCc(a){var b=FY(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.Z.setVisible(c);a.Ga.setVisible(d);a.Ma.setVisible(e);Q(a.eb,f);Q(a.rb,h);Q(a.L,!1);Q(a.ea,!1);Q(a.O,!1);Q(a.oa,!1);Q(a.J,!1);Q(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function HCc(a){var b;null!=ICc(a)?b=ICc(a):a.Z.tb()?b=sCc(a)[a.Z.Oh()]:a.Ga.tb()?b=uCc(a)[a.Ga.Oh()]:5==FY(a)?b=vCc():6==FY(a)?b=wCc():b=rCc(a)[a.Ma.Oh()];return b}function ICc(a){var b=tCc(a);return 4==FY(a)?b[0]:3==FY(a)?b[1]:null}
function CCc(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,p=HCc(a);-1!=p.inputs&&(0==p.inputs?d=!0:1==p.inputs?k=e=d=!0:2==p.inputs?f=!0:3==p.inputs?k=h=f=!0:7==p.inputs?b=!0:8==p.inputs?k=c=b=!0:5==p.inputs?l=!0:6==p.inputs&&(m=!0));var q=HCc(a);if(3==FY(a))oCc?a.C.getElement().placeholder="Enter items separated by a comma...":(q=a.C.getElement(),qs(q,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(q.example)if(0==q.inputs||1==q.inputs)HS(a.Qc,"e.g., "+
q.example),HS(a.xe,"e.g., "+q.ZR||"");else if(2==q.inputs||3==q.inputs)HS(a.gc,"e.g., "+q.example),HS(a.od,"e.g., "+q.ZR||"");else if(7==q.inputs||8==q.inputs)HS(a.wc,"e.g., "+q.example),HS(a.Hd,"e.g., "+q.ZR||"");DY(a.C.getElement());DY(a.J);DY(a.V);DY(a.L);DY(a.ea);DY(a.O);DY(a.oa);DY(a.Sa.vs());a.D.Mn=0;a.dispatchEvent("change");Q(a.L,b);Q(a.ea,c);Q(a.O,d);Q(a.oa,e);Q(a.J,f);Q(a.V,h);Q(a.eb,l);l&&a.C.resize();Q(a.rb,m);DCc(a,p.code);Q(a.Tb,k)}
function GY(a,b,c){var d=GCc(a.D);if(""==b||null==d.bd)return null;var e=d.rect,f=e.yc(),e=e.tc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.bd+"",f,e,b,c,!0))?a.Ie.ld(Sd.Wa(),b):null}function JCc(a){var b=Ua(a.Sa.bb());!a.Eb.C.D[Ua(fb(b).toLowerCase())]&&iD(a.Eb,b)&&(b=G_a(a.Eb,b,!0));return b}function CY(a){return a.fc||a.nf?a.F.value:ECc(a)}
function ECc(a){var b="";var c=FY(a);var d=4==c;c=3==c||4==c;a.Z.tb()?(c=sCc(a)[a.Z.Oh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date "):a.Ma.tb()?(c=rCc(a)[a.Ma.Oh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that "):c?(c=ICc(a),b+="Click and enter a value from "):5==FY(a)?(c=vCc(),b="Enter a value that satisfies the formula:"):6==FY(a)?(c=wCc(),b="Enter TRUE or FALSE"):(c=uCc(a)[a.Ga.Oh()],b+="Enter a number ");-1!=c.inputs&&(b+=c.ij);var e=JCc(a);
23==c.code&&""!=e&&d&&(d=G_a(a.Eb,e,!0))&&(b+=" "+d);Ra(fb(a.O.value))||0!=c.inputs&&1!=c.inputs?Ra(fb(a.J.value))||2!=c.inputs&&3!=c.inputs?Ra(fb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.J.value:b+=" "+a.O.value;Ra(fb(a.oa.value))||1!=c.inputs?Ra(fb(a.V.value))||3!=c.inputs?Ra(fb(a.ea.value))||8!=c.inputs||(b+=" and "+a.ea.value):b+=" and "+a.V.value:b+=" and "+a.oa.value;return b}function ACc(a,b){BV(a.Hc,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}
function HY(a,b){switch(b){case 0:a.H.ag(2);break;case 1:a.H.ag(3);break;case 2:a.H.ag(4);break;case 3:a.H.ag(1);break;case 4:a.H.ag(0);break;case 5:a.H.ag(5);break;case 6:a.H.ag(6)}}r.Ha=function(){this.ea=this.L=this.oa=this.O=this.V=this.J=null;G(this.C);this.zb=this.$a=this.mb=this.F=this.Tb=this.C=null;G(this.Sa);this.Sa=null;G(this.$a);this.$a=null;G(this.Ma);this.Ma=null;G(this.Ga);this.Ga=null;G(this.Z);this.Z=null;G(this.H);this.H=null;nCc.$.Ha.call(this)};function KCc(a,b,c,d,e){Up.call(this);this.Ga=a;this.rb=b;this.eb=c;this.mb=d;this.V=e;this.F=this.O=null;this.fb=new J(this);F(this,this.fb);this.oa=this.J=this.C=null;this.L=new hq;this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);kq(this,this.L);eq(this,!1);this.render();a=this.jc();b=rl(a);Vp(this,"Data validation");this.J||(c=b.qa("DIV",{"class":LCc.$Ya}),d=b.qa("DIV",{"class":LCc.ZYa},c),b.appendChild(a,d),this.J=new Ar(d),this.J.setType("warning"),
this.J.setContent(""),this.J.render(c),ZAa(this.J,!0),this.J.setVisible(!1));this.O=b.qa("TABLE",{cellSpacing:"0","class":LCc.YJ},b.qa("TBODY"));b.appendChild(a,this.O);a=this.jc();a=rl(a);b=a.qa("TR",LCc.w3a);b.appendChild(a.qa("TD","waffle-dv-label",a.qa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.qa("TD",{colspan:"7"});this.C=xCc(this,c);MCc(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.vs())&&Po(a,"labelledby","waffle-dv-cell-range");this.F=new nCc(this,
this.Ga,this.V);Rq(this,"save");this.fb.R(this,"dialogselect",this.pXb).R(this.F,"error",this.Wtb).R(this.F,"change",this.oXb)}x(KCc,Up);var LCc={YJ:"waffle-dv-table",w3a:"waffle-dv-trrules",ZYa:"waffle-input-error-butter-container",$Ya:"waffle-input-error-butter-wrap",E0a:"waffle-input-error"};r=KCc.prototype;r.Mn=0;function MCc(a){if(a.C){var b=a.Ga.getActiveGrid();b&&(b=yv(rB(a.eb).Xc(),b.C),a.C.ob(b))}}r.Wtb=function(){NCc(this)};r.oXb=function(){NCc(this);nq(this.L,"save",!0)};
r.pXb=function(a){if("save"==a.key){var b=this.F;var c=FY(b);if(0==c){var c=b.L,d=b.ea,e=FCc(b,c),f=FCc(b,d);e&&f?b.D.Mn=0:(e||EY(c),f||EY(d),b.D.Mn=1)}else 1==c?(c=b.O,d=b.oa,e=!xp(c)||!Ra(fb(c.value)),f=!xp(d)||!Ra(fb(d.value)),e&&f?b.D.Mn=0:(e||EY(c),f||EY(d),b.D.Mn=6)):2==c?(c=b.J,d=b.V,e=!xp(c)||!Ra(fb(c.value)),f=!xp(d)||!Ra(fb(d.value)),e&&f?b.D.Mn=0:(e||EY(c),f||EY(d),b.D.Mn=7)):3==c||4==c?(c=0,4==FY(b)?(d=JCc(b),iD(b.Eb,d)?(d=JCc(b),d=jD(b.Eb,d),e=GCc(b.D),null!=d&&null!=e&&d.bd==e.bd&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==FY(b)&&b.C.getElement()&&Ra(fb(b.C.bb()))&&(c=5),d=c,c=0==d,b.D.Mn=d,d=b.rb&&xp(b.rb),b.eb&&xp(b.eb)?(Zo(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.ma().yx(b.Sa.getElement()),Zo(d,"waffle-input-error",!c),b.Sa.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error")):b.D.Mn=0;b=this.C.bb();b=iD(this.V,b);2==this.Mn&&b?this.Mn=0:0!=this.Mn||b||(this.Mn=2);NCc(this);if(0!=this.Mn)b=!1;else{b=this.F;c=b.Hc.isChecked("rejectInvalidData_radio");d=
CY(b);b.yb.isChecked()||(d="");b:{var e=new Vd,h=HCc(b),f=h.code,k=[];switch(h.inputs){case 0:k.push(GY(b,b.O.value,f));break;case 1:k.push(GY(b,b.O.value,f));k.push(GY(b,b.oa.value,f));break;case 2:k.push(GY(b,b.J.value,f));break;case 3:k.push(GY(b,b.J.value,f));k.push(GY(b,b.V.value,f));break;case 7:k.push(GY(b,b.L.value,f));break;case 8:k.push(GY(b,b.L.value,f));k.push(GY(b,b.ea.value,f));break;case 5:for(var h=b.C.bb().split(","),l=0;l<h.length;l++)k.push(rAc(h[l]));break;case 6:h=tIa("="+b.Sa.bb()),
k.push(GY(b,h,f))}for(h=0;h<k.length;h++)if(!k[h]){e=null;break b}f=eT(f,k);D(e,1,f)}(f=e)?(e=new Wd,D(e,1,f),D(e,2,d),D(e,3,c),b=xp(b.zb)&&b.$a.isChecked(),D(e,4,b),b=(b=OCc(this))?this.mb.C(new AY(e,b)):!1):b=!1}if(!b){a.preventDefault();return}}else{if(b="clear"==a.key)b=OCc(this),b=!(b&&this.mb.C(new AY(new Wd,b)));if(b){a.preventDefault();return}}this.C&&this.C.hb(!1)};
function NCc(a){var b=PCc(a.Mn);b&&a.J.setContent(b);a.J.setVisible(0!=a.Mn);var b=2==a.Mn||4==a.Mn,c=a.ma().yx(a.C.getElement());Zo(c,LCc.E0a,b);b&&a.C.vs().select()}
function PCc(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date"}return null}function OCc(a){var b=a.C.bb(),b=(b=jD(a.V,b))?b.rect:null,c=a.C.bb();a=(a=jD(a.V,c))?a.bd:null;return b&&null!=a?kh(b,a):null}
function GCc(a){var b=a.C.bb();return jD(a.V,b)}function xCc(a,b){var c=a.Ga.C.C,c=new LU(a.eb,v(a.nXb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.ma());a.getHandler().R(c,"change",function(){var a=this.F;a&&(a.F.value=CY(a))});c.render(b);return c}r.setVisible=function(a){KCc.$.setVisible.call(this,a);a&&this.oa&&(this.oa.focus(),this.oa=null)};r.nXb=function(a,b,c,d){this.oa=a.vs();this.rb.Kea(this,a,b,c,!1,!0,d)};
r.show=function(){var a="",b=!1,c=fv(this.Ga),d=Iv(c),c=wA(Jv(c,d)),e=null,d=!1;c&&(c=c.C,e=B(c,1),a=B(c,2),b=B(c,3),d=B(c,4));var c=this.F,f=e,h=d;c.H.ag(0);c.Z.ag(0);c.Ga.ag(0);c.Ma.ag(0);c.F.value="";c.L.value="";c.ea.value="";c.J.value="";c.V.value="";c.O.value="";c.oa.value="";c.C.ob("");c.Sa.ob("");ACc(c,!1);var k=c.fc=!1,l=!1,m=!1,p=!1,q=!1,u=!1,w=!1,y=e=d=!1,C=!1,K=!1,N=!1,R=!1,Z=!1,ha=!1,ia=!1,na=f&&B(f,1),f=na&&B(na,1);if((na=na&&Bc(na,2))&&f){for(var wa=tCc(c),xa=sCc(c),Pa=uCc(c),eb=rCc(c),
Sa=vCc(),Ja=wCc(),pb=0,Xb=0;Xb<wa.length;Xb++)if(f==wa[Xb].code){pb=wa[Xb].inputs;23==wa[Xb].code?(Z=!0,HY(c,4)):(C=!0,HY(c,3));c.$a.Ac(!!h);break}for(wa=0;wa<xa.length;wa++)if(f==xa[wa].code){pb=xa[wa].inputs;c.Z.ag(wa);HY(c,2);K=d=!0;break}for(xa=0;xa<Pa.length;xa++)if(f==Pa[xa].code){pb=Pa[xa].inputs;c.Ga.ag(xa);HY(c,0);N=e=!0;break}for(Pa=0;Pa<eb.length;Pa++)if(f==eb[Pa].code){pb=eb[Pa].inputs;c.Ma.ag(Pa);HY(c,1);R=y=!0;break}f==Sa.code&&(pb=Sa.inputs,HY(c,5),ha=!0);f==Ja.code&&(pb=Ja.inputs,
HY(c,6),c.$a.Ac(!!h),ia=!0);if(K||R||N||C||Z||ha||ia){if(N=GCc(c.D),h=N.rect.yc(),K=N.rect.tc(),N=N.bd+"",-1!=pb)if(0==pb)q=wz(na[0],N,h,K),c.Qc.ob(q),q=!0;else if(1==pb)u=wz(na[0],N,h,K),q=wz(na[1],N,h,K),c.Qc.ob(u),c.xe.ob(q),u=q=w=!0;else if(2==pb)k=wz(na[0],N,h,K),c.gc.ob(k),k=!0;else if(3==pb)l=wz(na[0],N,h,K),k=wz(na[1],N,h,K),c.gc.ob(l),c.od.ob(k),l=k=w=!0;else if(7==pb)m=wz(na[0],N,h,K),c.wc.ob(m),m=!0;else if(8==pb)p=wz(na[0],N,h,K),m=wz(na[1],N,h,K),c.wc.ob(p),c.Hd.ob(m),p=m=w=!0;else if(5==
pb){C=!0;pb=[];for(R=0;R<na.length;R++)pb.push(wz(na[R],N,h,K));c.C.ob(pb.join(","));c.C.resize()}else 6==pb&&(Z=!0,pb=wz(na[0],N,h,K),null!=pb&&(pb=pb.substring(1),na=!!uv(pb),pb=(h=wv(pb,c.Ah,!1,!0))?yv(h.rect,h.Yh):pb,na||(pb=vv(pb)),c.Sa.ob(pb)))}else c.H.ag(0),Z=!0;Q(c.Tb,w);c.Z.setVisible(d);c.Ga.setVisible(e);c.Ma.setVisible(y);Q(c.J,k);Q(c.V,l);Q(c.O,q);Q(c.oa,u);Q(c.L,m);Q(c.ea,p);Q(c.zb,!0);Q(c.eb,C);c.C.resize();Q(c.rb,Z);null!=f&&DCc(c,f)}else{if(cra){d=fv(c.Ah);e=d.Xc();y=new eg;for(C=
e.yc();C<e.Sc();C++)for(Z=e.tc();Z<e.Yc();Z++)f=d.Pf(C,Z),""!=uA(f)&&fg(y,uA(f).split(pCc));y.isEmpty()?d=!1:(c.C.ob(y.Ad().join(",")),HY(c,3),BCc(c),d=!0)}else d=!1;d||zCc(c,c.H,c.Ga,c.Ma,c.Z,c.L,c.ea,c.O,c.oa,c.J,c.V,c.Tb,c.eb,c.Sa,c.zb,c.Mb,c.$a,c.Od,c.mb,c.yb,c.rb,c.Hc)}c.yNa();a=a||"";d=a.lastIndexOf("</strong>");-1!=d&&(a=Ya(Ua(a.substring(d+9))));c.yb.Ac(!!a);a&&(CY(c)!=a&&c.xoa(),c.F.value=a,Q(c.Mb,!0));ACc(c,b);this.setVisible(!0);this.C&&this.C.hb(!0);MCc(this);c=this.F;c.F.value=CY(c);
c.C.resize()};r.Ha=function(){G(this.F);this.F=null;G(this.C);this.L=this.O=this.C=null;KCc.$.Ha.call(this)};function QCc(a,b,c,d,e){Up.call(this);this.Qc=d.O;this.rb=c;this.zb=d.C;this.eb=d;this.Cb=e;this.yb=null;this.fc=d.V;Vp(this,"Find and replace");eq(this,!1);c=this.jc();d=rl(c);this.F=d.qa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F.value=a;this.Ga=d.qa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C=new SH(null);this.od=b;this.O=new LU(this.rb,v(this.MXb,this),!1,"",!0);this.V=null;this.oa=new ur;this.mb=new ur;this.L=new ur;this.J=new ur;this.wc=this.Mb=this.Tb=
this.gc=!1;this.Eb=d.qa("SPAN");xhc(this.Eb);this.Hc=new Sq(this.F);F(this,this.Hc);a=RCc;d.qa("LABEL",{"for":a.Xxa},"Search");b=d.qa("LABEL",{"for":a.Uya},"Match case");e=d.qa("LABEL",{"for":a.Vya},"Match entire cell contents");var f=d.qa("LABEL",{},"Also search within formulas"),h=d.qa("LABEL",{"for":a.JAa},"Search using regular expressions "),k=(new jm(Kqa)).toString(),l=d.qa("SPAN",null,d.qa("A",{target:"_blank",href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});var k=Np(this,"findLabel"),m=Np(this,"replaceLabel"),p=Np(this,"findScopeLabel"),q=d.qa("DIV","goog-inline-block"),u=d.qa("DIV",a.y2a),l=d.qa("TABLE",null,d.qa("TBODY",null,d.qa("TR",null,d.qa("TD",a.LABEL,d.qa("LABEL",{id:k},"Find")),d.qa("TD",null,this.F)),d.qa("TR",null,d.qa("TD",a.LABEL,d.qa("LABEL",{id:m},"Replace with")),d.qa("TD",null,this.Ga)),d.qa("TR",null,d.qa("TD",null,d.qa("LABEL",{id:p},"Search")),d.qa("TD",null,q,u)),d.qa("TR",null,d.qa("TD",null,""),d.qa("TD",
null,b,d.qa("BR"),e,d.qa("BR"),h,l,d.qa("BR"),f)),d.qa("TR",null,d.qa("TD",{colspan:"2"},this.Eb))));this.C.render(q);Vo(this.C.getElement(),a.Xxa);this.O.render(u);Mp(this.oa,b);br(this.oa,b);this.oa.getElement().id=a.Uya;Mp(this.mb,e);br(this.mb,e);this.mb.getElement().id=a.Vya;Mp(this.L,h);br(this.L,h);this.L.getElement().id=a.JAa;br(this.J,f);Mp(this.J,f);Po(this.F,"labelledby",k);Po(this.Ga,"labelledby",m);Po(this.C.Ia,"labelledby",p);d.appendChild(c,l);c=new hq;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);kq(this,c);Rq(this,"");this.getHandler().R(this,"dialogselect",this.NXb).R(this.Hc,"input",this.UOa).R(this.L,"change",this.zBb).R(this.C,"change",this.bsb).R(this.O,"change",this.OXb).R(this.J,"change",this.ABb);c=new Tq;c.ub(this.F);F(this,c);c=new Tq;c.ub(this.Ga);F(this,c);SCc(this);c=new bp(this.getElement());F(this,c);this.getHandler().R(c,"focusin",this.AXa).R(this.getElement(),"mousedown",this.AXa)}x(QCc,Up);
var RCc={Nwa:"waffle-find-replace-dialog-border",Xxa:"waffle-find-replace-find-scope-select",LABEL:"waffle-find-replace-dialog-label",Uya:"find-replace-case",Vya:"find-replace-cell",JAa:"find-replace-regex",y2a:"waffle-find-replace-selection-input goog-inline-block"};
function SCc(a){var b=rB(a.rb),c=null,d=null;b&&(c=beb(b),d=bv(a.zb,c.bd).C);a.J.Ac(a.fc);var e=new Jq("All sheets",dLa.DYa),f=new Jq("This sheet",dLa.F2a),h=new Jq("Specific range",dLa.GJ);a.C.Ce(e);a.C.Ce(f);a.C.Ce(h);f=c?AB(a.zb,c.bd):null;f=(f=c&&f?vw(f,c.rect.yc(),c.rect.tc()):null)?f.Mh():1;c&&c.rect.Mh()>f?gt(a.C,h):gt(a.C,e);b&&a.O.ob(yv(c.rect,d))}function TCc(a){var b=a.C.Nf().pb(),c=$u(a.rb.D);return 0==b?wv(a.O.bb(),a.zb,!1,!0):1!=b||null===c?null:new dh(c,"",new Qg(0,0,1,1))}r=QCc.prototype;
r.AXa=function(a){a.target==this.getElement()?this.focus():this.Cb.Xb(2)};r.OXb=function(){UCc(this)};r.ABb=function(){var a=this.J.isChecked();dSb(this.eb,a)};r.bsb=function(){UCc(this)};r.zBb=function(){this.L.isChecked()&&this.oa.Ac(!0)};
r.NXb=function(a){var b=VCc;if("findNext"==a.key)a.preventDefault(),this.gc&&(IY(this,null),WCc(this,b.Wxa));else if("replace"==a.key)a.preventDefault(),this.Tb&&(IY(this,null),WCc(this,b.Xza));else if("replaceAll"==a.key&&(a.preventDefault(),this.wc)){a=v(function(){IY(this,null);WCc(this,b.Wza)},this);var c=this.C.Nf().pb();1<this.zb.D.length&&2==c&&!this.Mb?(Lhc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Mb=!0):a()}};
r.UOa=function(){var a=0==this.F.value.length;lq(this.D,"findNext").disabled=a;this.gc=!a;XCc(this,!a);this.Tb&&a&&YCc(this,!1)};r.MXb=function(a,b,c){this.yb=a.vs();this.od.Kea(this,a,b,c,!1,!0)};function UCc(a){var b=0==a.C.Nf().pb();a.O.setVisible(b);G(a.V);a.V=null;var c=TCc(a),d=rB(a.rb);b&&d&&c&&(a.V=iI(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.V.setVisible(!0),F(a,a.V))}
function WCc(a,b){if(0==a.C.Nf().pb()&&null==TCc(a))Zo(a.O.D,"waffle-range-selection-error",!0),IY(a,"Invalid range");else{var c=a.C.Nf().pb();a.dispatchEvent(new ZCc(b,a.F.value,a.Ga.value,c,a.oa.isChecked(),a.mb.isChecked(),a.L.isChecked(),a.J.isChecked(),TCc(a)))}}r.setVisible=function(a){var b=this.eb.Ld();XCc(this,!b);YCc(this,!b);this.Ga.disabled=b;QCc.$.setVisible.call(this,a);a&&this.yb&&(this.yb.focus(),this.yb=null)};r.ESb=function(a){this.F.value=a};r.$Ta=function(){this.F.select()};
r.focus=function(){this.Dc()&&this.tb()&&(this.F.focus(),this.Cb.Xb(2),ru(this.F,this.F.value.length),this.UOa())};function YCc(a,b,c){b=b&&!a.eb.Ld()&&0==!a.F.value.length;a.Tb=b;a=lq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}function XCc(a,b){var c=!!wb(A_a(a.Qc),function(a){return!a.Vj()});b=b&&!a.eb.Ld()&&!c&&0==!a.F.value.length;a.wc=b;a=lq(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}
function IY(a,b){var c=rl(a.jc());a=a.Eb;b?(0<Ml(a).length&&c.appendChild(a,c.qa("BR")),c.appendChild(a,c.qa("B",null,fm(c,b)))):c.Md(a)}r.Ha=function(){QCc.$.Ha.call(this);this.Mb=!1;dSb(this.eb,this.fc)};function ZCc(a,b,c,d,e,f,h,k,l){H.call(this,a);this.F=b;this.J=c;this.C=d;this.L=e;this.V=f;this.Z=h;this.ea=k;this.Sa=l||null}x(ZCc,H);var VCc={Wxa:"findnext",Kac:"findall",Xza:"replace",Wza:"replaceall",DONE:"done",H4b:"canceled"};function $Cc(a,b,c,d,e){E.call(this);var f=VCc;this.H=null;this.C=a;this.D=b;this.F=c;this.L=d;this.J=e;this.fb=new J(this);F(this,this.fb);this.fb.R(a,f.Wza,this.EAb).R(a,f.Xza,this.FAb).R(a,f.Wxa,this.zXa).R(a,f.DONE,this.fqb)}x($Cc,E);var JY={fP:"cg",gP:"cr",eP:"cc",Vxa:"loop"};r=$Cc.prototype;r.CUb=function(){this.C.setVisible(!0);aDc(this,null)};r.zXa=function(a){if(ev(this.D.D)){var b=rB(this.D).pb(),c=this.H;c||(c=Iv(b),c=sc(JY.fP,b.Bc(),JY.gP,mB(b,c.y),JY.eP,nB(b,c.x)));bDc(this,a,b,c)}};
function bDc(a,b,c,d){var e=new gh,f=cDc(b);dDc(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.ld((new Iw).Wa(),a);a=B(f,1);var d=b.type;ev(this.D.D)&&(c?wc(c,1)?(d=B(c,1),c=sc(JY.fP,parseInt(d.Fb(),10),JY.gP,d.Iz(),JY.eP,d.getColumnIndex(),JY.Vxa,B(c,2)),eDc(this,a,c)):(eDc(this,a,{}),"replace"==d&&this.C.focus()):fDc(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function dDc(a,b,c){if(c){var d=""+c[JY.fP],e=new Yd;D(e,1,d);D(e,2,jB(b,c[JY.gP],"r"));D(e,3,jB(b,c[JY.eP],"c"));D(a,10,e)}}
function cDc(a){var b=new Gw;D(b,1,a.F);D(b,3,a.J);D(b,5,a.C);if(0==a.C||1==a.C){var c=a.Sa,d=new Id;D(d,1,""+c.bd);var e=c.rect.yc();D(d,2,e);Jd(d,c.rect.Sc());Kd(d,c.rect.tc());Ld(d,c.rect.Yc());b.setSelection(d)}D(b,6,a.L||!1);D(b,7,a.V||!1);D(b,8,a.Z||!1);b.setType(a.ea?1:0);D(b,11,0);return b}function eDc(a,b,c){c?c&&null!=c.cg?(b=c[JY.fP],c[JY.Vxa]&&IY(a.C,"No more results found, looping around"),a.F.OA(b,v(a.LXb,a,c))):(aDc(a,null),IY(a.C,"There are no entries matching "+b)):fDc(a)}
r.LXb=function(a){var b=rB(this.D).pb(),c=a[JY.gP],d=a[JY.eP];a[JY.gP]=mB(b,c);a[JY.eP]=nB(b,d);aDc(this,a);a=new Bg(d,c);b=new dh(b.Bc(),"",Sg(a));JS(this.F,b,v(this.x4a,this,a))};r.x4a=function(a){if(!this.isDisposed()){this.C.focus();var b=rB(this.D).pb();Lv(b.Pf(a.y,a.x))&&!this.C.J.isChecked()&&YCc(this.C,!1,"Can't replace formula");var c=GA(b,a.y),d=HA(b,a.x);!c||!d||c.tb()&&d.tb()||(c=this.C,d=xv(a),a=uA(Jv(b,a)),IY(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};
function fDc(a){IY(a.C,null);IY(a.C,"Error while searching spreadsheet. Please try again.")}r.FAb=function(a){if(!this.J.Ld()){var b=this.H;if(b){var c=fz(this.F,b[JY.fP]);if(c){var c=c.Wc(),d=jB(c,b[JY.gP],"r"),e=jB(c,b[JY.eP],"c"),f=c.Pf(d,e);if(!Lv(f)||this.C.J.isChecked()){var f=uA(f),h=new gh,k=cDc(a);D(k,5,0);dDc(k,c,b);var l=new Id;D(l,1,""+b[JY.fP]);D(l,2,d);Jd(l,d+1);Kd(l,e);Ld(l,e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);gDc(this,c,k,f,b,!1);this.zXa(a)}}}}};
r.EAb=function(a){if(!this.J.Ld()&&ev(this.D.D)){var b=this.F.getActiveGrid().Wc(),c=cDc(a);gDc(this,b,c,a.F,a.J,!0)}};
function gDc(a,b,c,d,e,f){b=new yV(b,c);hy(b,v(function(a,b){a?(a=B(b,5),b=B(b,4),b=0==a?"No matches found":f?(new Cn(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),IY(this.C,null),IY(this.C,b)):fDc(this)},a));IY(a.C,null);IY(a.C,"Working...");a.L.C(b)||fDc(a)}r.fqb=function(){aDc(this,null)};function aDc(a,b){a.H=b;(a=a.C)&&YCc(a,null!=b)};function hDc(){var a='<div id="print-warning">'+U("Sheets with full-page charts and gadgets won't be printed. You can print all other sheets in your spreadsheet.")+'</div><hr class="print-divider"/><table width="100%" role="presentation"><tr><div class="waffle-dialog-header">'+U("Options")+'</div><td width="50%" valign="center" class="print-options-container">';var b=""+('<div role="radiogroup" aria-label="'+W(gr("Print options: What to print"))+'"><input type="radio" name="whatPartsGroup" id="print-active-sheet"/><label for="print-active-sheet">'+
U("Current sheet")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-all-sheets"/><label for="print-all-sheets">'+U("All sheets")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-selection"/><label for="print-selection">'+U("Selection")+"</label></div>");b=V(b);a=a+b+'</td><td width="50%" valign="center" class="print-options-container">';b=""+('<div role="group" aria-label="'+W(gr("Additional print options"))+'"><span id="print-repeat-row-headers" class="jfk-checkbox"></span><label for="print-repeat-row-headers">'+
U("Repeat row headers on each page")+'</label><br/><span id="print-omit-gridlines" class="jfk-checkbox"></span><label for="print-omit-gridlines">'+U("No gridlines")+'</label><br/><span id="print-include-title" class="jfk-checkbox"></span><label for="print-include-title">'+U("Include document title")+'</label><br/><span id="print-include-sheet-names" class="jfk-checkbox"></span><label for="print-include-sheet-names">'+U("Include sheet names")+'</label><br/><span id="print-include-page-numbers" class="jfk-checkbox"></span><label for="print-include-page-numbers">'+
U("Include page numbers")+"</label></div>");b=V(b);a=a+b+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header" id="dialog-paper-size-header">Paper size</div><table width="100%" role="presentation"><tr><td width="50%" valign="center" class="print-options-container">'+V('<div id="print-paper-size" class="jfk-select goog-flat-menu-button" aria-labelledby="dialog-paper-size-header"></div>')+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header">Layout</div>';
b='<table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr>'+('<td role="radiogroup" aria-label="'+W(gr("Layout"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-fit" /><br/><label for="print-fit">'+U("Fit to width")+'<br/><div class="print-fit-icon">&nbsp;</div><div class="print-layout-caption" id="print-fit-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-actual-size" /><br/><label for="print-actual-size">'+
U("Actual size")+'<br/><div class="print-actual-size-icon">&nbsp;</div><div class="print-layout-caption" id="print-actual-size-caption"></div></label></td><td class="print-layout-divider-2"></td></tr></table></td>');b+='<td role="radiogroup" aria-label="'+W(gr("Orientation"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td class="print-layout-divider-3"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-portrait" /><br/><label for="print-portrait">'+
U("Portrait")+'<br/><div class="print-portrait-icon">&nbsp;</div><div class="print-layout-caption" id="print-portrait-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-landscape" /><br/><label for="print-landscape">'+U("Landscape")+'<br/><div class="print-landscape-icon">&nbsp;</div><div class="print-layout-caption" id="print-landscape-caption"></div></label></td></tr></table></td></tr></table>';
b=V(b);return V(""+(a+b))};function iDc(a,b,c,d,e,f){Up.call(this,void 0,void 0,f);this.V=a;this.oa=b;this.yb=d;this.rb=new MQ;this.eb=e;this.mb=c;this.Ga=!1;this.C={};this.F=new zV(!0,this.ma());this.J=new zV(!0,this.ma());this.L=new zV(!0,this.ma());this.O=null;a=new hq;mq(a,{key:"ok",caption:"Print"},!0);mq(a,pq,!1,!0);kq(this,a)}x(iDc,Up);var jDc={t2a:"print-repeat-row-headers",zpc:"print-omit-gridlines",Nfc:"print-include-title",Mfc:"print-include-sheet-names",Lfc:"print-include-page-numbers"};r=iDc.prototype;
r.ZV=function(){if(!this.isDisposed()){var a=this.V,b=this.F;b.isChecked("print-active-sheet")?a.C=0:b.isChecked("print-all-sheets")?a.C=1:a.C=2;this.L.isChecked("print-fit")?a.F=0:a.F=1;b=!!this.J.isChecked("print-landscape");a.O=b;b=this.C["print-repeat-row-headers"].isChecked();a.ea=b;b=this.C["print-omit-gridlines"].isChecked();a.V=b;b=this.C["print-include-title"].isChecked();a.L=b;b=this.C["print-include-sheet-names"].isChecked();a.J=b;b=this.C["print-include-page-numbers"].isChecked()?"CENTER":
"UNDEFINED";a.Z=b;b=this.O.Nf().pb();a.D=b;kDc(this);this.oHa()}};
function lDc(a){var b=a.V,c=a.F;0==b.C?BV(c,"print-active-sheet"):1==b.C?BV(c,"print-all-sheets"):BV(c,"print-selection");BV(a.L,0==b.F?"print-fit":"print-actual-size");BV(a.J,b.O?"print-landscape":"print-portrait");a.C["print-repeat-row-headers"].Ac(!!b.ea);a.C["print-omit-gridlines"].Ac(!!b.V);a.C["print-include-title"].Ac(!!b.L);a.C["print-include-sheet-names"].Ac(!!b.J);a.C["print-include-page-numbers"].Ac("UNDEFINED"!=b.Z);var d=a.O;d.Pc().eg(function(a){a.pb()==b.D&&gt(d,a)});kDc(a);Kc&&(a.jc().style.display=
"",Bba(a.getElement().offsetHeight),a.jc().style.display="block",Bba(a.getElement().offsetHeight))}
r.orb=function(a){if("ok"==a.key){this.ZV();var b=this.V;a=this.Ga&&zgc();var c=b.ea,d=!b.O,e=0==b.F,f=0==b.C,h=2==b.C,k=b.V,l=b.L,m=b.J,p=b.Z,q=new rm;q.set("size",b.D);q.set("fzr",c);q.set("portrait",d);q.set("scale",e?"2":"1");(f||h)&&q.set("gid",$u(this.oa));h&&(b=fv(this.oa).Xc(),c=b.yc(),d=b.tc(),e=b.Sc(),f=b.Yc(),q.set("r1",c),q.set("c1",d),q.set("r2",e),q.set("c2",f),q.set("ir",b.ue()),q.set("ic",b.we));q.set("gridlines",!k);q.set("printtitle",l);q.set("sheetnames",m);q.set("pagenum",p);k=
new Ae;l=rIa(this.oa);for(m=0;m<l.length;m++)b=l[m],c=b.Wc().H,gv(c)&&(jv(c),p=new ze,d=""+b.Fb(),D(p,1,d),d=wgc(c),D(p,3,d),b=kh(hv(c),b.Fb()),D(p,4,b),yc(k,1,p));Bc(k,1).length&&(l=new gh,l.tv=!0,q.set("gridFiltersProto",Jh(l.serialize(k))));null!=a&&q.set("attachment",!a);k=q.Ne();l=[];for(m=0;m<k.length;m++)l.push(k[m]+"="+q.get(k[m]));k=l.join(",");l={format:"pdf"};m=q.Ne();for(p=0;p<m.length;p++)l[m[p]]=q.get(m[p]);q=this.yb.Xf("/export");a=v(this.rb.J,this.rb,Sj(vk(q)),l,a);this.Ga&&this.mb?
(this.eb(!1),q=this.mb,Fgc(q.D,q.H,Egc(q),k?"id="+q.C+","+k:q.C,a)):(this.eb(!0),a())}};function kDc(a){mDc(a,a.L,"print-fit");mDc(a,a.L,"print-actual-size");mDc(a,a.J,"print-landscape");mDc(a,a.J,"print-portrait")}function mDc(a,b,c){Zo(a.ma().Xs(b.getElement(c)),"print-radio-checked",b.isChecked(c))}r.oHa=pa;
r.Ya=function(){iDc.$.Ya.call(this);Rq(this,"ok");var a=this.jc();Xq(a,hDc);Vo(this.getElement(),"print-dialog");var b=this.ma();G(this.F);this.F=new zV(!0,this.ma());AV(this.F,"whatPartsGroup",a);G(this.J);this.J=new zV(!0,this.ma());AV(this.J,"print-layout-orientation",a);G(this.L);this.L=new zV(!0,this.ma());AV(this.L,"print-layout-size",a);for(var c in jDc){var d=jDc[c];G(this.C[d]);a=this.C[d]=new ur;d=b.getElement(d);a.ub(d);br(a,d.nextSibling)}G(this.O);c=this.O=BY();c.ub(b.getElement("print-paper-size"));
KY(this,"0",'Letter (8.5" x 11")',"Letter (8.5 inches x 11 inches)");KY(this,"33",'Tabloid (11" x 17")',"Tabloid (11 inches x 17 inches)");KY(this,"2",'Legal (8.5" x 14")',"Legal (8.5 inches x 14 inches)");KY(this,"32",'Statement (5.5" x 8.5")',"Statement (5.5 inches x 8.5 inches)");KY(this,"30",'Executive (7.25" x 10.5")',"Executive (7.25 inches x 10.5 inches)");KY(this,"31",'Folio (8.5" x 13")',"Folio (8.5 inches x 13 inches)");KY(this,"6","A3 (297 mm x 420 mm)");KY(this,"7","A4 (210 mm x 297 mm)");
KY(this,"8","A5 (148 mm x 210 mm)");KY(this,"18","B4 (250 mm x 353 mm)");KY(this,"19","B5 (176 mm x 250 mm)");this.getHandler().R(c,"action",this.ZV).R(this.F,"action",this.JFb).R(this.J,"action",this.nyb).R(this.L,"action",this.ZV).R(this,"afterhide",this.ZV).R(this,"dialogselect",this.orb)};function KY(a,b,c,d){a.O&&(b=new Jq(c,b),a.O.Ce(b),a=b.jc(),d&&a&&So(a,d))}r.nyb=function(){this.ZV()};
r.JFb=function(){var a=this.C["print-repeat-row-headers"],b=this.V;this.F.isChecked("print-selection")&&a.isChecked()?(a.Ac(!1),b.H=!0):this.V.H&&(a.Ac(!0),b.H=!1);this.ZV()};r.show=function(a){this.Ga=a;Vp(this,a?"Print settings":"Export to PDF");this.D.set("ok",a?"Print":"Export",!0);this.setVisible(!0);a=this.ma();var b=this.oa;Q(a.getElement("print-warning"),!1);lWa(b)?(gAc(this.F),this.F.hb("print-selection",!1),2==this.V.C&&(this.V.C=0)):gAc(this.F);lDc(this);this.oHa()};
r.Ha=function(){for(var a in this.C)G(this.C[a]);G(this.O);G(this.L);G(this.J);G(this.F);iDc.$.Ha.call(this)};function nDc(a){a=""+(oDc({id:"waffle-resize-selection-custom",yPa:a.sEa,il:hr("<br />"+U(yAc({id:"waffle-resize-input",Je:"waffle-resize-inset-input"})))})+oDc({id:"waffle-resize-selection-auto",yPa:gr("Fit to data"),il:hr("")}));return V(a)}function oDc(a){return V('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+W(a.id)+'"><label for="'+W(a.id)+'" class="waffle-resize-label">'+U(a.yPa)+"</label>"+U(a.il)+"</div>")}
function pDc(a){return V('<label for="waffle-resize-input" >'+U(a.sEa)+'</label><br /><br /><input id="waffle-resize-input" />')};function qDc(a,b,c,d,e){Up.call(this);this.Ke=a;this.O=b;var f=this.Ke.Xc().Kd();this.C=f;this.F=rb(this.Ke.gk(),function(a){return a.Kd()==f});this.J=new MO;this.L=new zV(!0);this.V=c;this.oa=d;this.Lb=e}x(qDc,Up);var rDc={O4:"waffle-resize-selection-auto",CUSTOM:"waffle-resize-selection-custom",C0a:"waffle-resize-input",E1a:"waffle-resize-selection"};r=qDc.prototype;
r.qa=function(){qDc.$.qa.call(this);var a=this.F[0];if("r"==this.C){var b=a.yc();var a=a.Sc()-1,c=String(ov(b+1)),d=String(ov(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.tc(),a=a.Yc()-1,c=qv(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+qv(a)));Vp(this,b);b="r"==this.C?pDc:nDc;this.jc().appendChild(T(b,{sEa:"r"==this.C?"Enter new row height in pixels. (Default: "+(Tu+")"):"Enter new column width in pixels. (Default: "+
(hVa+")")}));Rq(this,"ok")};r.Ya=function(){qDc.$.Ya.call(this);var a=this.ma();this.J.ub(a.getElement(rDc.C0a));var a=this.Ke.Xc(),b=a.Kd(),a=gVa(VA(this.Ke,b,a.Zf(b)));this.J.ob(String(a));"c"==this.C&&(AV(this.L,rDc.E1a),BV(this.L,rDc.CUSTOM));this.getHandler().R(this,"dialogselect",this.dZb).R(this.J.getElement(),"focus",this.eFb)};r.eFb=function(){"c"==this.C&&BV(this.L,rDc.CUSTOM)};r.focus=function(){this.Dc()&&this.J.Vl()};
r.dZb=function(a){if("ok"==a.key)if("r"==this.C||nmc(this.L)==rDc.CUSTOM)a=parseInt(this.J.bb(),10),isNaN(a)?sn("Entered value is not a number."):2>a||2E3<a?sn("Size must be between 2 and 2000 pixels."):(this.Lb.C("r"==this.C?35310:35308),this.O.C(new XJ(this.Ke,this.F[0],a,this.F.slice(1))));else{var b=rB(this.V).ea;a=b.C;b=rg(L(),"fecllr")?b.H:null;this.Lb.C(35307);Bqb(this.F,a,b,this.oa,this.O)}};function sDc(a){Nh(this,a,0,-1,null)}x(sDc,Mh);sDc.prototype.getType=function(){return M(this,3)};sDc.prototype.setType=function(a){O(this,3,a)};function tDc(a){S.call(this,a);this.Z=Vm("email");this.C=this.D=null}x(tDc,S);r=tDc.prototype;
r.qa=function(){var a=this.ma(),b=this.ma();this.C=new pU;F(this,this.C);this.D=new pU;F(this,this.D);var c=b.qa("DIV","waffle-dialog-notifications-input");No(c,"presentation");this.F=new nU;oU(this.F,b.qa("LABEL",null,"Any changes are made"));this.F.render(c);this.C.sH(this.F);var d=b.qa("DIV","waffle-dialog-notifications-input");No(d,"presentation");this.J=new nU;oU(this.J,b.qa("LABEL",null,"A user submits a form"));this.J.render(d);this.C.sH(this.J);var e=b.qa("DIV","waffle-dialog-notifications-input");
No(e,"presentation");this.H=new nU;oU(this.H,b.qa("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.sH(this.H);var f=b.qa("DIV","waffle-dialog-notifications-input");No(f,"presentation");this.L=new nU;oU(this.L,b.qa("LABEL",null,"Email - right away"));this.L.render(f);this.D.sH(this.L);b=b.qa("DIV",null,b.qa("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.Z+" when...")),b.qa("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.Z+" when...")},c,d),b.qa("DIV",{style:"padding: 5px"}),
b.qa("DIV","waffle-dialog-notifications-label","Notify me with..."),b.qa("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.ma();d=c.qa("DIV");this.O=qO("Save",c);this.Za(this.O,!1);this.O.render(d);this.V=new ss("Cancel",c);this.Za(this.V,!1);this.V.render(d);this.Ia=a.qa("DIV","waffle-dialog-notifications",a.qa("DIV",null,b),a.qa("DIV",null,d))};
r.Ya=function(){tDc.$.Ya.call(this);this.getHandler().R(this.O,"action",this.LRb,!0).R(this.V,"action",v(this.dispatchEvent,this,new H("cancelRuleEdit"))).R(this.C,"change",this.Lva).R(this.D,"change",this.Lva)};r.Re=function(a){tDc.$.Re.call(this,a);a?1==a.getType()?qU(this.C,this.F):2==a.getType()&&qU(this.C,this.J):qU(this.C,null);a?2==M(a,2)?qU(this.D,this.H):1==M(a,2)&&qU(this.D,this.L):qU(this.D,null);this.Lva()};r.focus=function(){var a=rU(this.C),b=this.C.D.Gf(0);(a||b).getElement().focus()};
r.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};r.LRb=function(){this.dispatchEvent(new H("saveRule",uDc(this)))};function uDc(a){var b=new sDc,c=a.pb();c&&(c=M(c,1),O(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?O(b,2,1):a.H.isChecked()&&O(b,2,2);return b}r.Lva=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.hb(a)};function LY(a,b){S.call(this,b);this.Re(a)}x(LY,S);
LY.prototype.qa=function(){var a=this.pb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==M(a,2)?c+="send digest email":1==M(a,2)&&(c+="send email");var c="If "+(b+(" then "+c)),d=this.ma(),a=d.qa("TD",null),b=d.qa("TD",{width:"50px"}),c=d.qa("TR",{valign:"center"},d.qa("TD",null,d.qa("SPAN","waffle-notification-rule",c)),d.qa("TD",{align:"right"},d.qa("TABLE",null,d.qa("TBODY",null,d.qa("TR",null,a,b))))),d=uq(is,"waffle-notifications-add");this.D=new ks("Edit",
d,this.ma());this.D.Bg("goog-link-button");this.D.Bg("menuMainLink");this.Za(this.D,!1);this.D.render(a);this.C=new ks("Delete",d,this.ma());this.C.Bg("goog-link-button");this.C.Bg("menuMainLink");this.Za(this.C,!1);this.C.render(b);this.Ia=c};LY.prototype.Ya=function(){LY.$.Ya.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};LY.prototype.H=function(){this.dispatchEvent(new H("edit",this.pb()))};
LY.prototype.F=function(){var a=v(function(){this.dispatchEvent(new H("del",this.pb()))},this),b=v(function(){this.C.getElement().focus()},this);lCc("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function vDc(a){S.call(this,a);this.C=null}x(vDc,S);vDc.prototype.qa=function(){var a=this.ma();this.C=a.qa("TBODY");this.Ia=a.qa("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};vDc.prototype.jc=g("C");vDc.prototype.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};function wDc(a,b,c){Up.call(this);this.oa=a;this.L=b;Vp(this,"Set notification rules");eq(this,!1);a=new hq;a.set("cancel","Done",!1,!0);kq(this,a);this.C=new tDc(c);this.Za(this.C,!1);this.F=new vDc;this.Za(this.F,!1);this.J=new ks("Add another notification rule",rJ.getInstance(),this.ma());this.Za(this.J,!1)}x(wDc,Up);r=wDc.prototype;
r.qa=function(){wDc.$.qa.call(this);var a=this.ma(),b=k0a(this.oa,new jm(Fqa+"91588")).toString(),b=a.qa("A",{target:"_blank",href:b},"Help"),c=a.qa("DIV");this.J.render(c);this.V=a.qa("DIV");this.O=a.qa("DIV");var d=a.qa("DIV","waffle-dialog-notifications-bounds",this.V,this.O),b=a.qa("DIV",null,a.qa("DIV",{align:"right"},b),d,c);a.appendChild(this.jc(),b);Rq(this,"")};
r.Ya=function(){wDc.$.Ya.call(this);this.F.render(this.V);this.C.render(this.O);this.getHandler().R(this,"edit",this.mZb).R(this,"del",this.lZb).R(this.J,"action",this.kZb).R(this,"saveRule",this.KRb).R(this,"cancelRuleEdit",this.f6a)};r.i2=function(a){this.isDisposed()||(this.C.setVisible(!1),xDc(this,!1),Fj(this.L,"/notifications/list",v(this.MVb,this,a)).jf())};
r.MVb=function(a,b,c){if(!this.isDisposed()){b=c.yg();c=[];for(var d=0;d<b.length;d++)c[d]=new sDc(b[d]);this.Re(c);if(a&&0==c.length)yDc(this,null,!1);else{if(a=this.pb())if(b=this.F,b.Md(!0),b.ma().Md(b.jc()),b.Re(a),c=b.ma(),0==a.length)c.appendChild(b.jc(),c.qa("TR",null,c.qa("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Za(new LY(a[d],c),!0);xDc(this,!0);this.focus()}}};
r.KRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();M(a,1)?Ij(Fj(this.L,"/notifications/set",v(this.i2,this,!1)),{rule:b}).jf():Ij(Fj(this.L,"/notifications/create",v(this.i2,this,!1)),{rule:b}).jf()};r.f6a=function(){this.C.setVisible(!1);this.i2(!1)};r.mZb=function(a){yDc(this,a?a.target:null,!0)};r.kZb=function(){yDc(this,null,!0)};function yDc(a,b,c){xDc(a,!1);var d=a.C;d.Re(b);d.setVisible(!0);c&&a.C.focus()}
r.lZb=function(a){this.F.setVisible(!1);a=a.target;Ij(Fj(this.L,"/notifications/delete",v(this.i2,this,!1)),{rule_id:M(a,1)}).jf()};function xDc(a,b){a.F.setVisible(b);var c=cq(a);Q(c,b);a.J.setVisible(b)}r.show=function(){this.setVisible(!0);this.i2(!0)};function zDc(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(U(a.t8a)+"</a>"),b=b+('<tr class="dialog-settings-general-settings-div"><div><span>'+c+"</span></div>");a.ETb&&(b+='<div class="dialog-settings-english-name-div">'+U(tr({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');return V(b+"</tr>")}
function ADc(){return V('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function MY(a,b,c,d){Up.call(this);this.gc=a;this.od=b;this.L=c;this.Lb=d;this.C={};this.Tb=this.zb=!1;this.Hc=this.fc=this.Mb="";this.Qc=new gh;this.J=[];this.F=this.Qc.ld((new Af).Wa(),ritz_api.RitzModelApi.getWorkbookProperties());Vp(this,"Settings for this spreadsheet");this.yb=!1;this.mb=new ur;this.Za(this.mb);this.V=new aT;this.Za(this.V);this.O=new aT;this.Za(this.O);this.Eb=new HT;this.Za(this.Eb);this.eb=this.rb=null;this.wc=new An(1);this.oa=this.Ga="";this.C[0]=BY();this.C[1]=BY();this.C[2]=
BY();this.C[3]=BY();this.C[4]=new MO;this.C[5]=new MO}x(MY,Up);var BDc=null,NY={S5:0,n3a:1,NYa:2,M0a:3,c1a:4,IZa:5},CDc={K3a:"waffle-settings-dialog-english-name-checkbox",L3a:"waffle-settings-dialog-english-name-checkbox-label"},DDc=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],EDc=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];r=MY.prototype;
r.qa=function(){MY.$.qa.call(this);var a=this.jc(),b=this.ma(),c=[OY(b,"Locale","waffle-settings-label-locale"),PY(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),FDc(this),OY(b,"Time zone","waffle-settings-label-timezone"),PY(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
FDc(this)],d=[];d.push(OY(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(PY(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(FDc(this));d.push(OY(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=k0a(this.L,new jm(Fqa+"58515")).toString(),e=b.qa("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(PY(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=OY(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=PY(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");GDc(e);d.push(e);this.J.push(e);e=OY(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=PY(this,b,
"The threshold value such that calculation rounds stop when succesive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");GDc(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Nf().bb()&&HDc(this);d.push(FDc(this));c=Jb(c,d);c.push(T(zDc,{t8a:this.fc,ETb:this.yb}));this.rb=b.qa("TABLE","dialog-settings",b.qa("TBODY",null,c));this.eb=b.qa("table","dialog-settings",b.qa("tbody",null,d));c=T(ADc);b.appendChild(a,c);this.Eb.ub(c);b.appendChild(a,
this.rb);b.appendChild(a,this.eb);Q(this.eb,!1);BDc||(a=new hq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),BDc=a);kq(this,BDc);QY(this,4,wc(this.F,3)&&B(this.F,3).Naa()?B(this.F,3).P9().toString():"50");QY(this,5,wc(this.F,3)&&B(this.F,3).Kaa()?B(this.F,3).z9().toString():"0.05");Rq(this,"save")};function GDc(a){a=a.firstChild.firstChild;Vo(a,"jfk-textinput");cp(a,"width","7em")}function HDc(a){for(var b=0;b<a.J.length;b++)Q(a.J[b],!1)}
function OY(a,b,c){return a.qa("TR",null,a.qa("TD",{id:c,"class":"dialog-settings-label"},b))}function PY(a,b,c,d,e,f,h){b=b.qa("TR",null,b.qa("TD","dialog-settings-input"),b.qa("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Ia;Po(a,"labelledby",e);Po(a,"describedby",f);return b}function FDc(a){a=a.ma();return a.qa("TR",null,a.qa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.qa("HR",{"class":"dialog-settings-sep"})))}
r.Ya=function(){MY.$.Ya.call(this);$c(this,"dialogselect",v(this.BZb,this));this.getHandler().R(this.C[3],"action",this.STb);this.getHandler().R(this.Eb,"select",this.LDb);var a=this.C[4].getElement();this.V.Jj(a);dT(this.V,a,a);this.V.render();cT(this.V);this.getHandler().R(a,"change",v(this.iWb,this));a=this.C[5].getElement();this.O.Jj(a);dT(this.O,a);this.O.render();cT(this.O);this.getHandler().R(a,"change",v(this.hWb,this));if(this.yb){var a=this.ma().getElement(CDc.K3a),b=this.ma().getElement(CDc.L3a);
this.mb.ub(a);br(this.mb,b);this.mb.Ac(!ora||g0a(this.L.F))}};r.setVisible=function(a){if(a){if(!this.zb){IDc(this);return}var b=this.L.L;QY(this,0,b.C);b=b.D||Ctb().name();QY(this,1,b);QY(this,2,wc(this.F,3)&&B(this.F,3).Woa()?B(this.F,3).Hla().toString():"");QY(this,3,wc(this.F,3)&&wc(B(this.F,3),1)?B(B(this.F,3),1)?"ON":"OFF":"OFF")}MY.$.setVisible.call(this,a);if(this.zb&&!this.Tb){if(a=ul("ds-settings-link"))a.href=this.Mb;this.Tb=!0}};
function IDc(a){Hj(a.od.Xf("/info/settings").dg(JDc()),v(function(a){a=a.yg();(a={locale:a.l?this.qL(a.l):null,pWa:a.tz?this.qL(a.tz):null,B8a:a.dls,IIb:a.dln,fWb:a.hl},a.locale)&&a.pWa&&(KDc(this,0,a.locale),KDc(this,1,a.pWa),KDc(this,2,DDc),KDc(this,3,EDc),this.Mb=a.B8a,this.fc=a.IIb,this.Hc=a.fWb,this.yb=ora&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Hc),this.zb=!0);this.setVisible(!0)},a)).jf()}
function JDc(){var a=vm(Vm("win").location.href),b=tm(a,"hl"),a=tm(a,"forcehl");return["hl",b,"forcehl",a]}function KDc(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d],e=new Jq(e.caption,e.value);a.Ce(e);No(e.getElement(),"menuitem")}a.Pc().getElement().style.overflow="auto";mO(a,!0)}r.qL=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function QY(a,b,c){(a=a.C[b])&&a.ob(c)}
r.BZb=function(a){if("save"==a.key)if("ON"!=this.C[3].Nf().bb()||""==this.Ga&&""==this.oa){LDc(this);a=this.L.L.C;this.gc.C(MDc(this));this.gc.C(NDc(this));if(this.yb){var b=!ora||g0a(this.L.F);var c=this.mb.isChecked();b!=c?(o0a(this.L,c),b=gi(new fi,1).build(),this.Lb.rc(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].Nf(),c=null!=c&&c.bb()!=a);c&&pDa(this.L.D.C,this.AZb)}else a.preventDefault(),LDc(this),""!=this.Ga&&bT(this.V,this.Ga,!0),""!=this.oa&&bT(this.O,this.oa,!0)};
r.STb=function(a){if("ON"==a.target.bb())for(a=0;a<this.J.length;a++)Q(this.J[a],!0);else HDc(this);LDc(this)};function LDc(a){cT(a.V);cT(a.O)}r.iWb=function(){this.Ga="";var a=this.C[4].bb()||"",a=this.wc.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ga="Please enter an integer value.";else if(0>=a||1E4<a)this.Ga="Please enter a value between 1 and 10000."};r.hWb=function(){this.oa="";var a=this.C[5].bb()||"",a=this.wc.parse(a);isNaN(a)?this.oa="Please enter a numeric value.":0>a&&(this.oa="Please enter a non-negative value.")};
r.LDb=function(a){switch(a.target.getId()){case "general-settings-tab":Q(this.rb,!0);Q(this.eb,!1);break;case "calculation-settings-tab":Q(this.rb,!1),Q(this.eb,!0)}};function MDc(a){var b=a.C,c=b[NY.NYa].Nf().bb(),d=b[NY.M0a].Nf().bb();a=b[NY.c1a].bb()||"";var b=b[NY.IZa].bb()||"",e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new zK(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function NDc(a){var b=a.C;a=a.L.L;var c=b[NY.S5].Nf(),c=null==c?a.C:c.bb(),b=b[NY.n3a].Nf(),b=null==b?a.D||Ctb().name():b.bb();return new Xsb(c,b)}r.AZb=function(){(new jub).exec()};r.Ha=function(){Yb(this.C,G);delete this.C;MY.$.Ha.call(this)};function ODc(a,b,c,d,e,f,h){Up.call(this,void 0,!1,h);this.J=this.F=this.O=this.L=null;this.oa=a;this.Ke=b;this.C=[];this.V=new P4b(a,d,e,f)}fa(ODc,Up);r=ODc.prototype;
r.qa=function(){Up.prototype.qa.call(this);var a=this.ma(),b=this.Ke.Xc(),c=xv(b.$e()),d=xv(new Bg(b.left+b.width-1,b.top+b.height-1));Vp(this,"Sort range from "+(c+(" to "+d)));PDc||(c=new hq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),PDc=c);kq(this,PDc);Rq(this,"save");var e,c=a.qa("DIV",{style:"overflow: hidden"},d=a.qa("SPAN","jfk-checkbox"),e=a.qa("SPAN",{style:"cursor: default"},"Data has header row")),f=this.J=new ur(void 0,a);f.ub(d);br(f,e);1==b.height&&f.hb(!1);lv(this.oa,this.Ke.Bc(),
b)||(f.Ac(!0),f.hb(!1));Wra&&ritz_api.TablesApi.getTables((new gh).serialize(kh(b,this.Ke.Bc())),v(function(a){if(0<a.length){var c=a[0];a=yVb(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=ih(a),c=1==c.Wg()-c.Zf();c&&(c=kh(b,this.Ke.Bc()),c=a.Fb()==c.Fb()&&pAc(ih(a),ih(c))&&pAc(jh(a),jh(c)));c&&f.Ac(!0)}},this));d=this.jc();a.appendChild(d,c);this.L=a.qa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.qa("TABLE",{cellSpacing:"0"},this.O=
a.qa("TBODY")));a.appendChild(d,this.L);c=QDc(this);this.C.push(c);c=a.qa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);Wl(c,!0);No(c,"button");this.F=c};r.Ya=function(){Up.prototype.Ya.call(this);Ff(this.getHandler().R(this,"dialogselect",this.sJb),this.F,dd,this.Fkb).R(this.J,"change",this.atb)};
function QDc(a){var b=a.ma(),c=0==a.C.length,d=new RDc(a,c,a.Ke,0,b),e=b.qa("TR",null,b.qa("TD",{colspan:"4"},b.qa("DIV","waffle-sd-row-separator")));d.render(a.O);b.appendChild(a.O,e);c||Ff(a.getHandler(),d.D,dd,v(a.U7a,a,d));a=SDc(a);TDc(d,a);return d}r.U7a=function(a){var b=this.C;if(1<b.length){var c=ob(b,a);-1!=c&&(Ib(b,c),b=a.getElement(),b=Ol(b),a.dispose(),Kl(b),Q(this.F,!0),this.F.focus(),tn("Sort criteria removed."))}};
function SDc(a){var b=a.Ke.Xc(),c=b.tc(),b=b.Yc(),d=sb(a.C,function(a){return a.Pq()},a);if(d)for(var e=lB(a.Ke,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=nB(a.Ke,f);if(!yb(d,h))return h}return null}r.atb=function(){for(var a=this.C,b=0;b<a.length;b++)TDc(a[b])};r.Fkb=function(){var a=ah(this.Ke.Xc(),"c"),a=Math.max(10,a);this.C.length<a&&(this.C.push(QDc(this)),tn("Sort criteria added."));op(nb(this.C).getElement(),this.L,!0);this.L.scrollLeft=0;this.C.length>=a&&Q(this.F,!1)};
r.sJb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.C,d=0;d<c.length;d++){var e=c[d];a.push(e.Pq());e=e.F.isChecked();b.push(e?1:0)}c=this.Ke.Xc();d=ah(c,"r");if(this.J.isChecked()&&1<d){var d=c.yc()+1,e=c.tc(),f=c.Sc(),h=c.Yc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new f5b(a,b,this.Ke,c,this.J.isChecked());Q4b(this.V,this.Ke,a)}};r.Ha=function(){Up.prototype.Ha.call(this);Fc(this.C)};var PDc=null;
function RDc(a,b,c,d,e){S.call(this,e);this.H=this.J=this.F=this.C=this.D=null;this.O=-1;this.V=a;this.L=b;this.Ke=c}fa(RDc,S);RDc.prototype.Pq=function(){var a=this.C.Nf();return a?a.bb():-1};
RDc.prototype.qa=function(){var a=this.ma(),b=this.L?"sort by":"then by",c,d,e,f=a.qa("TR","waffle-sd-tr-rules",a.qa("TD","waffle-sd-delete",this.L?"":this.D=a.qa("SPAN",{title:"Remove sort criteria."},"x")),a.qa("TD","waffle-sd-td-rules",a.qa("LABEL",{id:Np(this,"csl")},b)),b=a.qa("TD","waffle-sd-column-selector"),a.qa("TD","waffle-sd-td-ascending",e=a.qa("DIV",null,c=a.qa("DIV",{title:"Ascending"}),d=a.qa("DIV",{title:"Descending"}))));No(e,"radiogroup");e=this.F=new nU(a,gm(a,an(Ju(!0,this.Wf()))),
"ascending");e.render(c);a=this.J=new nU(a,gm(a,an(Ju(!1,this.Wf()))),"descending");a.render(d);this.H=new pU([e,a]);qU(this.H,e);a=this.C=BY();a.render(b);Po(a.getElement(),"label",this.L?"Select first column to sort by:":"Select next column to sort by:");this.D&&(Wl(this.D,!0),No(this.D,"button"),So(this.D,"Remove sort criteria."));this.Ia=f};
function TDc(a,b){var c=a.ma(),d=a.V.J.isChecked(),e=a.Ke.Xc(),f=e.yc(),h=e.tc(),e=e.Yc();a.O=b||a.Pq();for(b=a.C.Nk();0<b;b--)a.C.uC(0);for(;h<e;h++)b=$a(uA(a.Ke.Pf(f,h)),25),b=new Jq(Ra(b)||!d?"Column "+qv(h):b,nB(a.Ke,h),c),b.Bg("waffle-sd-menu-item"),a.C.Ce(b);a.C.ag(0);0<=a.O&&a.C.ob(a.O)}RDc.prototype.Ha=function(){S.prototype.Ha.call(this);this.C=this.D=this.Ke=this.V=null;G(this.F);G(this.J);G(this.H);this.H=this.J=this.F=null};Nc&&Tc("2");Kc&&Tc("9.0")&&Tc("10.0");function UDc(a){return V('<input type="text" id="docs-copy-link" class="docs-copy-link" value="'+W(a.link)+'" readonly="readonly">')};function RY(a,b,c,d){vr.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ga="";this.F=b||null;this.oa=c||new gob(a);this.V=null!=d?d:null;a=new hq;mq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.oa.C()&&mq(a,{key:"copy-link",caption:"Copy Link"});kq(this,a)}x(RY,vr);r=RY.prototype;
r.qa=function(){RY.$.qa.call(this);Vo(dq(this),"copy-link-dialog");Vo(lq(this.D,"done"),"copy-link-done-button");this.C=T(UDc,{link:this.Ga},void 0,this.ma());Po(this.C,"label","Link to this comment");this.jc().appendChild(this.C);if(this.L=lq(this.D,"copy-link")){var a=Cl("DIV");Vo(a,"copy-link-butter-holder");this.getElement().insertBefore(a,bq(this));this.O=new Br(a);this.J=Dr("Link copied to clipboard.","info",!1,4E3)}null!==this.V&&(cp(this.Lx(),"z-index",this.V),cp(dq(this),"z-index",this.V+
1))};r.Eo=function(){RY.$.Eo.call(this);this.F&&this.getHandler().R(this.F,"copy",this.OFa);this.C.focus();this.C.select()};r.gr=function(){RY.$.gr.call(this);this.F&&this.getHandler().Rc(this.F,"copy",this.OFa)};r.Ya=function(){RY.$.Ya.call(this);this.getHandler().R(this.C,"click",this.dSb);this.L&&this.getHandler().R(this.L,"click",this.wob)};r.MSb=function(a){this.Ga=a;this.C&&(this.C.value=a)};r.dSb=function(a){a.target.focus();a.target.select()};
r.wob=function(a){a.stopPropagation();this.F&&this.oa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};r.OFa=function(a){a.C&&this.J&&this.O&&(this.J.tb()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};r.Ha=function(){RY.$.Ha.call(this);G(this.J);delete this.J;delete this.L;delete this.C};function VDc(){E.call(this)}x(VDc,bn);r=VDc.prototype;r.Sfb=function(){return jCc};r.hgb=function(){return lCc};r.eKb=function(a,b,c,d){var e=new Tq;a=new Qq(a,b,c,d,void 0,!0,void 0);Rq(a,"ok");b=v(e.ub,e);a.Gpa=b;F(a,e);a.Gj=!0;a.I$=Ifa(Ra);return a};r.Rhb=function(){return qDc};r.F7a=function(a,b,c,d,e){return new ODc(a,b,0,c,d,e,void 0)};r.qgb=function(){return KCc};r.zIa=function(){return QCc};r.Igb=function(){return $Cc};r.C7a=function(a,b,c,d){return new iDc(a,b,c,d,pa,void 0)};r.Whb=function(){return MY};
r.Vhb=function(){return hCc};r.Uhb=function(){return wDc};r.lgb=function(){return pY};r.Shb=function(){return JAc};r.Thb=function(){return hBc};r.kgb=function(){return RY};on("dialogs",VDc);
