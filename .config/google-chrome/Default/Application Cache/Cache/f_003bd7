Xh.prototype.FS=ea(46,function(){return M(this,56)});function wnd(a,b){var c=new BF,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}function xnd(a){a=a||{};return V(XEa(fr({l_:gr("docs-icon-close-small")},a)))}
function ynd(a){return V("<div "+(a.id?'id="'+W(a.id)+'"':"")+' class="'+(a.Pg?W(a.Pg)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Zt?'aria-label="'+W(a.Zt)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+U(a.IB)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.xl?U(a.xl):"")+"</div>")}function znd(a){Nh(this,a,0,-1,null)}x(znd,Mh);
znd.prototype.getContext=function(){return M(this,1)};znd.prototype.setContext=function(a){O(this,1,a)};znd.prototype.hx=function(){O(this,1,void 0)};function And(a,b){Dn.call(this);this.H=a;this.D[a]=b}x(And,Dn);And.prototype.C=function(a){var b={};b[this.H]=a;Hn(this,b)};function I5(){pD.call(this);this.C=new BF;qD(this,new nD(oD,{},{wordList:[]}));this.J=new gg;F(this,this.J)}x(I5,pD);qa(I5);I5.prototype.F=function(a){Bnd(this,a,!0)};function Bnd(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;rD(a).get("wordList").push(f);c&&Cnd(a,[b],[])}return!d}I5.prototype.L=function(a){Dnd(this,a,!0)};
function Dnd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=rD(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&Cnd(a,[],[b])}return d}I5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)Bnd(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function Cnd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new tD(new sD("docs-user_dictionary",d),rD(a)))};function J5(a,b,c){vr.call(this,a,b,c);Vp(this,"Preferences")}x(J5,vr);r=J5.prototype;r.Ya=function(){J5.$.Ya.call(this);this.getHandler().R(this,"dialogselect",this.Z8a)};r.setVisible=function(a){J5.$.setVisible.call(this,a);a&&this.update()};r.update=pa;r.Z8a=function(a){"ok"==a.key&&this.VTa()};r.VTa=pa;function End(a){a='<b>"'+(U(a.mW)+'"</b> added to your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function Fnd(a){a='<b>"'+(U(a.mW)+'"</b> removed from your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function Gnd(a){a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+W(a.ROa)+'" placeholder="'+W(a.ROa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+U(rs({Je:"docs-userdictionarydialog-button-add",style:0,content:hr("Add")}))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');return V(a)}
function Hnd(a){return V('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+W(a.mW)+'" class="docs-userdictionarydialog-row-content">'+U(a.mW)+"</div></div>")};function K5(a,b){yq.call(this,void 0,new Ind);this.lwa=a;this.C=b}x(K5,yq);K5.prototype.Wp=ba();K5.prototype.qT=function(a){a.relatedTarget&&Rl(this.C,a.relatedTarget)||K5.$.qT.call(this,a)};K5.prototype.Zj=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Gi(a)};function Ind(){}x(Ind,tq);Ind.prototype.Kc=n("docs-userdictionarydialog-row-container");Ind.prototype.qa=function(a){return T(Hnd,{mW:a.lwa})};function L5(a){ys.call(this,void 0,new Jnd);this.D=a;this.C=this.F=null}x(L5,ys);r=L5.prototype;r.Ya=function(){L5.$.Ya.call(this);So(this.Ia,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");No(this.Ia,"listbox");var a=this.F;Q(a,!1);zp(a,!0);this.C=new qq(a);this.getHandler().R(this,"action",this.asa).R(this.F,"click",this.asa).R(this.C,"key",this.jmb)};r.xd=function(){L5.$.xd.call(this);G(this.C);this.C=null};
function Knd(a){var b=[];a.eg(function(a){b.push(a.lwa)});return b}r.asa=function(){var a=Bs(this),b=this.jk==this.vd()-1;Ds(this);this.removeChild(a,!0);b||Es(this);Lnd(this);this.dispatchEvent("change")};r.jmb=function(a){return 13==a.keyCode||32==a.keyCode?(this.asa(),a.preventDefault(),a.stopPropagation(),!0):!1};r.qC=function(){0==this.Wi("docs-userdictionarydialog-row-container-hover").length&&Cs(this)};r.dw=function(a){a.stopPropagation();a.preventDefault()};
r.hk=function(a){return 27==a.keyCode?!1:L5.$.hk.call(this,a)};r.A0=function(a){L5.$.A0.call(this,a);Lnd(this)};r.Xma=function(a){var b=am(document);L5.$.Xma.call(this,a);b&&Uo(b,"docs-userdictionarydialog-list-remove-button")?this.Ia.focus():Lnd(this)};function Lnd(a){if(Bs(a)){var b=Bs(a),c=Math.round((up(b.Ia).height-up(a.F).height)/2);a.F.style.top=jp(b.Ia).y+c+"px";So(a.F,"Remove "+b.lwa);Q(a.F,!0)}else Q(a.F,!1)}function Jnd(){this.C=void 0}x(Jnd,xs);
Jnd.prototype.Vr=function(a){var b=T(xnd,{enabled:!0,Pg:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function M5(a,b,c,d){J5.call(this,b,c,d);this.V=a;this.F=new ss(null,d);this.Za(this.F);this.L=this.C=null;this.J=new L5(a);this.Za(this.J);this.O=null;Vp(this,"Personal dictionary");a=mq((new hq).set("ok","Save",!0),pq,!1,!0);kq(this,a)}x(M5,J5);r=M5.prototype;r.qa=function(){M5.$.qa.call(this);Xq(this.jc(),Gnd,{ROa:"Add a new word"});Rq(this,"ok");this.F.ub(this.gb("docs-userdictionarydialog-button-add"));this.J.ub(this.gb("docs-userdictionarydialog-list-container"));this.C=this.gb("docs-userdictionarydialog-input")};
r.Ya=function(){M5.$.Ya.call(this);this.F.hb(!1);this.L=new Sq(this.C);this.getHandler().R(this.F,"action",this.ykb).R(this.C,"keypress",this.C$a).R(this.L,"input",this.B$a).R(this.J,"change",this.zpb);this.getHandler().R(this.F.getElement(),"focus",this.Aka).R(this.C,"focus",this.Aka);for(var a=Uya(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.Aka);this.O=new WI(this.J)};r.xd=function(){M5.$.xd.call(this);Fc(this.L,this.O);this.O=this.L=null};r.ykb=function(){Mnd(this)};
r.B$a=function(){this.F.hb(!Ra(fb(this.C.value)))};r.C$a=function(a){13==a.keyCode&&(this.F.isEnabled()&&Mnd(this),a.stopPropagation(),a.preventDefault())};r.Aka=function(){this.J.Ak(-1)};r.zpb=function(){lq(this.D,"ok").disabled=!1};r.update=function(){var a=this.J;a.Md(!0);var b=a.D.C.Ad();b.sort(imc());for(var c=0;c<b.length;c++)a.Za(new K5(b[c],a.F),!0);Nnd(this,"");lq(this.D,"ok").disabled=!0};
r.VTa=function(){var a=this.J;var b=new BF(a.D.C.Ad());var c=new BF(Knd(a));a=wnd(c,b).Ad();b=wnd(b,c).Ad();for(var c=this.V,d=[],e=[],f=0;f<a.length;f++)Bnd(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)Dnd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&Cnd(c,d,e)};
r.setVisible=function(a){M5.$.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,mGa(b)?(b.selectionStart=a,b.selectionEnd=a):Kc&&!Tc("9")&&(a=oGa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function Nnd(a,b,c){a.C.value=b;a.F.hb(!Ra(fb(a.C.value)));c&&a.C.select()}
function Mnd(a){var b=a.J,c=a.C.value,c=c.toLowerCase().trim();-1==Knd(b).indexOf(c)&&(c=new K5(c,b.F),b.ji(c,0,!0),b.Ia.scrollTop=0,b.dispatchEvent("change"));im(a.ma())==a.C&&a.C.blur();Nnd(a,"");a.C.focus()};function Ond(a,b){var c=new M5(I5.getInstance());a.qj(c);return Ea(Pnd,c,b)}function Pnd(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&Nnd(a,c,!0)};function Qnd(){E.call(this);this.C=new eg;this.D=new gg;F(this,this.D)}x(Qnd,E);function Rnd(a,b,c){this.C=a;this.D=b;this.F=c||null}Rnd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};Rnd.prototype.getSelection=g("D");function Snd(a,b){this.D=a;this.C=b};function Tnd(a,b,c){this.C=a;this.F=b;this.D=c||null}Tnd.prototype.Zv=g("F");function Und(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ra=new J(this);F(this,this.Ra)}x(Und,E);r=Und.prototype;r.A$a=function(a){var b=this.C.C;Vnd(this.D,a);N5(this,b,!0)};
r.Hmb=function(a){var b=this.C.C,c=this.D,d=bb(a.C.Zv()),e=a.D;a=new Gw;D(a,1,"\\b"+d+"\\b");D(a,3,e);D(a,6,!1);D(a,7,!1);D(a,8,!0);a.setType(2);D(a,11,0);var d=c.C.F;switch(c.C.Z){case "RANGE":D(a,5,0);a.setSelection(kh(d.rect,d.bd));var f=fz(c.D,d.bd);break;case "SHEET":D(a,5,1);f=new Id;D(f,1,""+d.bd);a.setSelection(f);f=fz(c.D,d.bd);break;case "WORKBOOK":D(a,5,2),f=c.D.Q9(-1,0,!1)}f=f.Wc();c.F.C(new yV(f,a));N5(this,b,!0)};
r.ytb=function(a){var b=this.C.C;if(za(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}N5(this,b,!1)};r.tob=function(a){var b=this.C.C;if(a instanceof Rnd){var c=this.D.H,d=a.C.Zv();a=a.getSelection();if(!Wnd(c,d,a)){var e=c.C[""+a.bd];e||(e=bv(c.D,a.bd),e.getSheetType(),e=e.Wc(),e=new uz(e,!0),c.C[""+a.bd]=e);c=a.$c.y;a=a.$c.x;var f=e.Gf(c,a);f||(f=new eg,vz(e,c,a,f));f.add(d.toLowerCase())}}N5(this,b,!1)};
r.uyb=function(a){var b=this.C.C;za(a)&&(this.J?this.J.F(a):I5.getInstance().F(a));N5(this,b,!1)};r.tLa=function(){P.Pga.Fd(!1);this.Ra.Rc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.tLa);Xnd(this.D.C)};r.RJb=function(){N5(this,null,!1)};r.KMa=function(a){var b=this.F.C;Q(b.Ma,!1);Q(b.Sa,!0);var b=this.C,c=v(this.iXa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.ea.push(b.C));Ynd(b,c,!!a)};
function N5(a,b,c){var d=a.F.C;Q(d.Ma,!1);Q(d.Sa,!0);b=v(a.iXa,a,b,c);a.H.C.getSelection();Ynd(a.C,b,!1)}
r.iXa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;Q(c.Ma,!0);Q(c.Sa,!1);var c=a.C,d=c.J.C;xi(c.zb);var e=c.ma().Db("docs-slidingdialog-content",c.getElement());e&&Po(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){var e=d.C,f=c.ma();c.getHandler().Rc(c.F,"focus",c.gNa).Rc(c.F,"blur",c.fNa).Rc(c.O,"input",c.iNa).Rc(c.F,"keydown",c.hNa);c.H.ob("");var h=c.F;var k=h.cloneNode(!0);Ll(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
G(c.removeChild(c.H));c.H=new MO("",f);c.Za(c.H);c.H.ub(c.F);G(c.O);c.O=new Sq(c.F);for(c.getHandler().R(c.F,"focus",c.gNa).R(c.F,"blur",c.fNa).R(c.O,"input",c.iNa).R(c.F,"keydown",c.hNa);0<c.D.vd();)c.D.Ln(0).dispose();f="Next misspelling. Change "+(e.Zv()+" to:");Po(c.F,"label",f);c.ma().If(c.od,e.Zv());f=e.C;if(0==f.length)c.H.ob(e.Zv()),h=new Jq("No suggestions"),c.D.Za(h,!0),h.Rf(2,!1),h.hb(!1),c.gc.C(!1);else{c.H.ob(f[0]);for(e=0;e<f.length;e++)h=new Jq(f[e]),c.D.Za(h,!0),c.getHandler().R(h,
"action",c.WEb).R(h.getElement(),"dblclick",c.Uvb),1<f.length&&(h.Wq(!0),h=xl("goog-menuitem-checkbox",h.Ia),Vo(h,"goog-inline-block"));(e=c.D.yd(0))&&1<c.D.vd()&&e.Ac(!0);c.D.Ak(0);c.gc.C(!0)}lmc(c.eb,d.getSelection());c.eOb.call(c,0,-1);Znd(c.ea);c.dOb.call(c,-1);Znd(c.V);Q(c.yb,!1);Q(c.rb,!0)}else Q(c.rb,!1),Hl(c.fc),c.Tb&&c.fc.appendChild(c.Tb),Q(c.yb,!0),c.zb=wi(v(c.Ju,c),c.wc),c.eb.hx();a.C.focus();(a=this.C.C)?$nd(this.D,a.getSelection()):b&&$nd(this.D)};function aod(a,b,c,d,e,f){mV.call(this,f);this.L=a;this.J=b;this.Hd=e;this.eb=new kmc(c);this.Za(this.eb);this.oa=new ss(null,f);this.Za(this.oa);this.V=new Ls(f);this.Hc=new Qs(null,this.V,RH.getInstance());this.Za(this.Hc);this.mb=new ss(null,f);this.Za(this.mb);this.ea=new Ls(f);this.Qc=new Qs(null,this.ea,RH.getInstance());this.Za(this.Qc);this.Eb=this.Ga=this.Z=null;this.H=new MO("",f);this.Za(this.H);this.D=new bod(f);Ms(this.D,!1);this.Za(this.D);this.Tb=this.fc=this.yb=this.rb=this.O=this.F=
null;this.wc=5E3;this.zb=this.od=null;this.gc=d;this.Ma=this.Sa=this.$a=null}x(aod,mV);function Znd(a){Wo(a.Ia,["goog-menu-no-icon","goog-menu-noaccel"])}r=aod.prototype;
r.Hka=function(){var a=gr("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+U(gmc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><label class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</label><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+U(hmc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+U(rs({id:"docs-spellcheckslidingdialog-button-change",style:2,Je:"docs-spellcheckslidingdialog-buttons-action",content:hr("Change")}))+U(ynd({id:"docs-spellcheckslidingdialog-button-change-menu",IB:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+U(rs({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Je:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:hr("Ignore")}))+U(ynd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Pg:"docs-spellcheckslidingdialog-buttons-white-menu",IB:""}))+"<br/>"+U(rs({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Je:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:hr("Add to Dictionary")}))+U(ynd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Pg:"docs-spellcheckslidingdialog-buttons-white-menu",IB:""}))+"</td></tr></tbody></table></div></div></div>");
b=V(b);a=""+U(Jlc({tEa:a,il:hr(""+b)}));return V(a)};r.H9=function(){var a=this.J.C,b=a?a.C.FS():null,c=this.Hd.C.replace(/_/g,"-"),d=a?a.F:null,e=rg(L(),"docs-anddc"),f=new Xh;Ra(fb(b))||O(f,56,b);O(f,60,c);e&&d&&(b=new znd,a=a.C.C,0<a.length&&O(b,2,a[0]),b.setContext(d.ABc()),a=d.lhb().start,O(b,3,a),d=d.lhb().end,O(b,4,d),Sh(f,66,b));return hi(gi(new fi,1),f).build()};
r.Ya=function(){aod.$.Ya.call(this);Vo(this.Ia,"docs-spellcheckslidingdialog");var a=this.ma();this.Sa=a.getElement("docs-spellcheckslidingdialog-loading");this.Ma=a.getElement("docs-spellcheckslidingdialog-content");this.yb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.fc=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.rb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new Sq(this.F);this.od=a.getElement("docs-spellcheckslidingdialog-original-word");this.eb.ub(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.ub(this.F);this.oa.ub(a.getElement("docs-spellcheckslidingdialog-button-change"));this.mb.ub(a.getElement("docs-spellcheckslidingdialog-button-ignore"));cod(this.Hc,this.oa,"docs-spellcheckslidingdialog-button-change-menu",P.Rga,this.L,a);cod(this.Qc,this.mb,"docs-spellcheckslidingdialog-button-ignore-menu",P.Tga,this.L,a);this.D.ub(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Si(!0);Znd(this.D);Ut(this.L,this.mb,P.G5,Vt,v(this.J.Ma,this.J),v(this.H9,this));Ut(this.L,this.oa,P.pW,Vt,v(this.bib,this),v(this.H9,this));this.Z=new ss(null,this.ma());this.Ga=new Ls(a);this.Eb=new Qs(null,this.Ga,RH.getInstance(),a);this.Za(this.Z);this.Za(this.Eb);this.Z.ub(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));dod(this,this.Z,P.f6,!0);cod(this.Eb,this.Z,"docs-spellcheckslidingdialog-button-dictionary-menu",P.Sga,this.L,a);var a=new Jq("View personal dictionary..."),
b=oc(Vt);delete b["node-label"];delete b.label;Ut(this.L,a,P.WE,b,v(this.B9,this,this.J));this.Ga.Za(a,!0);Znd(this.Ga);this.getHandler().R(this.D.getElement(),Kc?Yba:"focus",this.xDb);this.$a=new Co(this.getElement());F(this,this.$a);a=cxa("Ctrl+single-quote",!1);b=cxa("Ctrl+semicolon",!1);gxa(this.$a,P.J6,[a]);gxa(this.$a,P.K6,[b])};r.focus=function(){xp(this.rb)?this.H.Vl():this.yb.focus()};
function cod(a,b,c,d,e,f){c=f.getElement(c);a.ub(c);US(a,1);ISb(a,b.getElement());US(b,2);b=new Zr(c,a.Wf()?1:5);Ggc(a,b);Ut(e,a,d,Vt)}r.dOb=function(a){for(;0<this.V.vd();)this.V.Ln(0).dispose();var b=Cl("SPAN","docs-spellcheckslidingdialog-menu-text","Change all");a=Cl("SPAN","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new Jq(c);Ut(this.L,b,P.N4,void 0,v(this.E7a,this),v(this.H9,this));this.V.Za(b,!0)};
r.eOb=function(a,b){for(;0<this.ea.vd();)this.ea.Ln(0).dispose();a=Cl("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Cl("SPAN","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)"));var c=[];c.push(a);c.push(b);a=new Jq(c);dod(this,a,P.I5,!1);this.ea.Za(a,!0)};function eod(a){var b=a.H.bb();a=new Tnd(b,a.B9(a.J),a.J);P.pW.Oc(a)}r.Uvb=function(){eod(this)};r.gNa=function(){var a=this.ma().Xs(this.F);Vo(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
r.fNa=function(){var a=this.ma().Xs(this.F);Xo(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};r.hNa=function(a){13==a.keyCode&&eod(this)};r.xDb=function(){for(var a=0;a<this.D.vd();a++){var b=this.D.yd(a);if(b.isChecked()){b.Kg(!0);return}}0<this.D.vd()&&this.D.Ak(0)};function fod(a){for(var b=0;b<a.D.vd();b++)a.D.yd(b).Ac(!1)}r.iNa=function(){fod(this);this.gc.C(!0)};r.WEb=function(a){var b=a.target.bb();fod(this);this.H.ob(b);(a=a.target)&&1<this.D.vd()&&a.Ac(!0);this.H.Vl()};
r.bib=function(){var a=this.H.bb();return new Tnd(a,this.B9(this.J),this.J)};r.E7a=function(){var a=this.J,a=a.C?a.C.C:null;return new Snd(this.H.bb(),a)};function dod(a,b,c,d){Ut(a.L,b,c,d?Vt:void 0,v(a.B9,a,a.J),v(a.H9,a))}r.B9=function(a){return(a=a.C)?a.C.Zv():null};r.Ha=function(){xi(this.zb);G(this.O);aod.$.Ha.call(this)};function bod(a,b){Ls.call(this,a,b)}x(bod,Ls);bod.prototype.hk=function(a){return 27==a.keyCode?!1:bod.$.hk.call(this,a)};function god(a,b){this.H=a;this.C=b;this.D=0}god.prototype.F=function(a){this.H.F(a);a=Er(T(End,{mW:a}),P.On.getLabel(),v(this.L,this,a),"info",!0,1E4);Cr(this.C,this.D);this.D=this.C.postMessage(a)};god.prototype.L=function(a){this.H.L(a);a=Er(T(Fnd,{mW:a}),P.On.getLabel(),v(this.F,this,a),"info",!0,1E4);Cr(this.C,this.D);this.D=this.C.postMessage(a)};function hod(a,b,c,d,e,f,h){I.call(this);this.Cb=a;this.H=b;this.J=c;this.D=e;this.wb=h||new sl;this.C=new aod(this.H,this.D,this.J,d,f,this.wb);F(this,this.C);this.Ra=new J(this);F(this,this.Ra)}x(hod,I);hod.prototype.F=function(){this.Ra.Rc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");bDa(Vs.getInstance())||this.Cb.Xb(3);if(!P.cl.isEnabled()){var a=Br.getInstance(),b=Dr("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};function iod(a){E.call(this);this.D=a;this.C={};this.fb=new J(this);F(this,this.fb);this.fb.R(a,"ma",this.F)}x(iod,E);function Wnd(a,b,c){if(a=a.C[""+c.bd])if(c=a.Gf(c.$c.y,c.$c.x))return!!c.contains(b.toLowerCase());return!1}iod.prototype.F=function(a){G(this.C[""+a.Mi]);delete this.C[""+a.Mi]};function O5(){A.call(this)}x(O5,A);var jod=null;O5.prototype.rangeCount=function(){return xc(this,2)};function P5(){A.call(this)}x(P5,A);var kod=null;P5.prototype.Bc=function(){return B(this,1)};function Q5(){A.call(this)}x(Q5,A);var lod=null;function R5(){A.call(this)}x(R5,A);var mod=null;R5.prototype.wL=function(){return B(this,2)};function S5(){A.call(this)}x(S5,A);var nod=null;S5.prototype.Zv=function(){return B(this,1)};S5.prototype.FS=function(){return B(this,5)};
O5.prototype.Wa=function(){var a=jod;a||(jod=a=Dc(O5,{0:{name:"SpellcheckRequest",Qb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Ka:5,type:Number},2:{name:"range",Ka:11,type:Id},3:{name:"search_all_sheets",Ka:8,type:Boolean},4:{name:"active_filter_views",cd:!0,Ka:11,type:P5}}));return a};O5.Wa=O5.prototype.Wa;
P5.prototype.Wa=function(){var a=kod;a||(kod=a=Dc(P5,{0:{name:"FilterViewDataProto",Qb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Ka:9,type:String},2:{name:"filter_view_id",Ka:9,type:String}}));return a};P5.Wa=P5.prototype.Wa;
Q5.prototype.Wa=function(){var a=lod;a||(lod=a=Dc(Q5,{0:{name:"SpellcheckResponse",Qb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Ka:5,type:Number},2:{name:"last_column_searched",Ka:5,type:Number},3:{name:"last_grid_id_searched",Ka:9,type:String},4:{name:"searched_all_sheets",Ka:8,type:Boolean},6:{name:"searched_whole_range",Ka:8,type:Boolean},5:{name:"cell_suggestions",cd:!0,Ka:11,type:R5}}));return a};Q5.Wa=Q5.prototype.Wa;
R5.prototype.Wa=function(){var a=mod;a||(mod=a=Dc(R5,{0:{name:"CellSuggestionsProto",Qb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",cd:!0,Ka:11,type:S5},2:{name:"cell",Ka:11,type:Yd}}));return a};R5.Wa=R5.prototype.Wa;
S5.prototype.Wa=function(){var a=nod;a||(nod=a=Dc(S5,{0:{name:"PhraseSuggestionsProto",Qb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Ka:9,type:String},2:{name:"offset_start_index",Ka:5,type:Number},3:{name:"offset_end_index",Ka:5,type:Number},4:{name:"suggestions",cd:!0,Ka:9,type:String},5:{name:"spelling_language",Ka:9,type:String}}));return a};S5.Wa=S5.prototype.Wa;function ood(a,b,c){this.D=a;this.F=c||null;this.C=b}ood.prototype.Zv=g("D");ood.prototype.FS=g("F");ood.prototype.equals=function(a){var b=a.Zv(),c=a.FS();a=a.C;return this.D==b&&this.F==c&&Sb(this.C,a)};function pod(a,b,c){this.$c=a;this.bd=b;this.Cg=c}pod.prototype.equals=function(a){return this===a?!0:a instanceof pod?Cg(a.$c,this.$c)&&a.bd==this.bd&&Fga(a.Cg,this.Cg):!1};function T5(a,b,c,d,e){this.H=a;this.mb=b;this.rb=c;this.eb=d;this.$a=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.ea=[];this.fb=new J(this);F(this,this.fb);this.V=null;this.Z="RANGE";this.Ga=new gh;this.Ga.tv=!0;this.oa=new gh;this.oa.tv=!1}x(T5,E);T5.prototype.Ma=g("C");
function Xnd(a,b,c){kD(a.V);a.fb.Nc();a.Z=b;a.F=c;a.O=!1;a.L=[];a.ea=[];switch(b){case "WORKBOOK":a.J=new Bg(-1,0);(b=a.H.Q9(-1,0,!1,!0))?a.D=""+b.Fb():(a.D=null,a.O=!0);break;case "SHEET":a.J=new Bg(-1,0);a.D=""+c.bd;break;case "RANGE":a.J=new Bg(c.rect.left-1,c.rect.top),a.D=""+c.bd}}function qod(a,b){var c=b.getSelection(),d=fz(a.H,c.bd),e;(e=!d)||(d=d.Wc(),e=c.$c,e=!(UA(Qv(d,"r"),e.y)&&UA(Qv(d,"c"),e.x)));if(e)return!1;c=c.Cg;a=rod(a,b);b=b.C.Zv();return a.substring(c.start,c.end)==b}
function rod(a,b){a=sod(a,b);return Ka(a,"'")?a.substring(1):a}function tod(a,b){a=sod(a,b);return Ka(a,"'")}function sod(a,b){b=b.getSelection();var c=b.$c,d=b.bd;a=fz(a.H,d).Wc();a.Rt(Sg(b.$c));return Nv(a.Pf(c.y,c.x),d,c.y,c.x)}
function uod(a,b){if(a.D){var c=new O5,d=new Id;D(d,1,a.D);D(d,2,a.J.y);switch(a.Z){case "WORKBOOK":D(c,3,!0);Kd(d,0);var e=P_a(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&vod(c,e[f]);break;case "SHEET":Kd(d,0);e=fz(a.H,a.F.bd);vod(c,e);break;case "RANGE":Kd(d,a.F.rect.tc()),Jd(d,a.F.rect.Sc()),Ld(d,a.F.rect.Yc()),e=fz(a.H,a.F.bd),vod(c,e)}D(c,2,d);D(c,1,a.J.x+1);Gj(Hj(uk(Ij(a.mb.Xf("/spell"),{data:a.Ga.serialize(c)}),"POST"),function(a){this.Sk(a,b)},a),function(){this.Sk(null,b)},a).jf()}else wod(a,
b,!1)}function vod(a,b){if(b){var c=b.Wc().H;if(gv(c)){b=""+b.Fb();var c=jv(c),d=new P5;D(d,1,b);D(d,2,c);yc(a,4,d)}}}
T5.prototype.Sk=function(a,b){if(a){a=this.oa.ld(Q5.Wa(),a.yg());this.J=new Bg(B(a,2),B(a,1));this.D=B(a,3);this.O=B(a,6);a=Bc(a,5);for(var c=0;c<a.length;c++)for(var d=a[c],e=d.wL().Iz(),f=d.wL().getColumnIndex(),e=new Bg(f,e),f=parseInt(d.wL().Fb(),10),d=Bc(d,1),h=0;h<d.length;h++){var k=d[h],l=k.Zv(),m=B(k,2),p=B(k,3),q=k.FS(),m=new pod(e,f,new Fg(m,p));xod(this,l,m)||(k=Bc(k,4),this.L.push(new Rnd(new ood(l,k,q),m)))}}Ynd(this,b,!1)};
function Ynd(a,b,c){if(c){var d=a.ea;var e=v(d.pop,d)}else d=a.L,e=v(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.Zv();if(!xod(a,h,f.getSelection())){e=c;h=f.getSelection();c=fz(a.H,h.bd);d=c.Wc();h=Sg(h.$c);f=v(a.Sa,a,f,b,e);d.Rt(h)?f():(kD(a.V),a.V=qz(c.D,h).addCallback(f));return}}wod(a,b,c)}function wod(a,b,c){a.O||c?(a.C=null,b(null)):uod(a,b)}T5.prototype.Sa=function(a,b,c){qod(this,a)?(this.C=a,b(a.C)):Ynd(this,b,c)};
function xod(a,b,c){return a.eb.C.contains(b.toLowerCase())||Wnd(a.$a,b,c)||a.rb.C.contains(b.toLowerCase())}T5.prototype.Ha=function(){T5.$.Ha.call(this);kD(this.V)};function yod(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function Vnd(a,b){var c=b.D.C;if(qod(a.C,c)){var d=c.getSelection(),e=d.bd,f=d.Cg,h=fz(a.D,e).Wc(),k=tod(a.C,c),c=rod(a.C,c),l=new EG(h,Sg(d.$c),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));hy(l,v(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Cg(f.$c,d.$c)&&f.bd==d.bd&&f.Cg.start>d.Cg.end){var h=Gg(d.Cg)-c.length;f.Cg.start-=h;f.Cg.end-=h}}}},a));JS(a.D,new dh(e,"",Sg(d.$c)),v(function(){this.F.C(l)},a))}}
function $nd(a,b){b&&JS(a.D,new dh(b.bd,"",Sg(b.$c)))};function zod(a){this.un=new mmc(a)}zod.prototype.C=function(a){var b=new pf,c=new Id;D(c,2,a.$c.y);Jd(c,a.$c.y+1);Kd(c,a.$c.x);Ld(c,a.$c.x+1);D(c,1,""+a.bd);yc(b,2,c);c=new Yd;D(c,1,""+a.bd);D(c,2,a.$c.y);D(c,3,a.$c.x);D(b,1,c);return this.un.C(new nh(b))};function Aod(a,b,c,d,e,f,h,k){kV.call(this,"docs-spellcheckslidingdialog-id",c,v(this.Mva,this));this.ea=a;this.Ma=new god(I5.getInstance(),Br.getInstance());this.Z=new Qnd;this.V=new iod(a);this.H=new T5(a,e,I5.getInstance(),this.Z,this.V);this.Ga=new yod(a,b,this.H,this.V);b=rl();a=new hod(c,(new lR).build(),new zod(a),new And("trigger-text",!1),this.H,k,b);F(this,a);this.O=a.C;this.D=new Und(a,this.Z,this.H,this.Ga,d,this.Ma);this.F=b.qa("DIV",{style:"margin-top: 10px"});this.J=qO("Search the rest of the sheet",
b);this.J.render(this.F);this.getHandler().R(this.J,"action",this.aSb);this.L=qO("Search all sheets",b);this.L.render(this.F);this.getHandler().R(this.L,"action",v(this.Mva,this,"WORKBOOK"));uD(h,I5.getInstance(),"docs-user_dictionary");P.G5.subscribe("action",this.D.tob,this.D);P.I5.subscribe("action",this.D.ytb,this.D);P.f6.subscribe("action",this.D.uyb,this.D);P.pW.subscribe("action",this.D.A$a,this.D);P.N4.subscribe("action",this.D.Hmb,this.D);P.J6.subscribe("action",v(this.D.KMa,this.D,!1));
P.K6.subscribe("action",v(this.D.KMa,this.D,!0));P.WE.setVisible(!0);P.WE.subscribe("action",Ond(f,Gf(this.O)))}x(Aod,kV);r=Aod.prototype;r.h0=g("O");r.Cy=function(){Aod.$.Cy.call(this);this.getHandler().R(this.C,"close",this.FZb).R(this.ea,"ra",this.GZb)};r.FZb=function(){this.aG()};r.GZb=function(){this.C.Ju();this.aG()};
r.Mva=function(a,b){var c=b||null,d;a||((b=this.ea.C)?0==b.getSheetType()?(c=b.Wc().Xc(),1<c.Mh()?(a="RANGE",c=new dh(b.Fb(),b.C,c)):(a="SHEET",c=new dh(b.Fb(),b.C,null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.J.setVisible(!0);this.L.setVisible(!0);Q(this.F,!0);break;case "SHEET":this.J.setVisible(!1);this.L.setVisible(!0);Q(this.F,!0);break;case "WORKBOOK":Q(this.F,!1)}Xnd(this.H,a,c);a=this.O;a.Tb=this.F;a.wc=d?d:5E3;a=this.D;P.Pga.Fd(!0);a.Ra.R(a.F,"docs-text-spellcheckdialogcontroller-closed",
a.tLa);d=a.F;a=v(a.RJb,a);b=d.D.C;d.C.Dc()||d.C.render(bm(d.wb,"docs-spellcheckslidingdialog-id"));(c=d.C.cL)&&b?d.C.focus():(c||d.Ra.R(d.C,"close",d.F),a())};r.aSb=function(){var a=this.H.F;this.Mva("SHEET",new dh(a.bd,a.Yh,null))};function Bod(){E.call(this)}x(Bod,bn);Bod.prototype.C=function(a,b,c,d,e,f,h,k){return new Aod(a,b,c,d,e,f,h,k)};on("spellcheck",Bod);
