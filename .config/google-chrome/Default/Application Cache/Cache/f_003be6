dV.prototype.AUa=ea(247,function(a){this.J=Mb(arguments,0)});function QV(a,b){return B(a,2,b)}function Bnc(a,b,c,d,e){return Jxb(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function RV(a){Nh(this,a,0,-1,null)}x(RV,Mh);function SV(a){Nh(this,a,0,-1,null)}x(SV,Mh);var Cnc=[3],Dnc=[1],Enc=[1],Fnc=[1],Gnc=[1,2],Hnc=[2];function Inc(a){return ic(Okc,function(b){return b.match(a)}).getName()}function Jnc(a){Nh(this,a,0,-1,null)}x(Jnc,Mh);
Jnc.prototype.Uf=function(){return M(this,2)};function Knc(a){Nh(this,a,0,-1,null)}x(Knc,Mh);Knc.prototype.getChartType=function(){return M(this,1)};function Lnc(a){Nh(this,a,0,-1,null)}x(Lnc,Mh);function Mnc(a){Nh(this,a,0,-1,Cnc)}x(Mnc,Mh);Mnc.prototype.getChartType=function(){return M(this,1)};function Nnc(a){Nh(this,a,0,-1,Dnc)}x(Nnc,Mh);function Onc(a){Nh(this,a,0,-1,Enc)}x(Onc,Mh);function Pnc(a){Nh(this,a,0,-1,Fnc)}x(Pnc,Mh);function Qnc(a){Nh(this,a,0,-1,Gnc)}x(Qnc,Mh);
var Rnc={qxc:0,dBa:1,ABa:2};function Snc(a){Nh(this,a,0,-1,Hnc)}x(Snc,Mh);
var Tnc={Bxc:0,SUM:1,AVERAGE:2,gza:3,byc:4,Ivc:5,MEDIAN:6,COUNT:7,mvc:8,nvc:9},Unc={UNKNOWN_ERROR:0,Pxc:1,Poc:2,Sac:3},Vnc={Exc:0,gbc:1,sfa:2,qk:3,wxc:4,i3b:5,Bcc:6},Wnc={Cxc:0,nE:1,Voc:2,Boc:3,hrc:4},Xnc={xxc:0,Roc:1,WJ:2,$lc:3},Ync={oxc:0,$wc:1,ffc:2,Xvc:3,Wvc:4,m6b:5,Pmc:6},Znc={bvc:0,YJ:1,xZa:2,Wwc:3,Ptc:4,O1a:5,Oxc:6,Cya:7,Awa:8,fxa:9,HISTOGRAM:10},$nc={UNKNOWN:0,Z2b:1,Y2b:2,X2b:3,f4b:4,R5b:5,g6b:6,E9b:7,Ibc:8,ync:9,urc:10,Brc:11,ovc:12,pvc:13,Dwc:14,Tqc:15};function TV(){A.call(this)}x(TV,A);var aoc=null;TV.prototype.Am=function(){return B(this,1)};function UV(){A.call(this)}x(UV,A);var boc=null;UV.prototype.getText=function(){return B(this,1)};UV.prototype.Ur=function(){return wc(this,1)};function VV(){A.call(this)}x(VV,A);var coc=null;VV.prototype.getStatus=function(){return B(this,1)};VV.prototype.getError=function(){return B(this,9)};function WV(){A.call(this)}x(WV,A);var doc=null;function XV(){A.call(this)}x(XV,A);var eoc=null;
function YV(){A.call(this)}x(YV,A);var foc=null;YV.prototype.Oaa=function(){return wc(this,1)};YV.prototype.getType=function(){return B(this,3)};YV.prototype.setType=function(a){D(this,3,a)};function ZV(){A.call(this)}x(ZV,A);var goc=null;function $V(){A.call(this)}x($V,A);var hoc=null;
TV.prototype.Wa=function(){var a=aoc;a||(aoc=a=Dc(TV,{0:{name:"Error",Qb:"ritz.assistant.Error"},1:{name:"message",Ka:9,type:String},2:{name:"code",Ka:14,defaultValue:0,type:Unc},3:{name:"unsupported_op_reason",Ka:14,defaultValue:0,type:Vnc}}));return a};TV.Wa=TV.prototype.Wa;
UV.prototype.Wa=function(){var a=boc;a||(boc=a=Dc(UV,{0:{name:"AnswerQueryPhrase",Qb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ka:9,type:String},2:{name:"start_byte",Ka:5,type:Number},3:{name:"num_bytes",Ka:5,type:Number}}));return a};UV.Wa=UV.prototype.Wa;
VV.prototype.Wa=function(){var a=coc;a||(coc=a=Dc(VV,{0:{name:"AnswerResponse",Qb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ka:5,type:Number},10:{name:"parse_status",Ka:14,defaultValue:0,type:Wnc},11:{name:"answer_status",Ka:14,defaultValue:0,type:Xnc},2:{name:"formula",Ka:9,type:String},3:{name:"debug_parse_response",Ka:9,type:String},4:{name:"interpretation",Ka:9,type:String},5:{name:"debug_interpretation_response",Ka:9,type:String},6:{name:"unused_phrase",cd:!0,Ka:11,type:UV},7:{name:"used_entity_phrase",
cd:!0,Ka:11,type:UV},8:{name:"unused_entity_phrase",cd:!0,Ka:11,type:UV},9:{name:"error",Ka:11,type:TV},12:{name:"alternate_suggestion",cd:!0,Ka:11,type:YV},14:{name:"deprecated_formula_builder_used",Ka:9,type:String},15:{name:"answer_visualization_type",cd:!0,Ka:14,defaultValue:0,type:Znc},16:{name:"formula_builder_used",Ka:14,defaultValue:0,type:$nc},17:{name:"charting_info",Ka:11,type:XV},18:{name:"answer_field_info",cd:!0,Ka:11,type:WV},19:{name:"charting_formula",Ka:9,type:String},21:{name:"parse_info",
cd:!0,Ka:11,type:ZV}}));return a};VV.Wa=VV.prototype.Wa;WV.prototype.Wa=function(){var a=doc;a||(doc=a=Dc(WV,{0:{name:"AnswerFieldInfo",Qb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ka:14,defaultValue:0,type:Eea}}));return a};WV.Wa=WV.prototype.Wa;
XV.prototype.Wa=function(){var a=eoc;a||(eoc=a=Dc(XV,{0:{name:"ChartingInfo",Qb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",cd:!0,Ka:14,defaultValue:0,type:Znc},2:{name:"recommended",Ka:8,type:Boolean},3:{name:"user_requested_type",cd:!0,Ka:14,defaultValue:0,type:Znc},4:{name:"show_only_chart",Ka:8,type:Boolean}}));return a};XV.Wa=XV.prototype.Wa;
YV.prototype.Wa=function(){var a=foc;a||(foc=a=Dc(YV,{0:{name:"QuerySuggestion",Qb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ka:9,type:String},2:{name:"formula",Ka:9,type:String},3:{name:"type",Ka:14,defaultValue:0,type:Ync},4:{name:"deprecated_formula_builder_used",Ka:9,type:String},5:{name:"formula_builder_used",Ka:14,defaultValue:0,type:$nc}}));return a};YV.Wa=YV.prototype.Wa;
ZV.prototype.Wa=function(){var a=goc;a||(goc=a=Dc(ZV,{0:{name:"ParseInfo",Qb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",cd:!0,Ka:11,type:$V}}));return a};ZV.Wa=ZV.prototype.Wa;$V.prototype.Wa=function(){var a=hoc;a||(hoc=a=Dc($V,{0:{name:"IntentInfo",Qb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ka:14,defaultValue:0,type:Tnc}}));return a};$V.Wa=$V.prototype.Wa;function aW(a,b,c,d,e,f){H.call(this,a,b);this.C=b;this.ea=c;this.Z=d||null;this.Sa=e||null;this.F=f||null}x(aW,H);aW.prototype.zk=g("ea");aW.prototype.$e=g("Z");function ioc(a,b,c,d,e,f){aW.call(this,"Ee",null,d,e,f);this.J=a;this.L=b;this.Cc=c}x(ioc,aW);ioc.prototype.Xd=g("Cc");function joc(a,b,c){aW.call(this,"Ie",null,2859);this.J=a;this.L=b;this.V=c}x(joc,aW);function koc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Jm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Jm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function bW(){}x(bW,rJ);qa(bW);bW.prototype.Kc=n("waffle-assistant-link-button");function loc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function moc(a,b){S.call(this,b);this.D=a;this.C=new ks("",new bW,this.ma());this.Za(this.C)}x(moc,S);r=moc.prototype;r.qa=function(){this.Ia=T(loc)};r.Ya=function(){moc.$.Ya.call(this);var a=this.gb("waffle-assistant-feedback-card-link");this.C.ub(a);this.getHandler().R(this.Ia,"mousedown",this.Xg).R(this.C,"action",this.yrb);this.show(!1)};r.Xg=function(a){a.stopPropagation()};
r.show=function(a){var b=this.Ia,c=this.gb("waffle-assistant-feedback-card-link");Zo(b,"waffle-assistant-feedback-card-hidden",!a);Wl(c,a)};r.yrb=function(){P.Oy.Oc({source:this.D});this.show(!1);this.dispatchEvent(new H("feedback-dialog-opened"))};function cW(){}x(cW,is);qa(cW);cW.prototype.Kc=n("waffle-assistant-button");function dW(a,b,c,d){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ua(b),qs(a,b,d),Jhc(a),a.setAttribute("data-tooltip-delay",500),mVb(a,t(c)?c:1))};function noc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Ht({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Ht({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function eW(a){S.call(this,a);this.C=new ks("",new cW,this.ma());this.Za(this.C);this.D=new ks("",new cW,this.ma());this.Za(this.D)}x(eW,S);eW.prototype.qa=function(){this.Ia=T(noc)};eW.prototype.Ya=function(){eW.$.Ya.call(this);var a=this.gb("waffle-assistant-thumbs-down-button");this.C.ub(a);dW(a,"Not useful");a=this.gb("waffle-assistant-thumbs-up-button");this.D.ub(a);dW(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function ooc(a,b){a.ma().If(a.gb("waffle-assistant-thumbs-text"),b)}eW.prototype.F=function(){this.dispatchEvent(new H("thumbs-down"));Q(this.Ia,!1)};eW.prototype.H=function(){this.dispatchEvent(new H("thumbs-up"));Q(this.Ia,!1)};function fW(a,b){var c=this;S.call(this,b);this.D=a;this.V=this.O=this.ea=null;this.mb=new tV(!0,"#4285f4");this.Za(this.mb);this.rb=this.Mb=this.wc=!1;this.Ma=new xk(function(){c.Ma.stop();c.Ia.parentNode.querySelector(":hover")==c.Ia?c.Ma.start():c.yaa()},100);F(this,this.Ma);this.od=this.Eb=!1}x(fW,S);r=fW.prototype;r.$D=Hf;r.Qaa=If;r.eM=Jf;r.dM=Jf;r.h$=Jf;r.Ama=Jf;r.zma=Jf;r.rf=ca("od");r.Ld=g("od");r.loa=pa;r.qa=function(){this.Ia=T(koc)};
r.Ya=function(){fW.$.Ya.call(this);var a=this.gb("waffle-assistant-card-spinner-container");this.mb.render(a);cp(this.gb("waffle-assistant-card-inner"),"visibility","hidden");if(this.$D()){var a=this.Ia,b=new bp(a);F(this,b);this.getHandler().R(b,"focusin",this.vmb).R(b,"focusout",this.tmb).R(a,"mouseenter",this.Hoa).R(a,"mouseleave",this.yaa)}poc(this,!1);Jm&&(this.V=new moc(this.iG(),this.ma()),this.V.render(this.gb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.V,"feedback-dialog-opened",
this.zrb).R(this,"trigger_feedback",this.CVb),this.Qaa()?(this.O=new eW(this.ma()),this.O.render(this.gb("waffle-assistant-thumbs-container")),qoc(this,!0),a=fb(this.h$()),Ra(a)||ooc(this.O,a),a=fb(this.Ama()),Ra(a)||dW(this.O.gb("waffle-assistant-thumbs-up-button"),a),a=fb(this.zma()),Ra(a)||dW(this.O.gb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.O,"thumbs-down",this.X_b).R(this.O,"thumbs-up",this.Y_b)):qoc(this,!1));this.yI()};
function gW(a){return a.gb("waffle-assistant-card-content-container")}function roc(a){a.$D();return a.gb("waffle-assistant-card-options")}function qoc(a,b){Jm&&Q(a.gb("waffle-assistant-thumbs-container"),a.Qaa()&&b)}r.hR=function(){this.isDisposed()||(this.wc=!0,soc(this))};function toc(a,b){!a.Mb&&b&&(a.Mb=!0,soc(a))}function soc(a){if(a.wc&&a.Mb){var b=v(a.W_b,a);a.JI(b)}}r.Hoa=function(){this.rb||(poc(this,!0),this.rb=!0,this.Ma.start())};r.yaa=function(){poc(this,!1);this.rb=!1};
r.vmb=function(){poc(this,!0)};r.tmb=function(){var a=this,b=new xk(function(){Rl(a.Ia,document.activeElement)||a.Ia.parentNode.querySelector(":hover")==a.Ia||poc(a,!1)},0);F(this,b);b.start()};r.X_b=function(){uoc(this,!0);qoc(this,!1);var a=this.dM();this.dispatchEvent(new aW("Je",this,a))};r.Y_b=function(){qoc(this,!1);var a=this.eM();this.dispatchEvent(new aW("Je",this,a))};r.zrb=function(){uoc(this,!1)};r.CVb=function(){uoc(this,!0)};
function poc(a,b){var c=a.gb("waffle-assistant-card-options");a=a.$D();Q(c,a&&b)}r.W_b=function(){this.mb.setActive(!1);Q(this.mb.Ia,!1);cp(this.gb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new H("content-rendered"))};function uoc(a,b){Zo(a.gb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.V.show(b)};function voc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(rs({Je:"waffle-assistant-section-more-button",content:hr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function woc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function xoc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(woc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function yoc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(rs({Je:"waffle-assistant-panel-back-button",content:hr(""+U(Ht({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function hW(a){S.call(this,a);this.od=new tV(!1,"#4285f4");this.Za(this.od);this.L=new S(this.ma());this.Za(this.L);this.C=[];this.Ze=this.gf=!1;this.Od=this.Hd=this.Eb=this.Z=null;this.wc=new ss("",a,4);Fq(this.wc,2,!1);this.Za(this.wc)}x(hW,S);var zoc={defaultHelpArticleId:"6280499"};r=hW.prototype;r.qa=function(){hW.$.qa.call(this);this.Ia=T(xoc);this.Hd=this.gb("waffle-assistant-panel-content-container");this.Od=this.gb("waffle-assistant-empty-list")};
r.Ya=function(){hW.$.Ya.call(this);var a=this.gb("waffle-assistant-spinner-container");this.od.render(a);this.L.ub(this.gb("waffle-assistant-panel-card-holder"));this.wc.ub(this.gb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.wc,"action",this.Z_b).R(this.Ia,"scroll",Thc(this.SXa,10,this))};r.setVisible=function(a){var b=this;Q(this.Ia,a);z(this.C,function(a){if(!a.Dc()){var c=b.L.vd();a.ea=c;b.L.Za(a,!0);a.hR()}});this.gf=a};
r.Nsa=function(a,b){var c=this.ma();this.Z&&this.j8();this.Z=new S;this.Za(this.Z);a=Xq(a,yoc,{title:b});this.Eb=new ss("",this.ma());this.Z.Za(this.Eb);this.Eb.ub(c.gb("waffle-assistant-panel-back-button",a));dW(this.Eb.Ia,"Back");this.Z.getHandler().R(this.Eb,"action",this.Olb)};r.j8=function(){this.Z.dispose();this.Z=null};function Aoc(a,b){a.od.setActive(b);Q(a.gb("waffle-assistant-panel-pane"),!b)}r.mI=function(a){Q(this.Od,a);Q(this.Hd,!a)};
function Boc(a,b){Hb(a.C,b);a.L.removeChild(b);a.L.ji(b,0);a.C.push(b)}r.YH=function(a){Hb(this.C,a);-1!=Qp(this.L,a)&&this.L.removeChild(a,!0)};r.yZ=function(){this.L.Md(!0);Fc(this.C);this.C=[]};r.SXa=function(){for(var a=this.Ia,a=a.scrollTop+up(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(toc(d,!0),b+=up(d.Ia).height):toc(d,!1)}};r.rf=function(a){this.Ze=a;z(this.C,function(b){b.rf(a)})};r.Ld=g("Ze");r.Z_b=function(){P.Ko.Oc(zoc)};r.Olb=function(){this.dispatchEvent("Be")};function iW(a,b,c,d){S.call(this,d);this.V=a;this.eb=b;this.Z=new ss("",this.ma());this.Za(this.Z);this.J=new S(this.ma());this.Za(this.J);this.C=null;this.$a=[];this.Sa=this.Ma=!1;this.Lb=c}x(iW,S);r=iW.prototype;r.VNa=Hf;r.Rta=If;r.qa=function(){iW.$.qa.call(this);this.Ia=T(voc,{title:this.x4()})};
r.Ya=function(){iW.$.Ya.call(this);this.J.ub(this.gb("waffle-assistant-section-card-holder"));this.Z.ub(this.gb("waffle-assistant-section-more-button"));this.getHandler().R(this.Z,"action",this.Bwb);this.C=this.TDa();F(this,this.C);Q(Coc(this),this.VNa());this.setVisible(!1)};r.setVisible=function(a){if(this.Dc()&&this.tb()!=a&&(Q(this.Ia,a),a)){Q(this.Z.Ia,this.kVa());a=new tia;O(a,4,this.Tva());var b=new Xh;Sh(b,58,a);a=hi(gi(new fi,10),b).build();this.Lb.rc(2774,a)}};
r.tb=function(){return this.Dc()&&xp(this.Ia)};r.kVa=function(){return this.$a.length>this.V};r.TDa=function(){return new hW(this.ma())};r.rf=function(a){this.Sa=a;z(Doc(this),function(b){b.rf(a)});this.C.rf(a)};r.Ld=g("Sa");r.yh=pa;
r.Sva=function(a){this.$a=a;for(var b=0;b<a.length;b++){if(this.J.vd()<this.V){var c=this.V7(a[b]);c.rf(this.Sa);var d=this.J.vd();c.ea=d;this.J.Za(c,!0)}if(this.Rta()&&(this.C.mI(!1),c=this.C,d=this.V7(a[b]),c.C.push(d),c.gf)){Aoc(c,!1);var e=c.L.vd();d.ea=e;c.L.Za(d,!0);d.hR()}}};function Doc(a){var b=[];a.J.eg(function(a){b.push(a)});return b}function Coc(a){return a.gb("waffle-assistant-section-content")}r.$oa=function(){return this.J.Jaa()};
r.jW=function(){this.$a=[];Fc(this.J.Md(!0));this.setVisible(!1);this.Rta()&&(this.C.yZ(),this.C.mI(!0))};function Eoc(a){a.J.eg(function(a,c){c<this.V&&a.hR()},a)}r.Uva=function(a){var b=0;if(this.Ma)this.C.SXa();else if(this.$oa()){this.setVisible(!0);for(var b=up(this.gb("waffle-assistant-section-header")).height+up(Coc(this)).height,c=Doc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.eLa(c[d]),toc(c[d],!0),b+=up(c[d].Ia).height):toc(c[d],!1)}else this.setVisible(!1);return a-b};r.eLa=pa;
r.setActive=function(a){(this.Ma=a)||this.C.j8()};r.kc=g("Ma");function Foc(a,b){a.C.Nsa(b,a.x4())}r.Bwb=function(){this.setActive(!0);this.dispatchEvent("He")};r.Yv=g("Lb");var Goc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function Hoc(a){var b=new FC(pc(Goc));return ekc(a,b)}
function Ioc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.mc("useFirstColumnAsDomain")&&a.Xd()&&"number"===a.Xd().qd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.mc("useFirstColumnAsDomain")&&a.Xd()&&"string"===a.Xd().qd(0)){var c=0,d=Dl("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Xd().getNumberOfRows();b++)Ul(d,a.Xd().$f(b,0)),c=Math.max(c,Bp(d).width);Kl(d);c=Math.min(27,Math.max(15,10+100*c/271))}Ym()||Rm||(a.setOption("chartArea.top","15%"),b=a.mc("hAxis.title"),a.setOption("chartArea.height",Ra(fb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ra(fb(a.mc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function Joc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Koc(){return V(U(rs({Je:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:hr(""+U(Ht({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(rs({Je:"waffle-assistant-zoom-button",content:hr(""+U(Ht({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function Loc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.P6a)+"</span>"),d=0==a.iHa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.iHa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Jm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Moc(a,b,c,d,e,f,h){S.call(this,h);this.F=a;this.D=b;this.J=e;this.Lb=f;this.C=this.Cc=null;this.H=gi(new fi,10).build()}x(Moc,S);r=Moc.prototype;r.Ya=function(){Moc.$.Ya.call(this);(new lU(UC,this.D.xf())).send(v(this.Tob,this,this.D))};r.loa=function(a,b){a=new ioc(this.F.clone(),this.J,this.Cc,2746,a,b);this.dispatchEvent(a)};r.Tob=function(a,b){b&&(b.Fi()?tC.zB(this.Ia,b):(b=b.Xd(),a.qe(b),GU(a,b),uC(a,"ready",v(this.M_b,this,a)),UU(a,this.Ia,this.Lb,Rm),this.Cc=b))};
r.M_b=function(a){a.Cm()&&(uC(a.Cm(),"onmouseover",v(this.K_b,this)),uC(a.Cm(),"onmouseout",v(this.L_b,this)))};r.K_b=function(){this.C=Ga()};r.L_b=function(){Ba(this.C)&&500<Ga()-this.C&&this.Lb.rc(2750,this.H);this.C=null};function Noc(a,b,c,d,e){S.call(this,e);this.J=a;this.Ma=b;this.Lb=c;this.O=d;this.L=Bc(this.J,23);this.Ga=B(this.J,22);this.D=B(this.J,26);this.oa=[];this.Ie=new gh;this.V=this.F=this.C=null;this.Z=!1;this.ea=new ss("",this.ma());this.Za(this.ea);this.H=null}x(Noc,S);r=Noc.prototype;r.qa=function(){Noc.$.qa.call(this);this.Ia=T(Loc,{P6a:this.D,iHa:this.L});this.Ia.style.visibility="hidden"};
r.Ya=function(){Noc.$.Ya.call(this);var a=this.gb("waffle-assistant-facet-toggle");this.ea.ub(a);this.getHandler().R(this.Ia,"mousedown",this.Xg).R(this.ea,"action",this.iEb);Jm&&(this.V=new moc("assistantAutovisFacetFeedback",this.ma()),this.V.render(this.gb("waffle-assistant-facet-feedback-container")),this.C=new eW(this.ma()),this.Za(this.C),this.C.render(this.gb("waffle-assistant-facet-thumbs-container")),ooc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.J_b).R(this.C,"thumbs-down",this.I_b));Ooc(this,Dra)};r.Ld=g("Z");r.rf=function(a){this.Z=a;Poc(this)};r.Xg=function(a){a.stopPropagation()};r.iEb=function(){var a=Uo(this.gb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Ooc(this,a);Qoc(this,a?2647:2646)};
function Ooc(a,b){var c=a.gb("waffle-assistant-facet-toggle");Ul(c,b?"HIDE":"SHOW");Zo(a.gb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.Wi("waffle-assistant-faceted-chart"),function(a){Wl(a,b)});a.C&&Q(a.C.Ia,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');dW(c,b?a:d)}
function Roc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Soc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Poc(a){a.O&&!a.Z&&z(a.oa,v(function(a){var b=a.Ia;if(!this.O.contains(b)){var d=this.O;a=new Toc(b,a);Zmb(d,a)}},a))}r.J_b=function(){Qoc(this,2649)};r.I_b=function(){Qoc(this,2648);this.V.show(!0)};function Qoc(a,b){var c=a.Lb,d=new QU,e=a.H.getChartType();d.C=e;e=a.H.Xd();d.F=e?e.clone():null;RU(c,b,d,10,a.H,a.H.xf())};function jW(a,b,c,d,e,f){fW.call(this,a,f);this.C=B(a,8);this.Qc=b;this.Hc=c;this.Lb=d;this.eb=e;this.L=new ss("",this.ma());this.Za(this.L);this.Z=new ss("",this.ma());this.Za(this.Z);this.Ie=new gh;this.gc=null;this.Sa=!1;this.fc=[];this.Tb=[];this.zb=[];this.$a=this.Ga=this.F=this.H=this.oa=null;this.J=gi(new fi,10).build()}x(jW,fW);
var kW={zYa:"waffle-assistant-after-chart-preview",TYa:"waffle-assistant-before-chart-preview",fZa:"waffle-assistant-card-draggable",E5:"waffle-assistant-chart-highlights",F0a:"waffle-assistant-insert-chart-button",Aga:"waffle-assistant-chart-preview",A2a:"waffle-assistant-button-separator",X2a:"waffle-assistant-styled-border",Y2a:"waffle-assistant-styled-rect",Z3a:"waffle-assistant-zoom-button"};r=jW.prototype;r.JI=function(a){this.gc=a;Uoc(this)};
r.yI=function(){Voc(this,v(function(a){a=hlc(this.Qc,a);So(this.Ia,a)},this),!1)};r.$D=If;r.iG=n("autovisFeedback");r.eM=n(2208);r.dM=n(2207);r.h$=n("Was this chart useful?");r.qa=function(){jW.$.qa.call(this);gW(this).appendChild(T(Joc));roc(this).appendChild(T(Koc));wc(this.C,22)&&(this.F=new Noc(this.C,this.ea,this.Lb,this.eb,this.ma()),this.Za(this.F,!0),this.F.rf(this.Ld()))};
r.Ya=function(){jW.$.Ya.call(this);Vo(this.Ia,kW.fZa);var a=this.gb(kW.F0a);this.L.ub(a);dW(a,"Insert chart");a=this.gb(kW.Z3a);this.Z.ub(a);dW(a,"View full size");var a=this.gb(kW.TYa),b=this.gb(kW.Aga),c=this.gb(kW.zYa);this.getHandler().R(this.Ia,"keydown",this.F_b).R(b,"click",this.bnb).R(a,"focus",this.Xlb).R(c,"focus",this.Qkb).R(this.L,"action",this.cub).R(this.L.Ia,"mousedown",this.Xg).R(this.Z,"action",this.VFb).R(this.Z.Ia,"mousedown",this.Xg).R(this.gb(kW.E5),"mousedown",this.Xg).R(dv(this.Qc),
"Ta",this.G_b);Woc(this);this.Lb.rc(2790,this.J);this.F&&this.Lb.rc(2791,this.J)};r.rf=function(a){jW.$.rf.call(this,a);Woc(this);this.Dc()&&Xoc(this)};function Woc(a){if(a.Dc()){var b=a.Ld();a.L.setVisible(!b);a=a.ma().gb(kW.A2a,roc(a));Q(a,!b)}}r.F_b=function(a){13==a.keyCode&&a.target==this.Ia&&(a.preventDefault(),a.stopPropagation(),Yoc(this,2255))};
function Zoc(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,b="PieChart"==b,h=xT(Bc(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var p=$oc(h[m].rect,c!=b);Lb(l,p)}var c=rB(a.Hc).zd(),q=[];for(u in xg)q.push(c.w4(xg[u]));var u=sb(l,function(a){return sb(q,Ea(Ug,a))});f&&e&&(u=Mb(u,1));a.zb=apc(u.length,b&&0<d||!f&&!b&&e,b&&k);d=rB(a.Hc);for(e=0;e<u.length;e++)for(f=a.zb[e],b=0;b<u[e].length;b++)u[e][b]&&ch(u[e][b])&&(k=IS(d,u[e][b],kW.Y2a),F(a,k),pH(CI(d),k,
!0),cp(k.Ia,"background-color",f),k.setVisible(!0),a.fc.push(k),k=iI(d,u[e][b],kW.X2a,1,0),F(a,k),Fgb(k,f),k.setVisible(!0),a.Tb.push(k))}function bpc(a){Fc(a.fc);Fc(a.Tb);a.fc=[];a.Tb=[];a.zb=[]}r.G_b=function(){this.Sa&&(bpc(this),Zoc(this))};r.Hoa=function(){jW.$.Hoa.call(this);this.Ga=Ga();this.Sa||(Zoc(this),this.Sa=!0)};r.yaa=function(){jW.$.yaa.call(this);Ba(this.Ga)&&500<Ga()-this.Ga&&this.Lb.rc(2789,this.J);this.Ga=null;bpc(this);this.Sa=!1};r.bnb=function(){this.Ia.focus()};
r.Xlb=function(){var a=this.gb(kW.E5);xp(a)?a.focus():this.Ia.nextSibling&&this.Ia.nextSibling.focus()};r.Qkb=function(){var a;if(a=this.V)a=this.V,a.Db("waffle-assistant-feedback-card-hidden")?a=!1:(a.gb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Z.Ia.focus()};r.cub=function(){this.Lb.rc(2255,this.J);Yoc(this,2255)};r.Xg=function(a){a.stopPropagation()};r.VFb=function(){X.Q4.Oc(this)};r.loa=function(a,b){Yoc(this,2257,a,b)};
function Yoc(a,b,c,d){Voc(a,v(function(a){a=new ioc(a,this.ea,this.H&&this.H.Xd(),b,c,d);this.dispatchEvent(a)},a),!1)}
r.H_b=function(a,b){if(b){var c=this.gb(kW.Aga);if(b.Fi())tC.zB(c,b);else{a.qe(b.Xd());GU(a,a.Xd());nT(a,"ready",v(this.E_b,this,a));b=[];try{var d=new cf;d.setContext(a.toJSON());var e=!!B(this.C,14);D(d,3,e);var f=B(this.C,16);D(d,4,f);D(d,5,"ROWS"==(e?"ROWS":"COLS"));D(d,8,0);if(B(this.C,24)){var h=B(this.C,25);D(d,9,h)}for(var k=xT(Bc(this.D,4)),e=0;e<k.length;e++)d.addRange(kh(k[e].rect,k[e].bd));var l=this.Ie.serialize(d);b=sb(Olc(Ea(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
Llc)}catch(m){b=[]}d=this.gb(kW.E5);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),Wl(d,!0));this.H=a;UU(a,c,this.Lb,Rm)}}};r.E_b=function(a){null!==this.oa&&(Ai(yi.getInstance(),this.oa),this.oa=null);this.isDisposed()||(a.Cm()&&(uC(a.Cm(),"onmouseover",v(this.C_b,this)),uC(a.Cm(),"onmouseout",v(this.D_b,this))),this.gc(),Xoc(this))};r.C_b=function(){this.$a=Ga()};r.D_b=function(){Ba(this.$a)&&500<Ga()-this.$a&&this.Lb.rc(2795,this.J);this.$a=null};
function Xoc(a){if(a.eb&&!a.Ld()){var b=a.gb(kW.Aga);if(!a.eb.contains(b)){var c=a.eb;a=new Toc(b,a);Zmb(c,a)}}}function cpc(a){a.Eb&&(a.oa=zi(yi.getInstance(),kj.Ewa),a.Eb=!1);B(a.C,16);var b=Hoc(a.C);b.Ada(UC);var c=gkc(a.D);b.Zh(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function Uoc(a){var b=cpc(a),b=Ioc(b,a.gb("waffle-assistant-card-inner"));(new lU(UC,b.xf())).send(v(a.H_b,a,b));a.F&&Voc(a,v(function(a){var c=this.F,e=b;a=new FC(a.toJSON());var e=new FC(e.toJSON()),f=c.Wi("waffle-assistant-faceted-chart");if(1<f.length){Soc(a);var h=e;Roc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");Ym()||Rm||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Soc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Roc(e);h=xT(Bc(c.J,27));NZa(c.F,h);for(var h=B(c.J,25),k=0;k<f.length;k++){var l=za(c.L[k])?c.L[k]:null,m=h.clone(),p=c.Ga,q=new hf;D(q,1,p);za(l)&&q.ob(l);D(m,7,q);c.F.Yb("dt",encodeURIComponent(JSON.stringify(c.Ie.serialize(m))));
p=new FC(a.toJSON());p.Zh(c.F.toString());m=e.clone();m.Zh(c.F.toString());var u=c,w=p.mc("title");w||(w=Inc(p));q=w+(' when "'+(u.D+('" is "'+(l+'"'))));u=w+(' by "'+(u.D+'"'));q=l?q:u;p.setOption("title",q);m.setOption("title",q);u=new Moc(p,m,0,0,c.Ma,c.Lb,c.ma());c.Za(u);q=f[k];u.ub(q);c.oa.push(u);u=c;w=Inc(p);p=w+(' broken down by "'+(u.D+('" for "'+(l+'"'))));u=w+(' broken down by "'+(u.D+'"'));So(q,l?p:u);c.H=m}Poc(c);c.Ia.style.visibility="visible"},a),!1)}
function Voc(a,b,c){var d=cpc(a);(new lU(UC,d.xf())).send(function(a){a?(a=a.Xd(),c&&d.qe(a),GU(d,a),b(d)):b(null)})}r.getChartType=function(){return this.C.getChartType()};function apc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Vic("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Lb(d,d);return d}function $oc(a,b){return b?Jgc(a,new Jg(a.width,1)):Jgc(a,new Jg(1,a.height))};function dpc(){SI.call(this);this.Sa.push(this);this.oa=this.Ga=!0;this.rb="waffle-assistant-dragged-card"}x(dpc,Ymb);dpc.prototype.contains=function(a){return!!z(this.L,function(b){if(b.element==a)return!0})};dpc.prototype.Lma=function(a){var b=dpc.$.Lma.call(this,a);if(Ym()||Rm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),epc(b,a);return b};
function epc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&Za(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Ml(a);for(c=0;c<a.length;c++)epc(a[c],b)}function Toc(a,b){UI.call(this,a,b)}x(Toc,UI);Toc.prototype.Nma=g("element");function fpc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function lW(a,b){fW.call(this,a,b);this.C=B(a,8)}x(lW,fW);r=lW.prototype;r.yI=pa;r.iG=n("assistantWordCloudFeedback");r.eM=n(2634);r.dM=n(2633);r.qa=function(){lW.$.qa.call(this);gW(this).appendChild(T(fpc));Vo(gW(this),"waffle-assistant-word-cloud-content-container")};
r.JI=function(a){for(var b=Bc(this.C,19),c=Bc(this.C,20),d=this.gb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(gpc(this,b,c,e),120<d.clientHeight){gpc(this,b,c,e-1);break}b=this.ma();c=B(this.C,2);c=fm(b,c);d=this.gb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function gpc(a,b,c,d){var e=a.gb("waffle-assistant-word-cloud-words-container");for(a=a.ma();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(fm(a," "));var l=a.createElement("SPAN");a.appendChild(l,fm(a,b[k]));a.appendChild(e,l);Vo(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function mW(a,b,c,d,e){iW.call(this,20,d,c,e);this.O=a;this.L=b;this.D=new dpc;F(this,this.D);this.F=null;this.H=0}x(mW,iW);r=mW.prototype;r.Ya=function(){mW.$.Ya.call(this);this.D.cf();this.getHandler().R(this.D,"drag",this.B_b).R(this.D,"dragend",this.Vm)};r.x4=n("Analysis");r.Gia=function(a){return 0==a};r.V7=function(a){return"WordCloud"==B(a,8).getChartType()?new lW(a,this.ma()):new jW(a,this.O,this.L,this.Yv(),this.D,this.ma())};r.rf=function(a){mW.$.rf.call(this,a);a&&Gmb(this.D)};
r.eLa=function(a){this.getHandler().Mc(a,"content-rendered",this.A_b);this.H++};r.A_b=function(){0==--this.H&&this.dispatchEvent("De")};r.B_b=function(){this.F=qp(this.D.jd.target)};r.Vm=function(a){var b=this.F,c=rB(this.L).pe();if(Ng(lG(c,"page",!1,!1)).contains(b)){var d=jG(c,b.x,b.y,"page"),c=nG(c,Sg(d),"page"),b=new Bg(b.x-c.left,b.y-c.top);a.C.getData().loa(d,b)}this.F=null};r.Tva=n(2);function hpc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}x(hpc,E);function nW(a,b){oW(a);if(null!=b){var c=rB(a.J),d=c.zd(),d=sb(dc(xg),d.w4,d);b=sb(d,Ea(Ug,b.rect));for(d=0;d<b.length;d++)if(b[d]&&ch(b[d])){var e=IS(c,b[d],a.H);F(a,e);pH(CI(c),e,!0);e.setVisible(!0);a.D.push(e);e=iI(c,b[d],a.F,1,0);F(a,e);e.setVisible(!0);a.C.push(e)}}}function oW(a){Fc(a.D);Fc(a.C);a.D=[];a.C=[]};function ipc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function jpc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(za(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":za(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var kpc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),lpc=[{dk:["Thank you","Thankyou","Thanks"],Yg:"No problem"},{dk:["you are amazing","This is great","omg"],Yg:"Happy to help"},{dk:["I love you"],Yg:"Must be in the air"},{dk:["How do you know","How are you so smart"],Yg:"It's all in the data"},{dk:["Are you sure"],Yg:"Send feedback if this doesn't seem correct to help improve accuracy"},{dk:["How are you"],Yg:"Pretty good, thanks"},
{dk:["Hi","Hello","Hey"],Yg:"Hi, there. Try asking a question about your data."},{dk:["You are stupid","This is dumb","You are wrong"],Yg:"Help improve this experience by sending feedback"},{dk:["How smart are you"],Yg:"Pretty smart"}];function mpc(a){for(var b=0;b<lpc.length;++b)if(-1!=xb(lpc[b].dk,function(b){return Ma(a,b)}))return b;return-1};function pW(a,b,c,d,e,f,h){this.C=a;this.WY=b;this.F=(void 0===h?null:h)||b;this.D=d;this.Mq=c;this.ea=d?Bc(d,6):[];this.oa=d?Bc(d,7):[];this.Z=d?Bc(d,8):[];this.error=e||1;this.interpretation=d&&wc(d,4)?B(d,4):null;this.O=d?Bc(d,12):[];this.Ga=f;this.V=!1;this.L=[];this.J=!1;this.H=null;if(this.D&&wc(this.D,17))if(c=B(this.D,17),this.V=B(c,4)||!1,a=Bc(c,3),b=Bc(c,1),0<a.length)if(0==b.length||1>=this.F.length||1>this.F[0].length)this.L.push("Charts for this question are not supported.");else{for(c=
0;c<b.length;c++)if(yb(a,b[c])){this.J=!0;this.H=b[c];break}null==this.H&&(this.J=!0,this.H=npc(this,b),1==a.length&&6==a[0]||this.L.push("Requested chart type is not supported for this question."))}else 0<b.length&&1<this.F.length&&1<this.F[0].length&&(this.H=npc(this,b),this.J=B(c,2)||!1,20<=this.F.length||3<=this.F[0].length)&&(this.J=!0)}function opc(a){return 1==a.error&&null!=a.Mq}
function ppc(a){return{RN:qpc(a),interpretation:a.interpretation,WY:a.WY,Mq:a.Mq,Q1:1<a.WY.length&&1<a.WY[0].length,xt:a.xt(),QTb:a.V,aHb:a.L}}pW.prototype.xt=function(){var a;if(a=Pm&&null!=this.H)a:switch(this.H){case 2:case 3:case 4:case 5:case 10:case 7:a=!0;break a;default:a=!1}return a&&2<this.F.length};
pW.prototype.getChartType=function(){if(!this.xt())return null;switch(this.H){case 2:return"ColumnChart";case 3:return"LineChart";case 4:return"ScatterChart";case 5:return"PieChart";case 10:return"Histogram";case 7:return"LineChart";default:throw Error("Unknown chart type.");}};function rpc(a){if(!a.D||!wc(a.D,17))return null;var b=B(a.D,17);D(b,2,a.J);return b}function spc(a){a.xt();return a.F[0][0]}function tpc(a){return{RN:qpc(a),error:upc(a)}}
function npc(a,b){if(!Bc(a.D,18).length)return b[0];a=vpc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(yb(b,a[c]))return a[c];return b[0]}function wpc(a,b,c){var d={};null!=b?(d.v=xpc(a,b,c),d.f=b):d.v=null;return d}
function vpc(a){for(var b=new lC,c=a.F[0],d=Mb(a.F,1),e=Bc(a.D,18),f=[],h=0;h<c.length;h++)null!=e[h]&&wc(e[h],1)?f.push(ypc(B(e[h],1))):f.push(0==h?"string":"number"),b.qt({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){for(var h=[],k=0;k<c.length;k++)h.push(wpc(a,d[e][k],f[k]));b.cx(h)}return b}
function xpc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=uIa(a.Ga.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^0-9"+a+"]","g"),""),b=b.replace(a,"."),lb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Ta(a[0])&&Ta(a[1])&&(Ta(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Ta(a[d])&&
(c[d]=lb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function ypc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function zpc(a){if(!wc(a.D,9))return"";if(wc(a.D.getError(),3))switch(B(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.D.getError().Am()||""}
function upc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return zpc(a)||"Sorry, couldn't understand your question.";case 7:return a=mpc(a.C),-1!=a?lpc[a].Yg:""}return""}
function qpc(a){var b=[];if(opc(a)){var c=[];z(Jb(a.ea,a.Z),function(a){c.push(Apc(a,"waffle-assistant-answercard-question-unused-phrase"))});z(a.oa,function(a){c.push(Apc(a,"waffle-assistant-answercard-question-used-entity"))});Qb(c,function(a,b){return a.RV>b.RV?1:-1});var d=0;z(c,function(c){var e=c.length,h=c.RV;h>d?b.push({text:a.C.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.C.substring(h,d),className:c.fk}))});d<a.C.length&&b.push({text:a.C.substring(d),className:null})}else b.push({text:a.C,
className:null});return b}function Apc(a,b){return{RV:B(a,2),length:B(a,3),fk:b}};function qW(a,b,c,d){I.call(this);this.O=a;this.V=b;this.ea=c;this.Sa=d;this.Ra=new J(this);F(this,this.Ra);this.C=new dV;F(this,this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.Z=!1;ulc(this.C,this.O);this.C.oa=10;this.C.mb=!0;this.C.O=!1;this.C.AUa("waffle-assistant-visible");this.C.ea=Ua("waffle-assistant-dragged-formula").split(" ");this.C.cf();this.Ra.R(this.C,"beforedragstart",this.Ga).R(this.C,"dragmove",this.Ma).R(this.C,"beforedragend",this.oa)}x(qW,I);qW.prototype.rf=ca("Z");
qW.prototype.Ga=function(a){a=ob(this.O.childNodes,a.C);this.L=this.J[a]};
qW.prototype.Ma=function(a){var b=a.event instanceof Lp?a.event.kM:a.event;this.Z?(a.J.Mz(b,!0),a.preventDefault()):(ip(a.F,a.event.clientX,a.event.clientY),a=jp(a.F),b=rB(this.V).pe(),Ng(lG(b,"page",!1,!1)).contains(a)?(a=jG(b,a.x,a.y,"page"),(b=vw(fv(this.ea),a.y,a.x))?a=new Bg(b.tc(),b.yc()):b=Sg(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=rB(this.V),G(this.D),this.D=IS(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),pH(CI(a),this.D),G(this.F),this.F=iI(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),Fgb(this.F,"#000"),this.F.setVisible(!0))):Bpc(this))};qW.prototype.oa=function(a){if(this.H){var b=this.H,c=fv(this.ea),b=new DG(c,b,this.L);this.Sa.C(b);this.dispatchEvent(new H("formula_inserted"))}a.J.Mz(null,!0);a.preventDefault();this.L="";Bpc(this)};function Bpc(a){a.H=null;G(a.D);a.D=null;G(a.F);a.F=null};function Cpc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Ht({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function Dpc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Epc({RN:a.eF.RN}),d=a.eF.WY;var e=a.eF.Mq;var f=a.eF.interpretation,h=a.eF.Q1,k=a.eF.xt,l=a.eF.QTb;a=a.eF.aHb;null==d||ta(d);ta(a);var m=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+kr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(m+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');m+='<div class="waffle-assistant-answercard-answer">';if(h){m+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=d[0],f=l.length,p=0;p<f;p++)m+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[p])+"</span>";m+="</div>"}m+='<div class="waffle-assistant-answercard-answer-rows">';l=gr("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(p=0;p<f;p++){var q=d[p];if(h&&0==p)q="";else{var u=l;ta(q);for(var u='<div class="'+W(u)+'">',w=q.length,y=0;y<w;y++)var C=q[y],u=C?u+('<span class="waffle-assistant-answercard-answer-col">'+U(C)+"</span>"):u+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');q=V(u+"</div>")}m+=q}m+="</div></div>"}m+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':""}if(0<a.length){m+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)m+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+"</div>";m+="</div>"}m+='<div class="waffle-assistant-answercard-footer">';k&&(m+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');
m+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(Ht({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+
U(e)+"</div></div></div></div></div></div></div>";e=V(m);return b(c+e+"</div></div>")}
function Epc(a){ta(a.RN);a=a.RN;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+kr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function Fpc(){var a=V;var b=V('<div class="waffle-assistant-answers-card-remove">'+U(Ht({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(U(b))};function Gpc(a){this.Lb=a}function Hpc(a,b){var c=new SV;O(c,3,b);O(c,8,Pra);b=new WS;Sh(b,4,c);c=new Xh;Sh(c,46,b);c=hi(gi(new fi,10),c).build();a.Lb.rc(2753,c)};function Ipc(a,b,c,d,e,f){H.call(this,"sqc");this.V=a;this.J=f||"";this.L=b;this.F=d;this.Z=e;this.C=c}x(Ipc,H);function Jpc(a,b,c,d){var e=new Nnc;O(e,2,c);z(b,function(a){M(e,1).push(a)});O(e,3,d);d=new RV;O(d,1,a);O(d,3,b[c]);Sh(d,11,e);return d}function Kpc(a,b,c,d){var e=new Pnc;O(e,2,c);z(b,function(a){M(e,1).push(a)});O(e,3,d);d=new RV;O(d,1,a);O(d,2,b[c]);Sh(d,10,e);return d}function Lpc(a){var b=new Qnc;z(a,function(a){var c=a.type;M(b,1).push(c);a.JHa&&(a=a.JHa,M(b,2).push(a))});return b}function Mpc(a){var b=new Onc;z(a,function(a){a=a.type;M(b,1).push(a)});return b}
function Npc(a){var b=new Mnc,c=Bc(a,3),d=Bc(a,1);if(0<c.length){for(var e,f=0;f<d.length;f++)if(yb(c,d[f])){e=d[f];break}e||(e=c[0]);O(b,2,e)}for(c=0;c<d.length;c++)e=d[c],M(b,3).push(e);a=B(a,2);O(b,4,a);return b};function rW(a,b,c,d,e,f,h,k,l,m){fW.call(this,new aV,m);this.C=a;this.gc=a.xt();this.Hd=a.xt()&&a.J;this.Tb=a.V;this.Ga=!1;this.eb=b;this.$a=c;this.zb=d;this.fc=l;this.xe=h;this.Lb=e;this.Qc=f;this.Hc=k;this.Od=gi(new fi,10).build();this.Sa=new ks("",new cW,this.ma());this.Za(this.Sa);this.L=null;this.J=new ks("",new bW,this.ma());this.Za(this.J);this.Z=new ks("",new bW,this.ma());this.Za(this.Z);this.oa=new ks("",new cW,this.ma());this.Za(this.oa);this.H=new HT;this.Za(this.H);this.F=null;this.Cc=
vpc(this.C)}x(rW,fW);r=rW.prototype;r.Kla=g("Hc");r.qa=function(){rW.$.qa.call(this);roc(this).appendChild(T(Fpc))};r.Ya=function(){rW.$.Ya.call(this);var a=this.gb("waffle-assistant-answers-card-remove");this.Sa.ub(a);dW(a,"Remove card",0);this.getHandler().Mc(this.Sa,"action",this.O_b).R(this.J,"action",this.CBb).R(this.Z,"action",this.gtb).Mc(this.J,"action",v(this.TPa,this,!0)).Mc(this.Z,"action",v(this.TPa,this,!1))};
r.JI=function(a){gW(this).appendChild(T(Dpc,{eF:ppc(this.C)}));this.J.ub(this.gb("waffle-assistant-answercard-see-formula-link"));this.Z.ub(this.gb("waffle-assistant-answercard-hide-formula-link"));this.L=new qW(this.gb("waffle-assistant-answercard-formula-text-container"),this.eb,this.$a,this.zb);this.L.rf(this.Ld());this.L.J=[this.C.Mq];F(this,this.L);var b=this.gb("waffle-assistant-answercard-formula-text");dW(b,"Click to copy or drag to insert",void 0,"Formula: "+(this.C.Mq+". Click/Press ENTER to copy or drag to insert on to sheet."));
Khc(b,this.Ld());Ff(this.getHandler().Mc(this.L,"formula_inserted",this.LIb),this.gb("waffle-assistant-answercard-formula-text"),dd,this.wsb);Opc(this,!1);if(this.gc){if(this.Tb)Ppc(this),this.Ga=!0;else{this.H.ub(this.gb("waffle-assistant-answercard-tabs"));b=new FT("");b.ub(this.gb("waffle-assistant-answercard-formula-tab"));this.H.Za(b);var c=new FT("");c.ub(this.gb("waffle-assistant-answercard-chart-tab"));this.H.Za(c);this.getHandler().R(this.H,"select",this.KDb).Mc(b,"action",v(this.RPa,this,
0)).Mc(c,"action",v(this.RPa,this,1));this.H.Fw(this.Hd?c:b)}b=this.gb("waffle-assistant-answercard-insert-chart");this.oa.ub(b);Qpc(this);this.getHandler().R(this.oa,"action",this.N_b)}a()};
function Ppc(a){a.F=new VU;var b=a.C.getChartType();D(a.F,1,b);D(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=spc(a.C),D(a.F,3,b),D(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.Cc.qd(0)&&(b=a.Cc.lh(0),D(a.F,3,b),b=1),1==a.Cc.getNumberOfColumns()-b?(b=a.Cc.lh(b),D(a.F,6,b)):D(a.F,6,"Values");else{var b=a.F,c=spc(a.C);D(b,3,c);c=a.C;c.xt();D(b,6,c.F[0][1]||"")}b=Hoc(a.F);b.qe(a.Cc);c=a.gb("waffle-assistant-answercard-chart");b=Ioc(b,c);GU(b,b.Xd());b.setOption("title",
"");UU(b,c,a.Lb,Rm);a.Ga=!0}
r.N_b=function(){if(this.F){var a=Hoc(this.F);a.qe(this.Cc);GU(a,a.Xd());var b=fv(this.$a),c=Iv(b),d=shc(b,c,!1),c=mB(b,d.y),b=nB(b,d.x),d=UZa(this.fc.J),c={oid:null,ar:c,ac:b,x:16,y:16,h:By.height,w:By.width,p:{context:{chartName:"Chart "+(d+1)}}},b=new lf;D(b,2,"0.6");d=this.Cc.toJSON();D(b,1,d);c=new RC($u(this.$a)||0,c,!1,!1,b);QS(c,a);this.eb.dispatchEvent(new FD("objectRequest"));this.zb.C(new AG(this.fc,c));c=this.C.H;a=new Knc;O(a,1,c);c=new SV;Sh(c,11,a);a=new WS;Sh(a,4,c);c=new Xh;Sh(c,
46,a);a=hi(gi(new fi,10),c).build();this.Lb.rc(2874,a)}};r.yI=function(){So(this.Ia,"Answer Card for question: "+this.C.C)};r.$D=If;r.iG=n("assistantAnswersFeedback");r.eM=n(2628);r.dM=n(2627);r.h$=n("Was this answer correct?");r.Ama=n("Correct");r.zma=n("Incorrect");r.WO=g("C");r.rf=function(a){rW.$.rf.call(this,a);this.L&&this.L.rf(a);var b=this.Db("waffle-assistant-answercard-formula-text");b&&Khc(b,a);Qpc(this)};
r.KDb=function(){switch(IT(this.H)){case 0:Rpc(this,!1);break;case 1:Rpc(this,!0);break;default:IT(this.H)}};function Rpc(a,b){Q(a.gb("waffle-assistant-answercard-chart-container"),b);Q(a.gb("waffle-assistant-answercard-answer"),!b);Q(a.gb("waffle-assistant-answercard-formula-holder"),!b);Qpc(a);!a.Ga&&b&&Ppc(a)}function Qpc(a){var b=(a.Tb||1==IT(a.H))&&!a.Ld();a.oa.setVisible(b)}
function Opc(a,b){a.J.setVisible(!b);a.Z.setVisible(b);Q(a.gb("waffle-assistant-answercard-formula"),b);b?a.gb("waffle-assistant-answercard-formula-text").focus():(a.J.Ia.focus(),a.J.nq(!0))}r.O_b=function(){Hpc(this.Qc,!0);this.dispatchEvent(new H("rc"))};r.CBb=function(){Opc(this,!0)};r.gtb=function(){Opc(this,!1)};r.TPa=function(a){var b=new SV;O(b,9,a);a=new WS;Sh(a,4,b);b=new Xh;Sh(b,46,a);b=hi(gi(new fi,10),b).build();this.Lb.rc(2849,b)};
r.RPa=function(a){var b=this.C.H,c=rpc(this.C),d=new Mnc;c&&(d=Npc(c));O(d,1,b);b=new Lnc;Sh(b,1,d);switch(a){case 0:O(b,2,2);break;case 1:O(b,2,1);break;default:O(b,2,0)}a=new SV;Sh(a,10,b);d=new WS;Sh(d,4,a);a=new Xh;Sh(a,46,d);a=hi(gi(new fi,10),a).build();this.Lb.rc(2850,a)};r.LIb=function(){this.Lb.rc(2709,this.Od)};
r.wsb=function(){var a=this.ma().Zb(),b=a.createElement("textarea");b.textContent=this.C.Mq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&sW(this.xe,"Formula copied to clipboard",this.ma())};function Spc(){var a=gr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Ht({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Tpc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(Epc({RN:a.WGa.RN}))+U(Cpc({error:a.WGa.error,showHelp:a.showHelp}))+"</div></div>")}function Upc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function tW(a,b,c,d,e){fW.call(this,new aV,e);this.H=a;this.Z=b;this.L=d;this.oa=c;this.J=new ks("",new cW,this.ma());this.Za(this.J);this.C=new ks("",new bW,this.ma());this.Za(this.C);this.F=new ks("",new bW,this.ma());this.Za(this.F)}x(tW,fW);r=tW.prototype;r.yI=function(){So(this.Ia,"Error Card for question: "+this.H.C)};r.iG=n("assistantAnswersFeedback");r.$D=If;r.Qaa=Hf;r.qa=function(){tW.$.qa.call(this);roc(this).appendChild(T(Fpc))};
r.Ya=function(){tW.$.Ya.call(this);var a=this.gb("waffle-assistant-answers-card-remove");this.J.ub(a);this.F.setVisible(this.L);dW(a,"Remove card",0);this.getHandler().Mc(this.J,"action",this.T_b).Mc(this.C,"action",this.OBb).R(this.F,"action",this.S_b)};
r.JI=function(a){gW(this).appendChild(T(Tpc,{WGa:tpc(this.H),showHelp:this.L}));if(Jm){var b=T(Upc);this.ma().appendChild(this.Ia,b);this.C.ub(this.gb("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.ub(this.gb("waffle-assistant-answers-helpcenter-link"));a()};r.Kla=g("Z");r.WO=g("H");r.OBb=function(){this.C.setVisible(!1);Q(this.gb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new H("trigger_feedback"))};r.T_b=function(){Hpc(this.oa,!1);this.dispatchEvent(new H("rc"))};
r.S_b=function(){P.Ko.Oc()};function Vpc(a){fW.call(this,new aV,a);this.C=this.ma().createElement("div");Ul(this.C,"Previous")}x(Vpc,fW);r=Vpc.prototype;r.yI=function(){So(this.Ia,"Previous questions below")};r.qa=function(){Vpc.$.qa.call(this);Xo(this.Ia,"waffle-assistant-card");Vo(this.Ia,"waffle-assistant-answers-previousheadercard")};r.JI=function(a){0<this.ma().wi(gW(this)).length||gW(this).appendChild(this.C);a()};r.Qaa=Hf;r.iG=n("assistantAnswersFeedback");function Wpc(a){var b=""+((a.d9?U(Cpc({error:a.d9,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c=gr("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.LUb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Ht({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function uW(a,b,c,d,e,f){fW.call(this,a,f);this.C=e||null;this.Z=b;this.F=d;this.oa=c;this.L=this.C?5==this.C.error:!1;this.H=new ks("",new bW,this.ma());this.Za(this.H);this.J=new ks("",new cW,this.ma());this.Za(this.J)}x(uW,fW);r=uW.prototype;r.qa=function(){uW.$.qa.call(this);this.$D()&&roc(this).appendChild(T(Fpc))};
r.Ya=function(){uW.$.Ya.call(this);Vo(this.Ia,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.U_b);if(this.$D()){var a=this.gb("waffle-assistant-answers-card-remove");this.J.ub(a);dW(a,"Remove card",0);this.getHandler().Mc(this.J,"action",this.V_b)}};r.eM=function(){return yb([Xpc,vW],this.F)?2799:yb([Ypc,Zpc],this.F)?2801:null};r.dM=function(){return yb([Xpc,vW],this.F)?2798:yb([Ypc,Zpc],this.F)?2800:null};r.h$=n("Were these interesting?");
r.Ama=n("Interesting");r.zma=n("Not interesting");r.iG=n("assistantAnswersFeedback");r.$D=function(){return this.C?!opc(this.C):!1};r.yI=function(){var a=this.F.title;a&&this.C?So(this.Ia,a+(" for question : "+this.C.C)):So(this.Ia,"Suggested questions")};
r.JI=function(a){var b=this;this.oa.then(function(c){if(0==c.length)Q(b.Ia,!1);else{var d=b.ma(),e=gW(b);if(0==d.wi(e).length){var f=T(Wpc,{title:b.F.title,LUb:sb(c,function(a){return a.query}),d9:b.C?upc(b.C):"",showHelp:b.L});e.appendChild(f);var h=sb(c,function(a){return a.type}),e=b.Wi("waffle-assistant-answercard-question-container");z(e,function(a,e){var f=new ks("",new cW,d);b.Za(f);f.ub(a);b.getHandler().R(f,"action",v(b.wDb,b,c[e],h,e))});b.L&&b.H.ub(b.gb("waffle-assistant-answers-helpcenter-link"))}}a()})};
r.V_b=function(){Hpc(this.Z,!1);this.dispatchEvent(new H("rc"))};r.wDb=function(a,b,c){this.dispatchEvent(new Ipc(this.F.Q3,a.Mq||null,b,c,this.F.tZ,a.query))};r.U_b=function(){P.Ko.Oc()};var $pc={title:"",tZ:0,Q3:null},Xpc={title:"",tZ:5,Q3:1},vW={title:"Suggested questions",tZ:5,Q3:1},Zpc={title:"Did you mean?",tZ:2,Q3:4},Ypc={title:"Related questions",tZ:4,Q3:4};function aqc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function wW(a){return aqc(a,1)[0]}function bqc(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return sb(a[b],function(b,d){return sb(a,function(a){return a[d]})})};function cqc(a){this.F=[];this.D={};this.J=a;this.C=new NN}function dqc(a,b,c,d){function e(a){return a.toLowerCase()}Nb(b,void 0,e);Nb(c,void 0,e);Nb(d,void 0,e);z(b,a.H,a);z(c,a.H,a);z(d,a.H,a)}cqc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function eqc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}cqc.prototype.$H=function(a,b,c){if(Ua(a||"")){var d=this.J.Rm();d=fqc(this,a.substring(0,d));var e=gqc(this,b-d.length,a);d=Jb(d,e)}else d=gqc(this,b);d.length>b&&(d=Mb(d,0,b));c(a,d)};
function gqc(a,b,c){var d=c||"";c=Zb(a.D,function(a){return Ma(a,d)});var e=hqc(dc(c),d?1:2,1);a=rb(a.F,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=hqc(a,b-cc(e),2);b=dc(b);var f=sb(b,function(a,b){a.Jua=b;return a.fWa});z(b,function(a){a.Hua=f});return Jb(b,dc(e))}
function fqc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={iea:h.iea,o2:h.o2,wU:h.wU},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.wU={};h.o2=0;h.iea=f.substr(k);var l=a.C.Ne(h.iea);z(l,function(b){return function(c){var d=c.length-b.iea.length;b.o2=Math.max(d,b.o2);c=a.C.get(c);b.wU[d]||(b.wU[d]=[]);Lb(b.wU[d],c)}}(h));for(l=0;l<=h.o2&&0<d;++l){var m=h.wU[l];if(m)for(var p=0;p<m.length&&0<d;++p){var q=m[p];Za(b.toLowerCase(),q.toLowerCase())||e[q]||(--d,c.push({text:q,Mq:"",
yA:0,bDa:f.length-k,fWa:void 0,Hua:[],Jua:-1}),e[q]=!0)}}}return c}function hqc(a,b,c){b=aqc(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=za(b)?b:b.query;d[e.toLowerCase()]={text:e,Mq:za(b)?"":b.Mq,yA:c,bDa:0,fWa:za(b)?void 0:b.type,Hua:[],Jua:-1}});return d};function xW(){eH.call(this,"",null,!1)}x(xW,eH);xW.prototype.xD=function(a,b){if(2==a.yA||1==a.yA)return xW.$.xD.call(this,a.text,b);var c=this.bb(),d=this.Rm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.bDa)+a.text;e||(f+=" ");a=xW.$.xD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.rk;b.blur();b.focus();this.r3(f.length);return a};
xW.prototype.Sg=function(a){var b=xW.$.Sg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,kfb(b)&&b.FG()&&a.preventDefault(),b=!0);return b};function iqc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Ht({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Ht({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Ht({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function jqc(a){this.xb=a||rl()}
jqc.prototype.pA=function(a,b,c){b=T(iqc);var d=this.xb.gb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.xb.If(d,a.text);var d=this.xb.gb("waffle-assistant-answers-ac-entity-icon",b),e=this.xb.gb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.xb.gb("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.yA);Q(e,2==a.yA);Q(f,1==a.yA);d="";switch(a.yA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Vo(c,d);this.xb.appendChild(c,b)};function yW(a,b,c,d,e,f,h,k,l,m,p){hW.call(this,p);this.nf=c;this.Jg=d;this.Hf=e;this.He=a;this.zb=h;this.Ga=m;this.Sa=this.O=this.J=this.gc=null;this.oa=new xW;this.oa.MHa=!0;this.oa.Ma=!0;this.$a=new cqc(this.oa);a=new cH(null,new jqc(p));this.H=new ZG(this.$a,a,this.oa);F(this,this.H);this.Lb=f;this.mb=this.Ma=this.F=null;this.yb=k;this.Mb=!1;this.rb=gi(new fi,10).build();this.Ie=new gh;this.fc=l;this.ea={};this.V=this.Qc=this.D=this.Hc=null;this.xe=yi.getInstance();this.Tb="";this.eb=null}
x(yW,hW);r=yW.prototype;r.qa=function(){yW.$.qa.call(this);var a=this.H.Ge();a.className="waffle-assistant-answers-ac-renderer";a.$N="waffle-assistant-answers-ac-row";a.X6="waffle-assistant-answers-ac-active";a.kpa="waffle-assistant-answers-ac-highlighted"};r.Ya=function(){yW.$.Ya.call(this);this.oa.C=this.H;this.H.eZ=!1;this.H.Vba=6;this.getHandler().R(this.H,"update",this.Alb);this.mI(null==this.F)};
r.Nsa=function(a,b){yW.$.Nsa.call(this,a,b);b=this.ma();var c=this.Z;b.appendChild(a,T(Spc));this.Qc=b.gb("waffle-assistant-answers-input",a);this.V=b.gb("waffle-assistant-answers-query-box",a);this.J=new ks("",new cW,this.ma());c.Za(this.J);this.J.ub(b.gb("waffle-assistant-answers-clear-query-button",this.V));this.Sa=new tV(!1,"#4285f4");c.Za(this.Sa);this.Hc=b.gb("waffle-assistant-answers-spinner-container",this.V);this.Sa.render(this.Hc);this.D=b.gb("waffle-assistant-answers-input-box",this.V);
zfb(this.oa,this.D);dW(this.J.getElement(),"Clear query");c.getHandler().R(this.V,"submit",v(this.fFb,this)).R(this.V,"focus",v(this.QGa,this,!0),!0).R(this.V,"blur",v(this.QGa,this,!1),!0).R(this.J,"action",v(this.G6a,this)).R(this.D,"input",v(this.VVb,this)).R(this.D,"focus",v(this.FTa,this));this.J.setVisible(!1)};r.j8=function(){Bfb(this.oa,this.D);this.J.setVisible(!1);this.Sa.dispose();this.Sa=null;yW.$.j8.call(this)};
r.mI=function(a){var b=this;if(this.Qc){Q(this.Qc,!a);var c=Fu;c&&c.dispatchEvent("resize")}a?(this.eb&&this.eb.dispose(),this.eb=new xk(function(){yW.$.mI.call(b,a)},300,this),F(this,this.eb),this.eb.start()):(this.eb&&this.eb.stop(),yW.$.mI.call(this,a))};r.yh=ca("gc");
function kqc(a,b,c,d){var e=sb(Bc(c,1),function(a){return a.getName()}),f=[],h=[];z(Bc(c,2),function(a){f.push(a.getName());h=h.concat(Bc(a,2))});dqc(a.$a,e,f,h);lqc(a.He).then(function(a){this.$a.F=a;im(this.ma())==this.D&&this.FTa()},null,a);e=a.F&&a.Ma&&b&&d&&(!a.F.equals(b)||!a.Ma.equals(d));a.F=b;a.Ma=d;a.mb=c;if(e)for(c=sb(a.C,function(a){if(a instanceof rW||a instanceof tW)return a.WO().C}),a.yZ(),d=0;d<c.length;d++)if(e=c[d]){var k=new RV;O(k,1,5);zW(a,k,void 0,e)}a.mI(null==b)}
r.reset=function(){zT(this.ea);zT(this.$a.D);var a=this.$a;a.F=[];a.C.clear();this.O=null};r.Alb=function(a){if(a.row)if(a=a.row,2==a.yA){var b=Jpc(1,a.Hua,a.Jua,2);zW(this,b,a.Mq);this.Lb.rc(2652,this.rb)}else 0==a.yA?(this.Mb=!0,this.Lb.rc(2651,this.rb)):1==a.yA&&(a=new RV,O(a,1,3),zW(this,a))};r.QGa=function(a){Zo(this.V,"waffle-assistant-answers-query-box-focused",a);this.H.Vf()&&!a&&this.H.Nj()};r.VVb=function(){this.J.setVisible(!!ipc(this.D))};
r.FTa=function(){this.H.Gw(this.D);var a=fb(ipc(this.D));this.oa.r3(a.length);hfb(this.H,a||"  ");this.H.update(!0)};
function zW(a,b,c,d){var e=a.Ga.L.Vs();O(b,13,e);e=new SV;Sh(e,5,b);d=d||Ua(ipc(a.D));if(!a.gc||3<=a.gc.getStatus().getState().C)if(a.ea[d])mqc(a,d,!1);else{c=new pW(d,null,null,null,2,a.Ga);nqc(a,c,!0,e);return}else{var f=a.ea[d];f&&f instanceof tW&&2==f.WO().error&&delete a.ea[d]}if(d&&a.F)if(a.ea[d])a.Lb.rc(2681,a.rb),mqc(a,d,!0);else{var f=oqc(),h=Qh(Qh(f,WS,46),SV,4);O(h,2,a.Mb);f=hi(gi(new fi,10),f).build();a.Lb.rc(2635,f);a.Mb=!1;f=yv(a.F.rect);b=tk(Ej(uk(Gj(Hj(a.gc.Xf("/answers/parse").dg("q",
d,"qt",M(b,1),"gid",a.F.bd,"range",f),v(a.Sk,a,d,e)),v(a.P_b,a,d,e)),"POST"),2));Xra&&a.Ma&&(e=0==a.Ma.rect.width||0==a.Ma.rect.height?"":yv(a.Ma.rect),b.dg("headerRange",e));c&&b.dg("sgfml",c);b.jf();a.Tb=zi(a.xe,kj.zwa);pqc(a,!0)}else jpc(a.D,"");a.D.blur();a.J.setVisible(!!d);a.H.Vf()&&a.H.Nj()}function mqc(a,b,c){var d=a.ea[b];d!=nb(a.C)&&(1<a.C.length&&qqc(a),c&&rqc(a,d.WO()).then(function(a){sqc(this,d,a)},null,a),Boc(a,d))}
r.fFb=function(a){a.stopPropagation();a.preventDefault();a=new RV;O(a,1,2);zW(this,a)};r.G6a=function(){jpc(this.D,"");this.J.setVisible(!1)};r.P_b=function(a,b){if(this.F){var c=M(Qh(b,RV,5),1),c=1==c||4==c?Rnc.dBa:Rnc.ABa,d=oqc(),e=Qh(Qh(d,WS,46),SV,4);O(e,1,c);O(b,1,c);c=hi(gi(new fi,10),d).build();this.Lb.rc(2640,c);tqc(this,a,b)}};function tqc(a,b,c){pqc(a,!1);b=new pW(b,null,null,null,3,a.Ga);nqc(a,b,!1,c);uqc(a)}
r.Sk=function(a,b,c){this.F&&this.yb.C.D.De.then(function(){var d=null,e=null,f=!1,h=Qh(b,RV,5),k=M(h,1),l=oqc(),k=1==k||4==k?Rnc.dBa:Rnc.ABa,m=Qh(Qh(l,WS,46),SV,4);O(m,1,k);O(b,1,k);l=hi(gi(new fi,10),l).build();if(c.Pl()){e=this.Ie.ld(VV.Wa(),c.yg());if(f=e.getStatus()){switch(f){case 1:var p=2639;break;case 2:p=2643;break;case 3:p=2644;break;case 4:p=2638;break;case 5:p=2707;break;case 6:p=2706}p&&this.Lb.rc(p,l)}p=B(e,10);O(h,4,p);p=B(e,11);O(h,5,p);wc(e,16)&&(p=B(e,16),O(h,16,p));if(1==f){tqc(this,
a,b);return}if(2==f){e=-1!=vqc(a);h=-1!=mpc(a);f=4;d=Qh(b,RV,5);e?(f=5,O(d,8,2)):h&&(f=7,O(d,8,1));h=new pW(a,null,null,null,f,this.Ga);e?(e=new tW(h,!0,this.fc,!0,this.ma()),wqc(this,h,e,b)):nqc(this,h,!0,b);pqc(this,!1);uqc(this);return}p=wc(e,2)?B(e,2):null;f=!0;if(p){k="";d=xqc(this.yb,p,this.F,!!this.mb&&!!B(this.mb,4));O(h,14,!!d);if(!d){if(m=p.match(/([A-Z]*)\(/)){var q=Qh(Qh(l.C?$h(l.C):null,WS,46),SV,4);O(q,7,m[1]);O(b,7,m[1])}this.Lb.rc(2645,l)}d&&yqc(d)||(l=this.yb,q=this.F,k="="!=p[0]?
"="+p:p,m=zqc(l),q=Aqc(m,q),k=Kxb(l.C,k,m,q.row,q.Dj));l=wc(e,19)?xqc(this.yb,B(e,19)||"",this.F,!!this.mb&&!!B(this.mb,4)):d;d=new pW(a,d,"="!=p[0]?"="+p:p,e,null,this.Ga,l);k&&d.L.push(k);d.xt()&&(p=rpc(d),l=new Mnc,p&&(l=Npc(p)),O(l,1,d.H),Sh(h,15,l))}else wc(e,9)&&(p=e.getError(),d=new pW(a,null,null,e||null,6,this.Ga),l=B(p,2),O(h,6,l),wc(p,3)&&(p=B(p,3),O(h,12,p)))}else this.Lb.rc(2640,l);d||(d=new pW(a,null,null,e||null,4,this.Ga));pqc(this,!1);opc(d)?Bqc(this,d,f,b):nqc(this,d,f,b);uqc(this)},
function(){tqc(this,a,b)},this)};function uqc(a){""!=a.Tb&&(Ai(a.xe,a.Tb),a.Tb="")}function Cqc(a){if(null!=a.Mq)return Ypc;switch(a.error){case 4:case 6:return 0<a.O.length?Zpc:vW;case 5:return vW}return $pc}function oqc(){var a=new SV;O(a,8,Pra);var b=new WS;Sh(b,4,a);a=new Xh;Sh(a,46,b);return a}function vqc(a){return xb(kpc,function(b){return Ma(a,b)})}
function Dqc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.mb&&!!B(a.mb,4),e=xqc(a.yb,e,a.F,f);yqc(e)&&(e={query:B(b[d],1),Mq:B(b[d],2),type:b[d].getType()},wc(b[d],5)&&(e.JHa=B(b[d],5)),c.push(e))}return oi(c)}function Bqc(a,b,c,d){c=new rW(b,a.nf,a.Jg,a.Hf,a.Lb,a.fc,a.zb,c,a.Ga,a.ma());wqc(a,b,c,d)}function nqc(a,b,c,d){c=new tW(b,c,a.fc,!1,a.ma());wqc(a,b,c,d)}
function wqc(a,b,c,d){qqc(a);var e=rqc(a,b,d);Eqc(a,c);Fqc(a);opc(b)&&eqc(a.$a,b.C);e.then(function(a){if(d){var b=oqc(),e=Qh(b,WS,46);Sh(e,4,d);b=hi(gi(new fi,10),b).build();this.Lb.rc(2781,b)}sqc(this,c,a)},null,a);c.Kla()&&(a.ea[b.C]=c);a.getHandler().R(c,"rc",a.eNa)}function sqc(a,b,c){b instanceof tW&&null!=c&&xp(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().R(c,"rc",a.eNa))}function qqc(a){Gqc(a);z(a.C,function(a){a instanceof tW&&(a=a.getElement(),Q(a,!0))});Hqc(a)}
function Hqc(a){0!=a.C.length&&(a.O?Boc(a,a.O):(a.O=new Vpc(a.ma()),Eqc(a,a.O)))}function Gqc(a){z(a.C,function(b){b instanceof rW||b instanceof tW||b==a.O||a.YH(b)})}
function rqc(a,b,c){var d=Cqc(b),e=null;d==Ypc||d==Zpc?0<b.O.length&&(e=Dqc(a,b)):d==vW&&(e=Iqc(a.He));var f=null;return e?(f=new uW(new aV,a.fc,e,d,b,a.ma()),Eqc(a,f),a.Lb.rc(2769,a.rb),a.getHandler().R(f,"sqc",v(a.vDb,a)),e.then(function(a){if(c){var b=Qh(c,RV,5);yb([Ypc,Zpc],f.F)?(a=Lpc(a),Sh(b,7,a)):yb([Xpc,vW],f.F)&&(a=Mpc(a),Sh(b,9,a))}return f},null,a)):oi(f)}
r.vDb=function(a){jpc(this.D,a.J);this.D.focus();var b=a.V,b=1==b?Jpc(b,a.C,a.F,3):Kpc(b,a.C,a.F,a.Z);zW(this,b,a.L);this.Lb.rc(2762,this.rb)};function pqc(a,b){Q(a.Hc,b);Q(a.ma().gb("waffle-assistant-answers-button-container",a.V),!b);a.Sa&&a.Sa.setActive(b)}function Eqc(a,b){b.rf(a.Ld());a.C.push(b);a.gf&&(a.L.ji(b,0,!0),b.hR());toc(b,!0)}function Fqc(a){for(var b=a.C;5<b.length;)a.YH(b[0])}r.yZ=function(){yW.$.yZ.call(this);this.reset()};
r.eNa=function(a){var b=this,c=this.ma();a=a.target;if(a instanceof rW)this.YH(a),sW(this.zb,"Answer removed",c,v(this.sAb,this,a));else if(a instanceof tW)this.YH(a),sW(this.zb,"Card removed",c);else if(a instanceof uW&&a.C&&!opc(a.C)){var d=a.C.C;z(this.C,function(a){a instanceof tW&&a.WO().C==d&&(b.YH(a),sW(b.zb,"Card removed",c))})}a=this.C;!this.O||a[0]!=this.O&&a[a.length-1]!=this.O||(this.YH(this.O),this.O=null)};
r.sAb=function(a){Bqc(this,a.WO(),a.Kla());sW(this.zb,"Remove answer undone",this.ma())};r.YH=function(a){if(a.Dc()){if(a instanceof rW||a instanceof tW)delete this.ea[a.WO().C],a==nb(this.C)&&Gqc(this);yW.$.YH.call(this,a)}G(a)};function Jqc(){var a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Ht({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+kr("Ask a question about your data")+'" /></div></form></div>');return V(a)};function Kqc(a,b){this.C=a;this.D=b}function xqc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=zqc(a);c=Aqc(e,c);(a=Bnc(a.C,b,e,c.row,c.Dj))&&d&&a.length<a[0].length&&(a=bqc(a));return a}function yqc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function zqc(a){a=$u(a.D);return null!=a?a.toString():"0"}
function Aqc(a,b){var c={row:0,Dj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Sc()+1?c.row=b.Sc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Yc()+1&&(c.Dj=b.Yc()+1));return c};function Lqc(a){var b=[];if(wc(a,25)&&(a=B(a,25)))for(var c=0;c<xc(a,1);c++){var d=B(a,1,c);if(wc(d,2)){var e=B(d,2);e&&b.push(Mqc(e,Nqc(d)))}}return b}function Oqc(a){var b=Lqc(a);wc(a,6)&&(a=B(a,6))&&b.push(Mqc(a,0));return b}function Nqc(a){return(a=wc(a,4)?B(a,4):0)?a:0}function Mqc(a,b){return{name:a,A4a:b}};function Pqc(a,b,c){this.oa=a;this.Ga=b;this.D=[];this.F=[];this.L=[];this.O=[];this.V=[];this.Z=[];this.C=new $f;this.J=new $f;this.ea=new $f;this.H=new $f;Qqc(this,c)}function Rqc(a,b){return ag(a,b)?a.get(b).values.Ad():[]}
function Qqc(a,b){for(var c=new eg,d=new eg,e=0;e<b.length;e++){for(var f=Oqc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(ag(a.oa,m)){var p=a.oa.get(m);c.add(p);h.push(p)}ag(a.Ga,m)&&(m=a.Ga.get(m),d.add(m),k.push(m))}Sqc(a,h,k)}a.D=c.Ad();a.F=d.Ad();Qb(a.D);Qb(a.F);a.L=sb(a.C.Ad(),function(a){return a.key});Qb(a.L);a.O=sb(a.J.Ad(),function(a){return a.key});Qb(a.O);a.V=sb(a.ea.Ad(),function(a){return a.key});Qb(a.V);a.Z=sb(a.H.Ad(),function(a){return a.key});Qb(a.Z)}
function Sqc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)AW(a.C,b[d],b[e]),AW(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)AW(a.J,b[d],c[e]),AW(a.ea,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)AW(a.H,c[b],c[d]),AW(a.H,c[d],c[b])}function AW(a,b,c){var d;ag(a,b)?d=a.get(b).values:d=new eg;d.add(c);a.set(b,{key:b,values:d})};function Tqc(a,b){this.C=a;for(var c=new $f,d=0;d<xc(a,2);d++)c.set(a.Kd(d).getName().toLowerCase(),d);this.O=c;c=new $f;for(d=0;d<xc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.oa=c;c=[];for(d=0;d<xc(a,2);d++)BW(a.Kd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<xc(a,1);d++)BW(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<xc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Uqc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Uqc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ga=
c;this.ea=Vqc(a,0);this.V=Vqc(a,1);c=[];for(d=0;d<xc(a,2);d++).8<=B(a.Kd(d),6)&&c.push(d);this.Z=c;c=[];for(d=0;d<xc(a,2);d++)e=a.Kd(d),.95<=Bc(e,2).length/B(e,8)&&c.push(d);this.Sa=c;c=[];for(d=0;d<xc(a,3);d++)f=a.Kd(B(a,3,d)),e=Bc(f,2).length/B(f,8),f=xc(f,3)/xc(f,2),.5<e||.3>f||c.push(B(a,3,d));this.Ma=c;this.F=Wqc(xc(a,2));this.H=Wqc(xc(a,1));this.D=new Pqc(this.O,this.oa,b)}function Wqc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Vqc(a,b){for(var c=[],d=0;d<xc(a,2);d++)a.Kd(d).getType()==b&&c.push(d);return c}function Xqc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Yqc(c,a[d]);for(a=0;a<b.length;a++)d=Yqc(c,b[a]),c=0<d.length?d:c;return 0<c.length?c[wW(c.length)]:-1}function CW(a,b,c,d,e,f){var h=[a.J,a.D.D],k=[a.F];b&&(k.push(a.ea),k.push(a.Z));c&&k.push(a.Ma);d&&k.push(a.Sa);null!=f&&-1!=f?h.push(Rqc(a.D.J,f)):e&&h.push(a.D.O);return Xqc(k,h)}
function DW(a,b,c){var d=[a.L,a.D.F],e=[a.H];b&&e.push(a.Ga);c&&d.push(a.D.V);return Xqc(e,d)}function Zqc(a,b){for(var c=5;;){var d=a.C.Kd(b),e=wW(xc(d,2));c--;if(BW(QV(d,e))||0==c)return e}}function $qc(a,b){for(var c=5;;){var d=a.C.Kd(b),e=wW(xc(d,3)),e=B(d,3,e);c--;if(BW(QV(d,e))||0==c)return e}}function EW(a,b){b=a.C.Kd(b);a=b.getName();BW(a)||(b=arc(Bc(b,7)),a=null==b?a:b);return a}function FW(a,b){b=B(a.C,1,b);a=b.getName();BW(a)||(b=arc(Bc(b,2)),a=null==b?a:b);return a}
function arc(a){for(var b=0;b<a.length;b++)if(BW(a[b]))return a[b];return null}function BW(a){return null==a?!1:50>=a.length}function brc(a){for(var b=aqc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Yqc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Uqc=["average","total","sum","mean","median"];function crc(a,b){this.C=[];this.F=[];this.H=this.V=this.J=this.D=null;this.O=new eg;this.L=new eg;this.Z=a;this.Lb=b;this.ea=gi(new fi,10).build()}crc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.L=new eg;this.O=new eg};crc.prototype.yh=ca("H");function lqc(a){return vra&&a.D?a.D.then(function(){return this.F.slice()},null,a):oi(a.C.slice())}function drc(a){Qb(a,function(a,c){return c.weight-a.weight});return sb(a,function(a){return a.Iua})}
function erc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}function GW(a,b,c,d,e){e=Math.pow(Math.random(),1/(erc(d)*(void 0===e?1:e)));a.L.contains(c)||(b.push({Iua:{query:c,Mq:void 0,type:d},weight:e}),a.O.add(d),a.L.add(c))}
function HW(a,b){return!a.O.contains(b)}function Iqc(a){return lqc(a).then(function(a){return 3>=a.length?a:Mb(a,0,3)},null,a)}function frc(a,b){var c=[];b=Lqc(b);for(var d=0;d<b.length&&-1!=a.oa.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function grc(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=hrc;break a;case 4:a=irc;break a}a=jrc}return a[wW(a.length)]}
function krc(a){var b=null;a.D=new mi(function(a){if(!this.H||3<=this.H.getStatus().getState().C)this.F=this.C,a();var c=yv(this.J.rect),e=sb(this.C,function(a){return a.query});b=uk(tk(Ej(Gj(Hj(this.H.Xf("/answers/parsesuggestions").dg("gid",this.J.bd,"range",c),v(function(b){lrc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.Lb.rc(2833,this.ea);this.F=this.C;a()},this)).setContent(["queries",Jh(e)]).setTimeout(2E3),1)),"POST").jf()},a);ti(a.D,function(){b&&b.dispose()})}
function lrc(a,b){return a.Z.C.D.De.then(function(){var a=[];if(b.Pl())for(var d=b.yg(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.V&&!!B(this.V,4),f=xqc(this.Z,d[e],this.J,f),f=yqc(f);f&&(this.C[e].Mq=d[e],a.push(this.C[e]))}this.F=a},function(){this.F.length=0},a)}var mrc="Minimum Maximum Most Least Highest Lowest".split(" "),nrc=["Top","Bottom"],jrc=["Average","Median"],hrc=["Total","Average","Median"],irc=["Median"],orc=["before","after"];function IW(a,b,c,d,e,f,h,k){iW.call(this,1,f,e,k);this.yb=c;this.oa=null;this.ea=new ks("",new bW,this.ma());this.Za(this.ea);this.Ga=new ks("",new bW,this.ma());this.Za(this.Ga);a=new Hxb(a,!0,!0);a=new Kqc(a,c);this.mb=new Gpc(e);this.O=new crc(a,e);this.L=new yW(this.O,0,b,c,d,e,this.eb,a,this.mb,h,k);c=prc;this.D=new hpc(b,c.r0a,c.s0a);F(this,this.D);this.F=this.H=null;this.rb=gi(new fi,10).build()}x(IW,iW);
var prc={r0a:"waffle-assistant-answers-styled-border",s0a:"waffle-assistant-answers-styled-rect",D0a:"waffle-assistant-answers-input-box",$1a:"waffle-assistant-answers-query-box",Src:"waffle-assistant-answers-query-box-focused",S0a:"waffle-assistant-answers-learn-more",Lmc:"waffle-assistant-answers-logging-message-container",F1a:"waffle-assistant-answers-logging-opt-out"};r=IW.prototype;r.qa=function(){IW.$.qa.call(this);var a=T(Jqc);this.ma().appendChild(Coc(this),a)};
r.Ya=function(){IW.$.Ya.call(this);var a=prc,b=this.gb(a.$1a),c=this.gb(a.D0a);this.Ga.ub(this.gb(a.F1a));this.ea.ub(this.gb(a.S0a));this.getHandler().R(b,"focus",this.Izb,!0).R(b,"blur",this.Gzb,!0).R(b,"mouseover",this.Kzb).R(b,"mouseout",this.Jzb).R(b,"click",this.Hzb).R(c,"input",this.Q_b).R(this.Ga,"action",this.eyb).R(this.ea,"action",this.Mub).R(dv(this.yb),"Ta",Thc(this.R_b,25,this));this.setVisible(null!=this.H);qrc(this,ura&&xra&&Vm("showAnswersLoggingOptOut"))};r.kVa=Hf;r.VNa=If;
r.Rta=Hf;r.x4=n("Answers");r.Tva=n(1);r.Gia=function(a){return 3==a||0==a};r.Sva=function(a,b){Qb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Cc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,f=0==B(d,11)?GS(B(d,10)):null,0<xc(d,4)?rrc(this,GS(B(d,4,0)),B(d,9),f,c):rrc(this,e,B(d,9),f,c),this.F||(IW.$.Sva.call(this,a,b),this.getHandler().R(this.F,"sqc",this.uDb))):this.jW(!0)};
r.V7=function(a){if(!this.F){var b=Iqc(this.O);this.F=new uW(a,this.mb,b,Xpc,void 0,this.ma())}return this.F};r.TDa=g("L");r.$oa=function(){return this.tb()};
r.jW=function(a,b,c){this.O.reset();(a||b)&&this.F&&(IW.$.jW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(IW.$.jW.call(this,a,b,c),this.F.dispose(),this.F=null),this.Dc()&&(this.O.reset(),this.H=null,a=this.L,a.Dc()&&(b=a.$a,b.F=[],b.C.clear(),a.D&&jpc(a.D),a.yZ(),a.F=null,a.mI(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Mb=!1),this.setVisible(!1),this.kc()&&oW(this.D));c&&this.L.reset()};r.yh=function(a){this.oa=a;this.L.yh(a);this.O.yh(a)};
r.setActive=function(a){IW.$.setActive.call(this,a);a?nW(this.D,this.H):oW(this.D)};function src(a,b){a.kc()&&(b?oW(a.D):nW(a.D,a.H))}function qrc(a,b){Q(a.gb("waffle-assistant-answers-logging-message-container"),b)}function trc(a,b){a=a.gb("waffle-assistant-answers-query-box");Zo(a,"waffle-assistant-answers-query-box-focused",b)}r.R_b=function(){this.kc()&&nW(this.D,this.H)};r.Izb=function(){trc(this,!0);nW(this.D,this.H)};r.Gzb=function(){trc(this,!1);this.kc()||oW(this.D)};
r.Kzb=function(){nW(this.D,this.H)};r.Jzb=function(){this.kc()||oW(this.D)};r.Hzb=function(){urc(this,"")};r.Q_b=function(){var a=this.gb("waffle-assistant-answers-input-box");urc(this,a.value);a.value=""};r.uDb=function(a){var b=this;urc(this,a.J);var c=Jpc(1,a.C,a.F,1),d=new xk(function(){zW(b.L,c,a.L)},300);F(this,d);d.start();this.Yv().rc(2652,this.rb)};function urc(a,b){a.setActive(!0);a.dispatchEvent("He");var c=new xk(function(){var c=a.L;jpc(c.D,b);c.D.focus()},300);F(a,c);c.start()}
function rrc(a,b,c,d,e){var f=c||new YU;a.H=b;var h=a.O,k=e;h.reset();var k=wra?k:[],l=[],m=new Tqc(f,k);if(wra)for(var p=k,q=0;q<p.length;q++){var u=p[q];switch(u.getChartType()){case "BarChart":var w=h,y=m,C=l;if(HW(w,13)||HW(w,2)){var K=B(u,6);if(K&&-1!=y.O.get(K.toLowerCase(),-1)){var N=frc(y,u);1<N.length&&(Pm&&HW(w,23)?GW(w,C,"Scatter chart of "+N[0].name+" vs "+N[1].name,23,2):HW(w,2)&&GW(w,C,"Correlation of "+N[0].name+" and "+N[1].name,2,1.5))}}break;case "ScatterChart":var R=h,Z=l,ha=frc(m,
u);1<ha.length&&(Pm&&HW(R,23)?GW(R,Z,"Scatter chart of "+ha[0].name+" vs "+ha[1].name,23,2):HW(R,2)&&GW(R,Z,"Correlation of "+ha[0].name+" and "+ha[1].name,2,1.5));break;case "PieChart":for(var ia=h,na=l,wa,xa=[],Pa=Lqc(u),eb=0;eb<Pa.length&&-1!=m.O.get(Pa[eb].name.toLowerCase(),-1);eb++)xa.push(Pa[eb]);wa=xa;1==wa.length&&4==wa[0].A4a&&(Pm&&HW(ia,20)?GW(ia,na,"Bar chart of distribution of "+wa[0].name,20,2):HW(ia,14)&&GW(ia,na,"Distribution of "+wa[0].name,14,1.5))}}if(HW(h,1)){var Sa=m.C,Ja=DW(m,
!1,!0),pb=CW(m,!0,!1,!0,!0,Ja);if(-1!=pb&&-1!=Ja){var Xb=10<=xc(Sa.Kd(pb),2)?"5 ":"",ad=EW(m,pb),zd=FW(m,Ja);ad!=zd&&GW(h,l,nrc[wW(nrc.length)]+Xb+ad+" by "+zd,1)}}if(HW(h,2)&&1<xc(m.C,1)){a:if(2>m.H.length)var yf=[-1,-1];else{var fe=Xqc([m.H],[m.L,m.D.F,m.D.Z]);if(-1!=fe){var Eb=Rqc(m.D.H,fe);if(0<Eb.length){var ge=[fe],me=wW(Eb.length);ge.push(Eb[me]);yf=ge;break a}}yf=brc(2<=m.L.length?m.L:m.H)}var tc=yf,sd=FW(m,tc[0]),ne=FW(m,tc[1]);sd!=ne&&GW(h,l,"Correlation of "+sd+" and "+ne,2)}if(HW(h,3)){var Gk=
m.C,vj=DW(m,!0);-1!=vj&&GW(h,l,grc(Bc(B(Gk,1,vj),3))+" of "+FW(m,vj),3)}if(HW(h,5)){var wj=m.C,Hk=DW(m,!0,!0),hl=CW(m,!0,!0,!1,!0,Hk);if(-1!=Hk&&-1!=hl){var Xp=FW(m,Hk),Yp=wj.Kd(hl),qr=EW(m,hl);if(0<xc(Yp,3)&&qr!=Xp){var rr=$qc(m,hl);GW(h,l,grc(Bc(B(wj,1,Hk),3))+" of "+Xp+" when "+qr+" is "+QV(Yp,rr),5)}}}if(HW(h,9)){var Tl=DW(m,!1,!0),Ku=CW(m,!0,!1,!0,!0,Tl);if(-1!=Ku&&-1!=Tl){var En=FW(m,Tl),il=EW(m,Ku);il!=En&&GW(h,l,il+" with "+mrc[wW(mrc.length)]+" "+En,9)}}if(HW(h,10)&&0<xc(m.C,1)){var Zp=FW(m,
DW(m));GW(h,l,mrc[wW(mrc.length)]+" "+Zp,10)}if(HW(h,11)){var Lu=m.C,Oo=CW(m,!0,!0,!1,!1,-1);if(-1!=Oo){var Mu=EW(m,Oo);0<xc(Lu.Kd(Oo),3)&&GW(h,l,"Most frequent "+Mu,11)}}if(HW(h,12)){var sr=m.C,rk=DW(m,!0);a:{if(1==m.V.length){var $p=m.V[0];if(!B(m.C.Kd($p),5)){var fF=$p;break a}}fF=-1}var Fn=fF;if(-1!=Fn&&-1!=rk){var gF=FW(m,rk),kx=sr.Kd(Fn);if(0<xc(kx,2)){var Bb=Zqc(m,Fn);GW(h,l,grc(Bc(B(sr,1,rk),3))+" of "+gF+" "+orc[wW(orc.length)]+" "+QV(kx,Bb),12)}}}if(HW(h,15)){var KS=m.C,fq=DW(m,!0),uB=CW(m,
!1,!0,!1,!0,fq);if(-1!=fq&&-1!=uB){var hL=FW(m,fq),LS=EW(m,uB);if(LS!=hL){var jt=KS.Kd(uB);if(2<=xc(jt,3)){var iL=aqc(xc(jt,3),2);GW(h,l,"Compare "+grc(Bc(B(KS,1,fq),3))+" "+hL+" for "+LS+" "+QV(jt,B(jt,3,iL[0]))+" and "+QV(jt,B(jt,3,iL[1])),15)}}}}if(HW(h,16)){var vF=CW(m,!0,!0,!1,!1);if(-1!=vF){var MS=EW(m,vF);GW(h,l,"List unique values in "+MS,16)}}if(HW(h,17)){var jL=m.C,kL=CW(m,!0,!0,!1,!1);if(-1!=kL){var wF=jL.Kd(kL),lL=EW(m,kL);if(!(1>xc(wF,3))){var Yu=$qc(m,kL);GW(h,l,"What percentage of "+
lL+" is "+QV(wF,Yu),17)}}}if(HW(h,13)){var vB=m.C,wr=DW(m,!0,!0),mL=CW(m,!0,!0,!1,!0,wr);if(-1!=wr&&-1!=mL){var Dx=FW(m,wr),xF=EW(m,mL);xF!=Dx&&GW(h,l,grc(Bc(B(vB,1,wr),3))+" of "+Dx+" by "+xF,13)}}if(Pm&&HW(h,18)){var yF=DW(m);-1!=yF&&GW(h,l,"Histogram of "+FW(m,yF),18,2)}var kt=3>l.length;if((kt||0==wW(5))&&HW(h,7)){var nL=m.C,wB=DW(m,!1,!0),xr=CW(m,!1,!1,!1,!0,wB);if(-1!=xr&&-1!=wB){var oL=nL.Kd(xr),xB=EW(m,xr),NS=FW(m,wB);if(0<xc(oL,2)&&xB!=NS){var OS=Zqc(m,xr);GW(h,l,"Show "+NS+" for "+xB+" "+
QV(oL,OS),7)}}}if((kt||0==wW(5))&&HW(h,8)){var pL=m.C;a:if(2>m.F.length)var Ex=[-1,-1];else{var qL=[m.J,m.D.D,m.D.L],yB=[m.F];yB.push(m.ea);yB.push(m.Z);var Fx=Xqc(yB,qL);if(-1!=Fx){var gq=Rqc(m.D.C,Fx);if(0<gq.length){var Gx=[Fx],Em=wW(gq.length);Gx.push(gq[Em]);Ex=Gx;break a}}var Hx=brc(2<=m.J.length?m.J:m.F);Hx[0]!=Fx&&(Hx[1]=Hx[0],Hx[0]=Fx);Ex=Hx}var A2=Ex,eha=A2[0];if(1<xc(pL,2)&&-1!=eha){var PS=A2[1],fha=pL.Kd(PS),B2=EW(m,PS),gha=EW(m,eha);if(0<xc(fha,2)&&B2!=gha){var ACa=Zqc(m,PS);GW(h,l,"What is "+
gha+" where "+B2+" is "+QV(fha,ACa),8)}}}h.C=drc(l);h.J=b;h.V=f;vra&&krc(h);a.setVisible(null!=b);kqc(a.L,b,f,d);a.kc()&&nW(a.D,a.H)}r.eyb=function(a){a.stopPropagation();a.preventDefault();this.oa&&(uk(Gj(Hj(this.oa.Xf("/answers/logoptout"),v(this.Avb,this)),v(this.zvb,this)),"POST").jf(),this.Yv().rc(2663,this.rb))};r.Mub=function(a){a.stopPropagation();a.preventDefault();Do("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};
r.Avb=function(a){a.Pl()&&qrc(this,!1)};r.zvb=ba();function vrc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+wrc()+"</div>");return V(a)}
function xrc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+wrc()+"</div>")}function wrc(){var a=""+U(rs({Je:"waffle-assistant-formatting-edit-button",content:gr("Edit"),style:4}));return V(a)};function yrc(a,b,c){fW.call(this,a,c);a=sb(Bc(this.D,7),kic);this.C=new ST(!1,a,7);this.Za(this.C);this.J=new ss("",this.ma());this.Za(this.J);this.Lb=b;this.H=!1;this.F=-1}x(yrc,fW);var zrc={vfa:"waffle-assistant-banding-color-picker-container",Ffa:"waffle-assistant-formatting-edit-button",GJ:"waffle-assistant-banding-range"};r=yrc.prototype;r.qa=function(){yrc.$.qa.call(this);gW(this).appendChild(T(vrc))};
r.Ya=function(){yrc.$.Ya.call(this);this.getHandler().R(this.J,"action",this.Lqb).R(this.C,"banding-scheme-changed",this.Slb);this.Lb.C(2768)};r.JI=function(a){var b=this.gb(zrc.vfa);this.C.render(b);qic(this.C);var b=this.gb(zrc.GJ),c=B(this.D,4,0),d=mh(c);Ul(b,yv(d));Arc(this,c);b=this.gb(zrc.Ffa);this.J.ub(b);a()};r.yI=function(){So(this.Ia,"Suggested alternating background colors");Bq(this.C,"Choose a color scheme")};r.iG=n("assistantBandingFeedback");r.eM=n(2672);r.dM=n(2671);
r.Lqb=function(a){rn.dispatchEvent({type:"show-banding-pane-recommendation",lTa:this.D,I7a:ric(this.C)});a.stopPropagation()};r.Slb=function(a){if(!this.H&&TT(this.C)){var b=this.F;this.F=this.C.Oh();this.F==b?this.dispatchEvent(new aW("Ge",this,2797)):this.dispatchEvent(new aW("ze",this,2673));a.stopPropagation()}};
function Arc(a,b){a.H=!0;var c=b.Fb();b=mh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.yc(),b.tc(),b.Sc(),b.Yc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new gh).ld(vd.Wa(),c),c=kic(c)):c=null;c?(c=sic(a.C,c),II(a.C,c?c.getElement():null)):II(a.C,null);a.F=a.C.Oh();a.H=!1};function Brc(a,b){fW.call(this,a,b);this.C=new ss("",this.ma());this.Za(this.C);this.yb=Bc(a,6)}x(Brc,fW);var JW={Ffa:"waffle-assistant-formatting-edit-button",c0a:"waffle-assistant-conditionalformat-format-preview",v2a:"waffle-assistant-conditionalformat-rule-holder",b5:"waffle-assistant-conditionalformat-description",C1a:"one-rule",x3a:"two-rules",k3a:"three-rules",U1a:"waffle-assistant-conditionalformat-format-preview-label"};r=Brc.prototype;r.qa=function(){Brc.$.qa.call(this);gW(this).appendChild(T(xrc))};
r.Ya=function(){Brc.$.Ya.call(this);var a=this.gb(JW.Ffa);this.C.ub(a);dW(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.olb)};r.JI=function(a){Ul(this.gb(JW.b5),Cc(this.D,3));var b=this.gb(JW.v2a),c=new Crc(this,this.ma());this.Za(c);c.ub(b);dW(b,"Apply conditional format rules");a()};r.yI=pa;r.iG=n("assistantConditionalFormatFeedback");r.eM=n(2630);r.dM=n(2629);
r.olb=function(){this.dispatchEvent(new aW("Ae",this,2563));this.dispatchEvent(new aW("Ce",this,2670,void 0,void 0,mh(B(this.yb[0],1,0))));vn()};function Crc(a,b){yq.call(this,void 0,void 0,b);this.C=a}x(Crc,yq);
Crc.prototype.re=function(a){Crc.$.re.call(this,a);var b=this.C.yb;switch(b.length){case 0:break;case 1:var c=JW.C1a;break;case 2:case 4:c=JW.x3a;break;default:c=JW.k3a}for(var d=0;d<b.length;d++){var e=b[d],f=Cl("DIV");Wo(f,[JW.c0a,c]);var h=Cl("DIV");Vo(h,JW.U1a);f.appendChild(h);Ul(h,"123");if(wc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=Bc(B(k,1),2)[0],l=Bc(e,1)[0];Ul(h,wz(k,Cc(l,1),Cc(l,2),Cc(l,4)))}}yhc(e,f);a.appendChild(f)}};
Crc.prototype.Gi=function(){var a=this.C;a.dispatchEvent(new aW("Ae",a,2563));return!0};function Drc(a,b,c){iW.call(this,2,b,a,c)}x(Drc,iW);r=Drc.prototype;r.x4=n("Formatting");r.Gia=function(a){return 2==a||4==a};r.V7=function(a){var b=B(a,1);switch(b){case 2:return new Brc(a,this.ma());case 4:return a=new yrc(a,this.Yv(),this.ma()),this.getHandler().R(a,"ze",this.rTb).R(a,"Ge",this.mGb),a;default:throw Error("Unsupported recommendation type: "+b);}};r.rTb=function(a){sW(this.eb,"Alternating colors applied",this.ma(),v(this.Tlb,this,a.C))};r.mGb=function(){this.eb.clear()};
r.Tlb=function(a){this.dispatchEvent(new aW("Ke",a,2796))};r.rf=function(a){Drc.$.rf.call(this,a);this.setVisible(!a)};r.Uva=function(a){return this.Ld()?(this.setVisible(!1),a):Drc.$.Uva.call(this,a)};r.Tva=n(3);function Erc(){var a=""+('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper">Data Range'+U(iic({$aa:!0}))+'</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div><div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"/></div>');
a=V(a);return V(""+('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">Edit data range</div></div><div class="waffle-tables-popup-content">'+a+'</div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">Update</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">Cancel</div></div></div></div>'))}
function Frc(a){a='For <span class="waffle-assistant-table-bar-range">'+(U(a.XUb)+"</span>");return V(""+a)};function Grc(a,b,c){var d=a.Sc(),e=a.Yc();switch(b){case 0:d=Math.min(d,a.yc()+c);break;case 1:e=Math.min(e,a.tc()+c)}return hh(a.Fb(),a.yc(),a.tc(),d,e)};function KW(a,b,c,d,e,f){S.call(this);this.J=a;this.Ma=b;this.$a=c;this.Ga=d;this.Sa=e;this.H=d;this.F=e;this.oa=f;a=mh(d);this.D=yv(a);this.ea=new ks("",new cW,this.ma());this.Za(this.ea);this.Z=new ks("",new cW,this.ma());this.Za(this.Z);this.V=0;this.C=null;this.L=new hpc(b,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");F(this,this.L);this.O=new hpc(b,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");F(this,this.O)}x(KW,S);r=KW.prototype;
r.qa=function(){KW.$.qa.call(this);this.Ia=T(Erc)};
r.Ya=function(){KW.$.Ya.call(this);this.ea.ub(this.gb("waffle-tables-popup-done"));this.Z.ub(this.gb("waffle-tables-popup-cancel"));var a=this.gb("waffle-range-selection-input");a.focus();this.getHandler().R(this.Ia,"keydown",this.g0b).R(a,"keyup",this.h0b).R(a,Zba,this.SDb).R(this.J.C,"ba",this.dispose).R(this.ea,"action",this.FNa).R(this.Z,"action",this.dispose).R(this.Ma,"selectionChange",this.i0b);zD(this.J,"selection-input");Hrc(this);Irc(this);this.dispatchEvent("tablepopupopen")};
r.Ha=function(){zD(this.J,"normal");oW(this.L);oW(this.O);this.dispatchEvent("tablepopupclose");KW.$.Ha.call(this)};r.FNa=function(){this.D=this.gb("waffle-range-selection-input").value;this.F=this.C.Oh();this.Sa==this.F&&Rhc(this.Ga,this.H)||this.dispatchEvent(new joc(this.D,this.F,this.oa));this.dispose()};function Hrc(a){var b=a.gb("waffle-range-selection-input"),c=mh(a.Ga);a.D=yv(c);b.value=a.D}
function Irc(a){var b=a.gb("waffle-assistant-table-canvas");Xwb(b);var c=Z3a(b),d=mh(a.H),d=new Qg(d.yc(),d.tc(),Math.min(d.Sc(),d.yc()+6),Math.min(d.Yc(),d.tc()+3)),e=rB(a.Ma).pe(),f=e.og(new Fg(d.yc(),d.Sc()),"r",!1,!1,!0,!0)-1,e=e.og(new Fg(d.tc(),d.Yc()),"c",!1,!1,!0,!0)-1,h=a.gb("waffle-assistant-canvas-container"),f=Math.min(115,f),e=Math.min(h.offsetWidth-2,e);Ywb(b,c,e,f);c=Grc(a.H,a.oa,a.F);a.$a.render(b,d,c);var b=a.L,d=a.H,f=a.oa,e=a.F,h=d.yc(),k=d.tc();switch(f){case 0:h=Math.min(d.Sc(),
d.yc()+e);break;case 1:k=Math.min(d.Yc(),d.tc()+e)}d=hh(d.Fb(),h,k,d.Sc(),d.Yc());nW(b,GS(d));nW(a.O,GS(c));G(a.C);a.C=new SH;a.Za(a.C);VS(a.C,VT.getInstance());a.C.render(a.gb("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.Wvb);c=Cc(a.H,2);b=a.H.Sc();c=Math.min(b-c,3);a.V=c+1;for(b=0;b<=c;b++)d=(new Cn("{NUM_ROWS, plural,=0 {none}=1 {1 row}other {# rows}}")).format({NUM_ROWS:b}),a.C.Ce(new Jq(d));a.F>=a.V&&(a.F=a.V-1);a.C.ag(a.F)}
function Jrc(a){var b=fv(a.J.C),c=b.Bc(),b=mIa(a.D,b);null!=b&&(a.H=kh(b,c),Irc(a))}r.SDb=function(){var a=this.gb("waffle-range-selection-input");this.D!==a.value&&(this.D=a.value,Jrc(this))};r.g0b=function(a){var b=this.gb("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.D=b.value;Jrc(this);this.FNa();break;case 27:a.stopPropagation(),a.preventDefault(),Hrc(this),this.dispose()}};
r.i0b=function(a){var b=a.rect;if(b&&!a.V&&!Wg(b)){this.D=a=yv(b);var c=this.gb("waffle-range-selection-input");c.value=a;c.select();a=this.J.C.getActiveGrid().Wc().Bc();this.H=kh(b,a);Irc(this)}};r.h0b=function(){this.D=this.gb("waffle-range-selection-input").value;Jrc(this)};r.Wvb=function(){this.F=this.C.Oh();Irc(this)};function LW(a,b,c,d){Mt.call(this,a,b,c,d,void 0,void 0,!0)}x(LW,Mt);LW.prototype.qa=function(){LW.$.qa.call(this);Vo(this.Ia,"waffle-assistant-toast");Vo(this.gb("docs-ui-toast-content"),"waffle-assistant-toast-content")};LW.prototype.cF=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Np(this,b);LW.$.cF.call(this,a,b,c)};LW.prototype.gi=function(a,b,c,d){this.cF(a,b,d);a=Pp(this,b);Ff(this.getHandler(),a,dd,v(function(){this.setVisible(!1);c()},this))};function Krc(){this.C=null}x(Krc,E);Krc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function sW(a,b,c,d){a.clear();a.C=new LW(b,c,!1,5E3);a.C.render();d&&a.C.gi("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Krc.prototype.Ha=function(){Krc.$.Ha.call(this);this.clear()};function Lrc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+kr("Press enter to insert formula")+'"></span></div>');return V(a)};function MW(a,b){S.call(this);this.C=a;this.D=b}x(MW,S);r=MW.prototype;r.qa=function(){this.Ia=T(Lrc,{name:this.C,title:this.D})};r.Ya=function(){MW.$.Ya.call(this);var a=this.gb("waffle-assistant-quicksum-entry-name");dW(a);this.getHandler().R(this.Ia,"keypress",this.z_b);Q(this.Ia,!1)};r.getFunctionName=g("C");r.ob=function(a){Ul(this.gb("waffle-assistant-quicksum-entry-value"),a||"");Q(this.Ia,!!a)};r.tb=function(){return xp(this.Ia)};
r.z_b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new H("insert",this)))};function NW(a,b,c,d,e){S.call(this,e);this.Ma=a;this.oa=b;this.L=c;this.Lb=d;this.D=a.C;this.Ga=new gh;this.V=gi(new fi,17).build();this.O=gi(new fi,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}x(NW,S);
NW.prototype.Ya=function(){NW.$.Ya.call(this);this.ji(new MW(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.ji(new MW(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.ji(new MW(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.ji(new MW(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.ji(new MW(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new qW(this.Ia,
this.oa,this.D,this.L);this.C.rf(this.J);F(this,this.C);this.getHandler().R(this,"insert",this.Z).R(this.C,"formula_inserted",this.ea)};
function Mrc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(ev(a.D)){var c=fv(a.D),d=c.gk(),e=mD(a.D);if(vb(d,c.Rt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=hh(e+"",h.yc(),h.tc(),h.Sc(),h.Yc());c.push(a.Ga.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.Ia,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.yd(0).ob(b(d.sum));a.yd(1).ob(b(d.average));a.yd(2).ob(b(d.min));a.yd(3).ob(b(d.max));
1<e?a.yd(4).ob(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.Ia,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.vd();++d)e=a.yd(d),a.H.push(Nrc(a,e.getFunctionName()));a.C.J=a.H}}else Q(a.Ia,!1)}else Q(a.Ia,!1)}else Q(a.Ia,!1)}NW.prototype.rf=function(a){this.J=a;this.C&&this.C.rf(a);Zo(this.Ia,"waffle-assistant-quicksum-panel-readonly",a)};
NW.prototype.Z=function(a){var b=a.target;a=this.F[0];a=new Bg(a.left,a.Sc());b=b.getFunctionName();b=Nrc(this,b);a=new DG(fv(this.D),a,b);this.L.C(a);this.Lb.rc(2624,this.O)};NW.prototype.ea=function(){this.Lb.rc(2624,this.V)};function Nrc(a,b){var c=Fv(a.Ma.L);a=sb(a.F,function(a){return yv(a)});return"="+b+"("+a.join(c)+")"};function Orc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(rs({content:gr("INSERT CHART"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(rs({Je:"waffle-autovis-lightbox-close",content:hr(""+U(Ht({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:gr("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(rs({content:hr("&#10094;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:ir('aria-label="'+kr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(rs({content:hr("&#10095;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:ir('aria-label="'+kr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.zKb)+"</div></div></div>");return V(a)}function Prc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function OW(a,b,c,d){S.call(this,d);this.F=a;this.D=b;this.Lb=c;this.H=[];this.C=new ss("",this.ma());this.Za(this.C);this.O=new ss("",this.ma());this.Za(this.O);this.L=new ss("",this.ma());this.Za(this.L);this.J=new ss("",this.ma());this.Za(this.J)}x(OW,S);r=OW.prototype;r.qa=function(){OW.$.qa.call(this);this.Ia=T(Orc,{zKb:this.F.length})};
r.Ya=function(){OW.$.Ya.call(this);var a=X.aP.isEnabled();this.rf(!a);a=this.gb("waffle-autovis-lightbox-close");this.C.ub(a);a=this.gb("waffle-autovis-lightbox-insert");this.O.ub(a);var b=this.gb("waffle-autovis-lightbox-previous");this.L.ub(b);b=this.gb("waffle-autovis-lightbox-next");this.J.ub(b);Qrc(this);Rrc(this,this.D,!1);this.getHandler().R(document.body,Yba,this.tWb).R(this.Ia,"keydown",this.uWb).R(Bl(),"resize",this.xWb).R(this.C,"action",this.close).R(this.O,"action",this.dub).R(this.L,
"action",this.wWb).R(this.J,"action",this.vWb);b=new nu(this.Ia,this.ma());ou(b);F(this,b);a.focus()};function Qrc(a){var b=a.gb("waffle-autovis-lightbox-content"),c=a.gb("waffle-autovis-lightbox-content-inner");a=a.gb("waffle-autovis-lightbox-page-count");var d=zl();a=up(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;rp(c,d,e);rp(b,d,e+a.height+35)}r.rf=function(a){Zo(this.Ia,"waffle-autovis-lightbox-readonly",a)};
function Rrc(a,b,c){c&&tn("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Src(a,b):a.F[b]&&Voc(a.F[b],v(a.gnb,a,b),!0)}r.gnb=function(a,b){if(!this.isDisposed()&&b){var c=this.gb("waffle-autovis-lightbox-container"),d=T(Prc);c.appendChild(d);this.H[a]=d;UU(b,d,this.Lb,Rm);Src(this,a)}};function Src(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.hb(0!=b);a.J.hb(b!=a.F.length-1);var c=a.gb("waffle-autovis-lightbox-page-number");Ul(c,b+1);a.D=b}r.tWb=function(a){!Rl(this.Ia,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
r.uWb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Rrc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Trc(this);a.stopPropagation()};r.xWb=function(){var a=this.gb("waffle-autovis-lightbox-container");Hl(a);this.H=[];Qrc(this);Rrc(this,this.D,!0)};r.dub=function(){this.close();Yoc(this.F[this.D],2256)};r.wWb=function(){0!=this.D&&Rrc(this,this.D-1,!0);0==this.D&&this.J.Ia.focus()};r.vWb=function(){Trc(this);this.D==this.F.length-1&&this.L.Ia.focus()};
function Trc(a){a.D!=a.F.length-1&&Rrc(a,a.D+1,!0)}r.close=function(){this.dispose()};r.xd=function(){OW.$.xd.call(this);var a=this.F[this.D];a&&a.Ia&&a.Ia.focus()};function Urc(a,b,c){I.call(this);this.gc=a;this.Tb=b;this.Ab=c;this.J=a.C;this.Ie=new gh;this.eb=Sj();this.L=new Lj;this.fc=this.C=this.F=this.V=this.O=this.Ma=this.ea=null;this.Mb=!1;this.D=null;this.wc=!0;this.mb=this.zb=!1;this.Eb=this.rb=null;this.Z=yi.getInstance();this.$a=this.Sa="";this.oa=this.Ga=null;b=this.gc.L.Vs();this.H=new bV;D(this.H,15,!0);D(this.H,2,bra);a=Era&&!a.Ld();D(this.H,3,a);D(this.H,4,!0);a=Om&&(Qra||"en"==bD(b));D(this.H,5,a);D(this.H,6,Ara);D(this.H,7,!0);D(this.H,10,!1);
D(this.H,11,Pra);D(this.H,12,Rra);D(this.H,14,Xra);this.yb=-1!=window.location.href.indexOf("eeos=false");a=new J(this);F(this,a);a.R(this.Tb,"N",this.b0b)}x(Urc,I);var Vrc={W5b:"cu",dZa:"cs",cZa:"ce",a1a:"ls",Z0a:"le"};function Wrc(a){a.mb=!0;a.L.cancel(!0);a.Ma=null;a.O=null;a.V=null;a.F=null;a.ea&&(a.ea.cancel(!0),a.ea=null)}r=Urc.prototype;
r.update=function(a,b,c){c&&this.C&&!wb(c,function(a){return Zga(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].Mh()&&this.C.rect.contains(c[0])||(this.eb.cancel(!0),a&&Wrc(this),this.eb=Xrc(),this.eb.addCallback(this.Q5a,this),this.eb.addCallback(Ea(this.R5a,b),this))};r.yh=ca("rb");r.b0b=function(){this.ea&&3==this.Tb.getState()&&(this.ea.hc(),this.ea=null)};function Xrc(){var a=null,b=new Lj(function(){null===a||xi(a)}),a=wi(function(){b.hc()});return b}
function Yrc(a,b,c,d,e){b&&(a.$a=zi(a.Z,kj.Nxa,!1,Zrc(a)));a.Ga=d;a.oa=e;a.L.cancel(!0);a.L=new Lj;$rc(a);a.L.addCallback(a.n8a,a);b&&(a.L.addCallback(Ea(a.j8a,c),a),a.yb||null==a.rb||xw(a.gc)?(a.L.addCallback(a.W5a,a),a.L.addCallback(a.X5a,a)):a.L.addCallback(a.Jhb,a),a.L.addCallback(a.i8a,a));Oj(a.L,a.a0b,a)}r.a0b=function(a){this.zb=!0;a instanceof Mj||this.Ab.wq(Error("Assistant cancelled"),{cause:a})};
r.Q5a=function(){var a=this.J.getActiveGrid();if(a){var b=fv(this.J),c=b.gk(),d=asc(this,c||[]),e=asc(this,this.fc||[]);d&&!e||!d&&!bsc(c,this.fc)?(this.F=null,this.Mb=!0):this.Mb=!1;this.fc=c;var f=$A(b).clone();z(b.gk(),function(a){f.Rn(a)});this.D=new dh(a.Fb(),"",f)}else this.D=null};
r.R5a=function(a){this.Sa=zi(this.Z,kj.Mxa,!1,Zrc(this));var b=this.J.getActiveGrid(),c=this.D&&this.D.bd;this.C&&this.C.bd!=c&&(this.C=null);if(!b||b.Fb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=qz(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||$u(this.J)!=c)return null;var b=fv(this.J),f=csc(this,a),h=nz(b.D,"r"),k=b.$n("r");return!b.Rt(f)||h>=f.yc()&&eQa(b)||k<=f.Sc()&&dQa(b)?(this.dispatchEvent(new H("ls")),rz(d,f,dc(wg),a?void 0:500).addCallback(this.q8a,
this)):f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.Fb()==c&&null!==c?dsc(this,a,fv(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.Mh()&&(d=b&&new dh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.V=this.O=this.Ma=null;b=null!==d&&d.equals(this.C);if(b=this.mb||this.Mb||!b&&(null===this.O||null!==this.V&&null===this.F))this.wc=this.zb&&this.wc||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Sa&&(Ai(this.Z,this.Sa),this.Sa="");b&&Yrc(this,a,e,this.Ga,this.oa)},this);return b};function csc(a,b){return null!=a.D?ritz_api.AssistantApi.getExploreTableRectForSelection(""+a.D.bd,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Jra,Qg):null}
function $rc(a){if(null===a.C||null===a.C.rect||null!==a.Ma)a.L.hc();else{var b=zi(a.Z,kj.Dwa,!1,Zrc(a)),c=a.L;ritz_api.AssistantApi.getAssistantConfidence(""+a.C.bd,a.C.rect.top,a.C.rect.height+a.C.rect.top,a.C.rect.left,a.C.rect.width+a.C.rect.left,a.Ie.serialize(a.H),function(d){Ai(a.Z,b);a.Ma=d+0;c.hc()})}}r.q8a=function(){this.dispatchEvent(new H("le"))};r.n8a=function(){this.dispatchEvent(new esc(this.C,this.Ma))};r.j8a=function(a){a=new fsc(a,this.mb);this.mb=!1;this.dispatchEvent(a)};
r.Jhb=function(){if(null===this.C||null===this.C.rect||null!==this.V&&null!==this.F)return null;G(this.Eb);return 3!=this.Tb.getState()?(this.ea=new Lj,this.ea.addCallback(this.jUa,this),this.ea):this.jUa()};
r.jUa=function(){var a=zi(this.Z,kj.Pxa,!1,Zrc(this)),b=gsc(this),c=b&&!b.rPa,d=this.Ga||kh(this.C.rect,this.C.bd),b=ritz_api.AssistantApi.getAssistantRequestProto(d,c?b.rows:[],c?b.Me:[],this.oa),b=this.Ie.ld($U.Wa(),b),c=new gh;c.tv=!0;var b=Jh(c.serialize(b)),e=new Lj;this.Eb=Gj(Hj(Ej(tk(uk(this.rb.Xf("/explore/getrecommendations").dg("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=zi(this.Z,kj.Oxa,!1,Zrc(this));b=hsc(this,b.yg());Ai(this.Z,c);this.V=Bc(b,1);this.F=Bc(b,2);this.Eb=null;Ai(this.Z,
a);e.hc()},this),function(){this.V=[];this.F=[];e.hc()},this).jf();return e};
r.W5a=function(){function a(){d=null;ritz_api.AssistantApi.continueAssistantRecommendation(this.O)?(this.V=Bc(hsc(this,ritz_api.AssistantApi.getAssistantRecommendations(this.O)),1),e.hc()):d=wi(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.V)return null;this.O=ritz_api.AssistantApi.newAssistantRecommender(this.Ie.serialize(this.H));this.F=this.V=null;if(this.Ga&&this.oa){var b=GS(this.Ga),c=GS(this.oa);ritz_api.AssistantApi.startAssistantRecommendationWithHeader(this.O,
""+b.bd,b.rect.top,b.rect.height+b.rect.top,b.rect.left,b.rect.width+b.rect.left,c.rect.top,c.rect.height+c.rect.top,c.rect.left,c.rect.width+c.rect.left)}else ritz_api.AssistantApi.startAssistantRecommendation(this.O,""+this.C.bd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var d=null,b=v(function(){null!==d&&(xi(d),this.F=this.V=this.O=d=null)},this),e=new Lj(b),d=wi(a,5,this);return e};
r.X5a=function(){var a=gsc(this);a&&this.O&&null===this.F&&(this.F=a.rPa?[]:Bc(hsc(this,ritz_api.AssistantApi.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Me)),2))};r.i8a=function(){this.zb=!1;var a=this.F&&0<this.F.length?this.F:this.V;""!=this.$a&&(Ai(this.Z,this.$a),this.$a="");this.dispatchEvent(new isc(this.C,a||[]))};function hsc(a,b){return a.Ie.ld(ZU.Wa(),b)}
function dsc(a,b,c){b=b.clone();bc(wg,function(a){for(var d=!0;d&&b;){for(var f=Ag(a),h=0;h<(f?b.width:b.height);h++){var k=bh(b,a),l=f?b.tc():b.yc(),k=f?c.Pf(k,l+h):c.Pf(l+h,k);if(!uSb(k)&&k.Sr()){d=!1;break}}d&&(bha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function bsc(a,b){return Sb(a,b,function(a,b){return Vg(a,b)})}
function gsc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.Fb()!=a.C.bd)return null;for(var c=fv(a.J).gk(),c=sb(c,Ea(Ug,a.C.rect)),c=rb(c,sa),d=sb(c,function(a){return new Mg(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new eg,e=new eg,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=asc(a,c);return{rows:b.Ad(),Me:e.Ad(),rPa:a}}
function asc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Wg(b)||0==b.Mh())return!0;a=vUa(fv(a.J).Z,b.top,b.left);return b.equals(a)}function Zrc(a){var b=new ai;O(b,5,a.yb||null==a.rb||xw(a.gc)?1:2);O(b,6,!a.yb);O(b,11,Ura);return ii(gi(new fi,41),b).build()}function esc(a,b){H.call(this,"cu");this.C=a;this.F=b}x(esc,H);function isc(a,b){H.call(this,"ce");this.C=a;this.F=b}x(isc,H);function fsc(a,b){H.call(this,"cs");this.C=a;this.F=b}x(fsc,H);function PW(a,b,c,d,e,f){KT.call(this,f);this.V=a;this.wc=b.C;this.Tb=c;this.Od=d;this.Lb=e;this.oa=new NW(b,c,d,e,this.ma());this.Za(this.oa);this.L=new tV(!1,"#4285f4");this.Za(this.L);this.J=null;this.fc=this.zb=!1;this.mb=!0;this.eb=yi.getInstance();this.Ma=this.Ga="";this.Z=gi(new fi,10).build()}x(PW,KT);r=PW.prototype;r.qa=function(){PW.$.qa.call(this);this.Ia=T(jsc,{nTb:Om})};
r.Ya=function(){PW.$.Ya.call(this);var a=this.gb("waffle-assistant-quicksum-panel");this.oa.ub(a);a=this.gb("waffle-assistant-spinner-container");this.L.render(a);this.getHandler().R(this,"close-sidebar",this.Poa).R(this.V,Vrc.a1a,this.Goa).R(this.V,Vrc.Z0a,this.Foa).R(this.V,Vrc.dZa,this.coa).R(this.V,Vrc.cZa,this.boa).R(this.gb("waffle-assistant-scroll-pane"),"scroll",Thc(this.Vva,10,this));a=X.aP.isEnabled();this.rf(!a)};
r.resize=function(){var a=this.gb("waffle-assistant-sidepane-content"),a=up(a).height,b=this.gb("waffle-assistant-spinner-container");cp(b,"margin-top",a/2-16+"px")};r.yh=pa;function ksc(a,b){var c=lsc(a);0!=c.length&&(G(a.J),c=c.filter(function(a){return a instanceof jW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new OW(c,b,a.Lb,a.ma()),a.J.render(),F(a,a.J),a.J.rf(a.fc)))}r.rf=function(a){this.fc=a;Zo(this.Ia,"waffle-assistant-readonly",a);this.oa.rf(a);this.J&&!this.J.isDisposed()&&this.J.rf(a)};
r.setVisible=function(a){var b=this.tb();PW.$.setVisible.call(this,a);if(a&&!b){var c=csc(this.V,a);c?(b=new Jnc,O(b,1,ah(c,"r")),O(b,2,ah(c,"c")),c=c.Mh(),O(b,3,c),c=new ai,Sh(c,4,b),b=ii(ji(this.Z),c).build()):b=this.Z;this.Ma=zi(this.eb,kj.Txa,!1,b);this.L.setActive(!0);QW(this)}a||msc(this,!0)};r.Goa=function(){this.tb()&&(msc(this,!0),this.L.setActive(!0),QW(this))};r.Foa=function(){this.tb()&&(this.L.setActive(!1),QW(this))};
r.coa=function(a){this.tb()&&(this.Lb.C(2775,this.Z),msc(this,void 0,a.C,a.F),nsc(this)||this.L.setActive(!0),QW(this),this.mb=!1)};
r.boa=function(a){if(this.tb()){this.Lb.C(2776,this.Z);var b=a.F;0<b.length&&(this.Ga=zi(this.eb,kj.Rxa));msc(this,!1);this.L.setActive(!1);a=a.C;for(var c=0;c<b.length;c++){var d=Cc(b[c],1);Xra&&5==d&&(this.gc=B(b[c],12),this.$a=B(b[c],4,0),this.Eb=B(b[c],11),osc(this))}for(c=0;c<this.D.length;c++){for(var d=[],e=0;e<b.length;e++){var f=Cc(b[e],1);this.D[c].Gia(f)&&d.push(b[e])}0<d.length?this.D[c].Sva(d,a):this.D[c].jW(!0)}b=lsc(this);0<b.length&&this.zb&&(b[b.length-1].Eb=!0);this.zb=!1;QW(this);
psc(this);this.Vva()}};function QW(a){var b=nsc(a),c=xp(a.gb("waffle-assistant-quicksum-panel")),d=a.L.kc(),b=b||c||d;a=a.gb("waffle-assistant-empty-list");Q(a,!b)}r.Jc=pa;r.Ssa=pa;r.Yv=g("Lb");r.Ld=g("fc");r.Poa=pa;r.eJb=function(){""!=this.Ga&&(Ai(this.eb,this.Ga),this.Ga="");""!=this.Ma&&(Ai(this.eb,this.Ma),this.Ma="");this.mb||(this.Lb.rc(2777,this.Z),this.mb=!0)};function jsc(a){a=a||{};var b=V,c=hr('<div class="waffle-assistant-replaceable-title">'+qsc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(woc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.nTb?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(U(UT(fr({title:c,il:hr(""+d),id:gr("autovis"),G3:gr("waffle-assistant-sidepanel"),eea:gr("waffle-assistant-title"),OZ:gr("waffle-assistant-sidepane-content")},a))))}
function qsc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(woc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function RW(a,b,c,d,e,f,h,k){PW.call(this,a,b,c,d,e,k);this.od=f;this.Mb=b;this.ea=new S(this.ma());this.Za(this.ea);this.O=new Krc;F(this,this.O);this.D=[];this.F=null;this.Sa=new ss("",k,4);Fq(this.Sa,2,!1);this.Za(this.Sa);this.Hd=h;this.$a=null;this.gc=0;this.Eb=null;this.rb=new ks("",new cW,this.ma());this.Za(this.rb);this.yb=new S(this.ma());this.Za(this.yb);this.H=null}x(RW,PW);
var SW={jE:"waffle-assistant-scroll-pane-feature-content",B$b:"waffle-assistant-empty-list",Q_a:"waffle-assistant-features",R0a:"waffle-assistant-empty-list-learn-more",wga:"waffle-assistant-expanded-panel",Vza:"waffle-assistant-replaceable-title",nuc:"waffle-assistant-scroll-pane",f3a:"waffle-assistant-sidepane-tables-range",g3a:"waffle-sidebar-tables-bar",h3a:"waffle-assistant-tables-edit-range-button",qQ:"waffle-assistant-title"},rsc={defaultHelpArticleId:"6280499"};r=RW.prototype;
r.Ya=function(){var a=this;RW.$.Ya.call(this);this.ea.ub(this.gb(SW.wga));dW(this.C.Ia,"Close");Xra&&(this.yb.ub(this.gb(SW.f3a)),osc(this),this.rb.ub(this.gb(SW.h3a)),this.getHandler().R(this.rb,"action",this.PLa).R(this,"Fe",this.PLa));var b=this.Mb.L.Vs();Om&&(Qra||"en"==bD(b))&&(b=new IW(this.od,this.Tb,this.wc,this.Od,this.Yv(),this.O,this.Mb,this.ma()),this.Za(b),this.D.push(b));b=new Drc(this.Yv(),this.O,this.ma());this.Za(b);this.D.push(b);b=new mW(this.wc,this.Tb,this.Yv(),this.O,this.ma());
this.Za(b);this.D.push(b);var c=this.gb(SW.Q_a);z(this.D,function(b){b.render(c);a.ea.Za(b.C,!0)});this.Sa.ub(this.gb(SW.R0a));this.getHandler().R(this.Sa,"action",this.$_b);ssc(this)};r.PLa=function(){this.H=new KW(this.Mb,this.Tb,this.Hd,this.$a,this.gc,this.Eb);this.Za(this.H);this.getHandler().R(this.H,"tablepopupopen",this.RDb).R(this.H,"tablepopupclose",this.QDb);this.H.render(this.getElement())};r.RDb=function(){var a=tsc(this);a&&src(a,!0)};r.QDb=function(){var a=tsc(this);a&&src(a,!1)};
r.$_b=function(){P.Ko.Oc(rsc)};function psc(a){z(a.D,function(a){Eoc(a)})}function msc(a,b,c,d){z(a.D,function(a){a.jW(b,c,d)})}function nsc(a){return!!wb(a.D,function(a){return a.$oa()})}r.Vva=function(){var a=this,b=this.gb("waffle-assistant-scroll-pane").scrollTop+up(this.gb("waffle-assistant-sidepane-content")).height;z(this.D,function(c){a.F&&a.F!=c||(c instanceof mW&&a.getHandler().Mc(c,"De",a.eJb),b=c.Uva(b))})};
function lsc(a){if(a.F)return a.F.C.C;var b=[];z(a.D,function(a){Lb(b,Doc(a))});return b}r.rf=function(a){RW.$.rf.call(this,a);ssc(this)};r.yh=function(a){z(this.D,function(b){b.yh(a)})};r.Ssa=function(){var a=this.gb(SW.Vza),b=this.gb(SW.qQ);tp(b,up(a).height)};
r.Jc=function(){var a=this,b=this.gb(SW.jE),c=this.gb(SW.Vza),d=this.ea.Ia;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,Q(b,!0),Q(d,!1),Xq(c,qsc),Qo(c,"label"),this.resize();else if(this.F=wb(this.D,function(a){return a.kc()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),Foc(this.F,c),So(c,this.F.x4());this.Ssa();b=new xk(function(){var b=Fu;b&&b.dispatchEvent("resize");a.Vva()},300);F(this,b);b.start()};
r.setVisible=function(a){var b=this.tb();RW.$.setVisible.call(this,a);a&&!b&&usc(this,!0);a||this.O.clear()};r.Poa=function(){RW.$.Poa.call(this);this.F&&this.Jc();this.H&&(this.removeChild(this.H,!0),G(this.H))};r.Goa=function(){RW.$.Goa.call(this);usc(this,!0)};r.Foa=function(){RW.$.Foa.call(this);usc(this,!1)};r.coa=function(a){RW.$.coa.call(this,a);usc(this,!0,a.C)};r.boa=function(a){RW.$.boa.call(this,a);usc(this,!1)};function ssc(a){z(a.D,function(b){b.rf(a.Ld())})}
function tsc(a){a=wb(a.D,function(a){return a instanceof IW});return null!=a?a:null}function usc(a,b,c){z(a.D,function(a){c||Aoc(a.C,b)})}function osc(a){var b=a.gb(SW.g3a),c="";a.$a&&0==a.Eb?(c=mh(a.$a),c=yv(c),Q(b,!0)):Q(b,!1);b=T(Frc,{XUb:c});a=a.yb.jc();Hl(a);a.appendChild(b)};function vsc(a,b,c,d,e,f,h,k,l){var m=this;QT.call(this,b,h);this.V=a;this.C=b;this.O=c;this.Ga=d;this.$a=e;this.L=f;this.J=c.C;this.Ma=this.oa=!1;this.Lb=l;this.Ie=new gh;this.F=null;wsc(this);X.P4.hb(!0);a=new tia;O(a,6,xsc());b=new Xh;Sh(b,58,a);this.H=gi(hi(new fi,b),10).build();this.Sa=yi.getInstance();this.ea=zi(this.Sa,kj.Qxa);a=new xk(function(){return ysc(m,!1)},100);F(this,a);a.start()}x(vsc,QT);
function wsc(a){var b=dv(a.$a);a.Ff().R(a.Ga,"selectionChange",a.e0b).R(a.J,"ba",a.c0b).R(b,"ua",a.owb).R(a.C,"Ae",a.qlb).R(a.C,"ze",a.plb).R(a.C,"Ge",a.rAb).R(a.C,"Ce",a.Jmb).R(a.C,"Ee",a.d0b).R(a.C,"Je",a.fDb).R(a.C,"He",a.UBb).R(a.C,"Be",a.Nlb).R(a.C,"Ke",a.f0b).R(a.V,"cu",a.iob).R(a.C,"Ie",a.YBb);Ao(a.Z,X.aP,Rn,a.gub).subscribe(X.bP,"action",a.Klb).subscribe(X.Q4,"action",a.TCb).subscribe(X.cfa,"action",a.URa).subscribe(X.Ny,"action",a.Txb)}r=vsc.prototype;r.Ph=function(){return X.dfa};r.$v=function(){return X.Fwa};
r.ev=function(a){vsc.$.ev.call(this,a);X.Q4.hb(a);ysc(this,!1);!this.oa&&a&&(this.oa=!0)};r.b1=function(a){var b=this;this.C.Ssa();var c=new xk(function(){vsc.$.b1.call(b,a)},300);F(this,c);c.start()};r.yh=function(a){this.C.yh(a);this.V.yh(a)};r.Klb=function(){var a=this.C.tb();this.Ph().setVisible(!a);a?this.Lb.rc(2226,this.H):(this.C.focus(),this.Lb.rc(2253,this.H))};r.URa=function(){this.C.tb()||this.ev(!0)};r.Txb=function(){var a=tsc(this.C);a&&!a.kc()&&(this.URa(),urc(a,""))};
r.TCb=function(a){ksc(this.C,a)};r.e0b=function(){ysc(this,!0)};function ysc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.F&&c[0].equals(a.F)){a.F=null;return}}var d=a.C;d.tb()&&(Mrc(d.oa),QW(d));a.V.update(!b,a.C.tb(),c)}
r.iob=function(a){""!=this.ea&&(Ai(this.Sa,this.ea),this.ea="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Mh()>=Kra&&ah(c,"r")>=Mra&&ah(c,"c")>=Nra&&c.Mh()<=Lra)&&.6<=b;d!==this.Ma&&(this.Ma=d,X.P4.Oc(d));c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Mh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.bd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.tb()&&!this.oa&&c&&d&&!xw(this.O),a=Bra&&a,d=Cra&&this.O.Ld(),c&&(a||d)&&(c=new tia,O(c,1,b),O(c,2,a),O(c,3,d),O(c,5,
Rra),O(c,6,xsc()),b=new Xh,Sh(b,58,c),b=hi(gi(new fi,10),b).build(),this.uCa(b)))};r.uCa=function(a){var b=this;this.C.zb=!0;var c=fWa(fv(this.J));if(!VTb.C&&!c){var d=a||this.H;this.Ph().setVisible(!0);this.Lb.rc(2225,d);this.Lb.rc(2253,this.H);a=new xk(function(){b.C.tb()||b.Lb.rc(2752,d)},5E3);F(this,a);a.start()}};function xsc(){switch(Ora){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}r.Nlb=function(){this.C.Jc()};
r.f0b=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.Fb(),10);this.F=mh(c);this.L.C(new NUb(d));Arc(b,c);this.Lb.rc(a.zk(),this.H)};r.c0b=function(){ev(this.J)?(this.C.hb(!0),ysc(this,!1)):(this.Ph().setVisible(!1),this.C.hb(!1))};r.gub=function(){this.C.rf(!X.aP.isEnabled())};r.owb=function(a){ysc(this,!1,BHa(a))};
r.qlb=function(a){var b=fv(this.J),c=""+b.Bc(),d=[],e=zhc(b);if(e){var b=new Se,f=Cc(e,2);D(b,3,f);f=Cc(e,2);D(b,2,f);e=Cc(e,1);D(b,1,e);d.push(b)}b=a.C.yb;for(e=0;e<b.length;e++)f=new Se,D(f,2,b[e]),d.push(f);this.L.C(new cV(d,c));this.Lb.C(a.zk(),this.H)};
r.plb=function(a){var b=a.C,c=ric(b.C),d=B(b.D,4,0),e=c.hv?c.Nx:null,f=c.C?c.tx:null,h=parseInt(d.Fb(),10),k=zsc(d);this.F=mh(d);k?this.L.C(new PT(k,h,this.F,e,c.Os,c.Lt,f)):this.L.C(new NT(h,this.F,e,c.Os,c.Lt,f));d=new Phc;O(d,1,1);c=new WS;b=B(b.D,2);O(c,2,b);Sh(c,5,d);b=new Xh;Sh(b,46,c);b=hi(gi(new fi,10),b).build();this.Lb.C(a.zk(),b)};r.rAb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.Fb(),10),d=zsc(b);this.F=mh(b);this.L.C(new OT(d,c));Arc(a,b)};
r.YBb=function(a){var b=fv(this.O.C),c=b.Bc(),b=kh(mIa(a.J,b),c);a=Grc(b,a.V,a.L);c=this.V;Wrc(c);Yrc(c,!0,!0,b,a)};function zsc(a){var b=a.Fb();a=mh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.yc(),a.tc(),a.Sc(),a.Yc(),7,!1);return 0<b.length?b[0]:null}r.Jmb=function(a){fB(fv(this.J),a.F);this.Lb.C(a.zk(),this.H)};
r.fDb=function(a){var b=a.C;a=a.zk();if(b instanceof rW||b instanceof uW)this.Lb.C(a,this.H);else{var c=lsc(this.C),d=new WS,e=B(b.D,2),c=c.indexOf(b);O(d,1,c);O(d,2,e);e=new Xh;Sh(e,46,d);if(b instanceof jW){(d=b.H)?(b=Asc(this,b,d),b=Xkc(b,d,d.xf())):b=null;if(!b)return;Sh(e,39,b)}else if(b instanceof lW){var f=b.D,c=new Snc;if(b instanceof lW)b=1;else throw Error("Unknown text analysis card type.");f=Bc(B(f,8),20).slice(0,10);O(c,2,f||[]);O(c,1,b);Sh(d,3,c)}e=hi(gi(new fi,10),e).build();this.Lb.C(a,
e)}};r.UBb=function(){this.C.Jc()};
r.d0b=function(a){var b=a.J;if(b){var c=fv(this.J),d=a.$e();d||(d=rB(this.Ga).zd().C.$e());var e=16,f=16,h=a.Sa;h&&(e=h.x,f=h.y);h=UZa(this.O.J);c={oid:null,ar:mB(c,d.y),ac:nB(c,d.x),x:e,y:f,h:By.height,w:By.width,p:{context:{chartName:"Chart "+(h+1)}}};c=new RC($u(this.J)||0,c,!1,!1);d=b.xf();e=new jm(d);f=tm(e,"headers");f=null!=f&&za(f)&&Ta(f)?parseInt(f,10):-1;c.$a=f;c.V=0;f="1"==tm(e,"transpose");c.Ma=f;c.H=f?"ROWS":"COLS";f=tm(e,"range");f=Dhc(oT(f,","),this.J);c.gI(f);QS(c,b);(e=tm(e,"dt"))&&
GZa(c,this.Ie.ld(df.Wa(),JSON.parse(decodeURIComponent(e))));this.Ga.dispatchEvent(new FD("objectRequest"));this.L.C(new AG(this.O,c));e=Bsc(this,b,a.L,a.Xd());e.Zk(c.getId()||0);RU(this.Lb,a.zk(),e,10,b,d)}};function Asc(a,b,c){var d=lsc(a.C).filter(function(a){return a instanceof jW});return Bsc(a,c,d.indexOf(b),b.H&&b.H.Xd())}
function Bsc(a,b,c,d){var e=new QU;a=lsc(a.C).filter(function(a){return a instanceof jW}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Ukc(e,b.getChartType());e.F=d?d.clone():null;return e};function Csc(){E.call(this)}x(Csc,bn);Csc.prototype.C=function(){return Urc};Csc.prototype.F=function(){return RW};Csc.prototype.D=function(){return vsc};on("assistant",Csc);
