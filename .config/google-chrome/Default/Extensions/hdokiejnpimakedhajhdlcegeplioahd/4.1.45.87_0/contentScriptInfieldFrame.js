function LP_keypress_handler(e){return 27==e.keyCode?void LPInfieldFrame.close("close"):9==e.keyCode?void LPInfieldFrame.close("away"):void 0}var lpResizeEvent=function(){function e(){o||(o=setTimeout(function(){o=null,n()},66))}function n(){l&&l()}function t(n){l=n,window.addEventListener("resize",e)}function i(){l=null,window.removeEventListener("resize",e)}var o,l;return{attachWindowResizeEvent:t,detachWindowResizeEvent:i}}();LPInfieldFrame=function(){function e(e,n){var t;return function(){var i=this,o=arguments;clearTimeout(t),t=setTimeout(function(){t=null,e.apply(i,o)},n)}}function n(n){(w=w||e(t,100))(n)}function t(e){if(v)return void(v=!1);if(e.iframe&&!e.fieldEl)try{e.fieldEl=$(e.iframe).contents().find("#"+e.id)[0]}catch(e){}if(e&&("focus"!==e.eventType||!E)){if(u){if(p.id===e.id)return;o("away")}e.url=m,p=e,u=LPFrame.openFrame({url:m,interfaceDefinition:Interfaces.InfieldPopupInterface}),d(),c(),lpResizeEvent.attachWindowResizeEvent(c),window.addEventListener("click",i,!0),bg.sendLpImprove("newinfieldopen",{source:"formv2",option:e.eventType})}}function i(e){return(!p||e.target.id!==p.id&&e.target!==p.fieldEl)&&(o("away"),!0)}function o(e){u&&(e&&(v="action"==e,bg.sendLpImprove("newinfieldclose",{source:"formv2",option:e}),"close"===e&&(E=!0,p.fieldEl&&(LP_addEventHandler(p.fieldEl,"click",launchPopup,!1),realLaunchPopup&&p.fieldEl.removeEventListener("focus",realLaunchPopup)))),window.removeEventListener("click",i),lpResizeEvent.detachWindowResizeEvent(),u&&u.close(),u=null,p=null)}function l(e,n){var t={};return e&&(t.height=e),n&&(t.width=n),t}function r(e){var n={top:0,left:0};if(e){var t={top:0,left:0};e.iframe&&(t=e.iframe.getBoundingClientRect());var i={bottom:parseInt(e.posy),left:parseInt(e.posx),width:e.width};e.fieldEl&&e.fieldEl.getBoundingClientRect?i=e.fieldEl.getBoundingClientRect():e.fieldBox&&(i=e.fieldBox),n.top=window.pageYOffset+t.top+i.bottom,n.left=window.pageXOffset+t.left+i.left+i.width-375;var o=360;n.left<=0&&(n.left=window.pageXOffset+t.left+i.left-10,o=25)}return f(o),n}function f(e){u&&u.getInterface().lpInfield.setArrowPosition({position:e})}function d(){u&&u.css({display:"block",position:"absolute",height:"0px"})}function a(e,n){u&&u.css(l(e,n))}function c(){p.fieldEl&&!$(p.fieldEl).is(":visible")?o():u&&u.css(r(p))}function s(e,n,t){(e==punycode.URLToASCII(document.location.href)||has_same_tld(e,document.location.href))&&populategeneratedpassword(e,n,t)}var u,p,v,w,m="contentScriptPopup.html",E=!1;return{close:o,show:d,openFrame:n,resizeFrame:a,positionFrame:c,fillGeneratedPassword:s}}();