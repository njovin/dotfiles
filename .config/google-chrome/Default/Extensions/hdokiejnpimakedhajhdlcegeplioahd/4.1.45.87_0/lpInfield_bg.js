var InfieldCommands=function(){function e(e){var t=r[e]||{};for(var i in t)if(t.hasOwnProperty(i)&&t[i].isActive)return t[i]}function t(e,t){var i=[],r={},a={},o="",l="",n="",f="",s=new Array,c={};t||(t=lp_gettld_url(e)),i=getsites(t),i=reorderOnURL(i,e,!0);for(var d=0;d<i.length;d++)r[i[d].aid]=geticonurlfromrecord(i[d]),c[i[d].aid]=getbigsquareiconurlfromrecord(i[d]);for(var u=0;u<g_formfills.length;u++)if(check_ident_ffid(g_formfills[u].ffid)){s[s.length]=g_formfills[u];var p=lpmdec_acct(g_formfills[u].ccnum,!0,g_formfills[u],g_shares);if(r[g_formfills[u].ffid]=geticonCCnum(p),c[g_formfills[u].ffid]=geticonCCnum(p,!0),""!==g_formfills[u].ccnum){var m=lpmdec(g_formfills[u].ccnum);s[s.length-1].formattedCCNum=LPCC.getFormattedNumber(m),s[s.length-1].ccType=LPCC.getCCType(m)}}var g=LPJSON.stringify("");return s&&s.length>0&&(g=LPJSON.stringify(s)),f=cache_usernames(i),o=g,l=LPJSON.stringify(r),g_40fieldicon&&(n=LPJSON.stringify(c)),f&&(a.sites=f),o&&(a.formfills=o),l&&(a.favicons=l),n&&(a.bigicons=n),a}function i(e,t,i){if(!(lploggedin&&null==grid_getdata("active")||skiplogin()))return!1;if(g_last_launch[t]=(new Date).getTime(),void 0!==g_sites[t]){var r=!0,a=get_record(t);return data.from_iframe&&!a.save_all&&(r=!0),g_fillfield_confirm_perfield={},fill({tabid:e,acct:g_sites[t],docid:null,submit:!1,doconfirm:!0,docnum:"all",allowforce:!0,skip_pwprotect:!1,manualfill:r,automaticallyFill:null,skip_basicauth:null,from_iframe:i,desc:"autofillaid"}),!0}return!1}var r={};return{getPopupFillData:function(i,r){var a=t(r.tabURL),o=e(r.tabID);i({url:r.tabURL,fillData:{sites:a.sites,formFills:a.formfills,favIcons:a.favicons,bigIcons:a.bigicons},domPath:o.domPath,fieldID:o.fieldID,fieldType:o.fieldType,type:o.type,save:o.save,generate:1===o.generate,canCopyToClipboard:can_copy_to_clipboard(),userName:g_username})},setActiveFormData:function(e,t){var i=r[t.tabID]||{};for(var a in i)i.hasOwnProperty(a)&&(i[a].isActive=!1);i[e.active]={isActive:!0,domPath:e.active,fieldID:e.activefieldid,fieldType:e.activefieldtype,type:e.start_type,save:e.opentosave,generate:e.ask_generate},r[t.tabID]=i},copyPassword:function(e,t,i,r){copypassword(e,null,t?1:0,r.tabID),sendLpImprove("copypass",{action:"sitepassword",source:i})},copyUserName:function(e,t,i){copyusername(e,t?1:0,i.tabID)},copyUrl:function(e,t,i){copyurl(e,t?1:0,i.tabID)},getGeneratePasswordPrefs:function(e,t){e(do_popupfillgetgenerateprefs(t.tabID))},setGeneratePasswordPrefs:function(e,t){do_popupfillsetgenerateprefs(t.tabID,e)},searchVault:function(e,t,i,r){i(do_searchvault(e,t,r.tabID))},fillGeneratedPassword:function(e,t,i,r){LPTabs.get({tabID:r.tabID}).forEachWindow({each:function(t,a){return t.LPInfieldFrame.fillGeneratedPassword(r.tabURL,e,i)}}),sendLpImprove("genpassword",t)},fillUserData:function(e,t,r){i(r.tabID,e,t)},editFormFill:function(e,t){editprofile(e,null,t)},fillForm:function(e,t,i,r){var a=null;if(t&&!frame_and_topdoc_has_same_domain(r.tabID)){if(ftd_report_error(r.tabID,"fillform"),!lpConfirmYesNo(gs("Are you sure you would like your LastPass Form Fill information to be filled into the following site?")+"\n\n"+lp_gettld_url(ftd_get_frameparenturl(r.tabID))))return!1;a=!0}fillform(e,null,null,null,t,a,i)},editSite:function(e){editAid(e)},canCopy:function(e){"function"==typeof e&&e(can_copy_to_clipboard())}}}();