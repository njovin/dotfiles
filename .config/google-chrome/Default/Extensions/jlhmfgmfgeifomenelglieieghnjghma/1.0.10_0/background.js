var Background=function(c){var e={},d={};c.postMessageToPage=function(a,b){var c=d[a];console.log("[Background] postMessageToPage: name=",a);console.log("[Background] postMessageToPage: clientPort=",c);if(null!=c)try{console.log("[Background] postMessageToPage: message=",b),c.postMessage(b)}catch(f){console.log("[Background] postMessageToPage: err=",f.toString())}};c.postMessageToNative=function(a,b){var d=e[a];console.log("[Background] postMessageToNative: name=",a);console.log("[Background] postMessageToNative: nativePort=",
d);if(null!=d)try{console.log("[Background] postMessageToNative: message=",b),d.postMessage(b)}catch(f){a={timestamp:(new Date).toUTCString(),token:a,message_type:"error",message:{error_no:-1,error_message:f.toString()}},c.postMessageToPage(d.name,a),console.log("[Background] postMessageToNative: err=",f.toString())}};c.handleClientMessage=function(a,b){console.log("[Background] handleClientMessage: message=",a);console.log("[Background] handleClientMessage: clientPort=",b);c.postMessageToNative(b.name,
a)};c.handleNativeMessage=function(a,b){console.log("[Background] handleNativeMessage: nativePort=",b);console.log("[Background] handleNativeMessage: message=",a);c.postMessageToPage(b.name,a)};c.handleNativeDisconnect=function(a){console.log("[Background] handleNativeDisconnect: nativePort=",a);if(null!=a&&(console.log("[Background] handleNativeDisconnect: lastError=",chrome.runtime.lastError.message),e[a.name]&&delete e[a.name],console.log("[Background] handleNativeDisconnect: nativePorts=",e),
a=d[a.name],console.log("[Background] handleNativeDisconnect: clientPort=",a),null!=a)){var b={timestamp:(new Date).toUTCString(),token:a.name,message_type:"disconnect",message:chrome.runtime.lastError.message};a.postMessage(b);a.disconnect();d[a.name]&&delete d[a.name];console.log("[Background] handleNativeDisconnect: clientPorts=",d)}};c.handleClientDisconnect=function(a){console.log("[Background] handleClientDisconnect: clientPort=",a);d[a.name]&&delete d[a.name];console.log("[Background] handleClientDisconnect: clientPorts=",
d);a=e[a.name];if(null!=a){var b={timestamp:(new Date).toUTCString(),token:a.name,message_type:"disconnect",message:"disconnect"};c.postMessageToNative(a.name,b);e[a.name]&&delete e[a.name]}};c.connectNative=function(a){var b=e[a];console.log("[Background] connectNative: name=",a);console.log("[Background] connectNative: nativePort=",b);if(null==b)try{b=chrome.runtime.connectNative("com.webex.meeting"),b.name=a,b.onMessage.addListener(c.handleNativeMessage),b.onDisconnect.addListener(c.handleNativeDisconnect),
console.log("[Background] connectNative: nativePort=",b),e[b.name]=b}catch(g){return console.log("[Background] connectNative: Failed connecting to native port,",g.toString()),null}return b};c.handleClientConnect=function(a){console.log("[Background] chrome.runtime.onConnect, clientPort=",a);a.onMessage.addListener(c.handleClientMessage);a.onDisconnect.addListener(c.handleClientDisconnect);d[a.name]=a;if(null!=c.connectNative(a.name)){var b={timestamp:(new Date).toUTCString(),token:a.name,message_type:"hello",
message:"hello"};c.postMessageToNative(a.name,b)}};c.setupGoogleAnalytics=function(){console.log("[Background] setupGoogleAnalytics: window.ga=",window.ga);window.ga||(function(){window.ga=function(){(window.ga.q=window.ga.q||[]).push(arguments)};window.ga.l=1*new Date;var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=1;a.src="analytics.js";b.parentNode.insertBefore(a,b)}(),ga("create","UA-90923124-1","auto"),ga("set","checkProtocolTask",null),ga("set","anonymizeIp",
!0),ga("send","pageview"))};c.init=function(){console.log("[Background] init: hostName_=","com.webex.meeting");c.setupGoogleAnalytics();chrome.runtime.onConnect.addListener(c.handleClientConnect);chrome.runtime.onUpdateAvailable&&chrome.runtime.onUpdateAvailable.addListener(function(a){console.log("chrome.runtime.onUpdateAvailable, details=",a)});chrome.runtime.onMessage.addListener(function(a,b){console.log("[Background] onMessage:",a);ga("send","event","WBX-Ext-Log-"+a.serviceType+"-"+a.platform+
"-"+a.result,a.action,a.label,1)})};return c}(Background||{});window.addEventListener("load",function(){Background.init()},!1);