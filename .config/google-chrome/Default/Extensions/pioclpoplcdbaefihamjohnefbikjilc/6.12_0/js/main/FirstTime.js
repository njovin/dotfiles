/*! Copyright 2009-2017 Evernote Corporation. All rights reserved. */

function FirstTime(){"use strict";function a(a){j=a,Persistent.set("userFlowState",a)}function b(){return j===h.UPGRADE||j===h.MINOR_UPGRADE}function c(a){j!=h.FIRST_TIME||m||l||f(a)}function d(b){l||(j==h.FIRST_TIME||j==h.UPGRADE?f(b):j==h.MINOR_UPGRADE&&Browser.insertJS("third_party/port.js",function(){Browser.insertJS("js/common/Browser.js",function(){Browser.insertJS("content/UINames.js",function(){Browser.insertJS("content/release_notes/inject_frame.js"),Browser.insertCSS("content/release_notes/inject_frame.css"),a(h.CURRENT),b()})})}))}function e(){return!l&&(j==h.FIRST_TIME||j==h.UPGRADE||j==h.MINOR_UPGRADE)}function f(b){var c=extension.getBootstrapInfo("marketingUrl")+"/webclipper/whats_new/";extension.msgHandlerOpenTab({url:c+"?firstlaunch"},null,function(){a(h.CURRENT),b()})}function g(){j===h.GUIDED_TOUR?a(h.CURRENT):j==h.FIRST_TIME||k==i.FIRST_TIME?a(h.FIRST_TIME):j==h.UPGRADE||k==i.UPGRADE?a(h.UPGRADE):j!=h.MINOR_UPGRADE&&k!=i.MINOR_UPGRADE||a(h.CURRENT),Persistent.set("userFlowState",j)}var h={CURRENT:"normal",FIRST_TIME:"first",UPGRADE:"upgrade",MINOR_UPGRADE:"minor"},i={CURRENT:0,UPGRADE:1,FIRST_TIME:2,MINOR_UPGRADE:3},j=Persistent.get("userFlowState")||h.CURRENT,k=function(){var a=versionDetect.getLastVersionParsed(),b=versionDetect.getSourceVersionParsed();return a&&a[0]?b[0]>a[0]?i.UPGRADE:versionDetect.geq(b,[6,0,9])&&!versionDetect.geq(a,[6,0,9])?i.MINOR_UPGRADE:i.CURRENT:i.FIRST_TIME}(),l=SAFARI,m=YANDEX;this.isUpgraded=b,this.msgHandlerOnAction=d,this.msgHandlerOnInit=c,this.needToShowIntro=e,this.startUp=g,Object.preventExtensions(this)}